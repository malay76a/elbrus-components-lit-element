{"version":3,"file":"chunk-020bc6bb.js","sources":["../node_modules/@webcomponents/shadydom/src/shady-data.js","../node_modules/@webcomponents/shadydom/src/utils.js","../node_modules/@webcomponents/shadydom/src/flush.js","../node_modules/@webcomponents/shadydom/src/observe-changes.js","../node_modules/@webcomponents/shadydom/src/innerHTML.js","../node_modules/@webcomponents/shadydom/src/patch-native.js","../node_modules/@webcomponents/shadydom/src/patch-instances.js","../node_modules/@webcomponents/shadydom/src/patch-events.js","../node_modules/@webcomponents/shadydom/src/array-splice.js","../node_modules/@webcomponents/shadydom/src/link-nodes.js","../node_modules/@webcomponents/shadydom/src/style-scoping.js","../node_modules/@webcomponents/shadydom/src/patches/Node.js","../node_modules/@webcomponents/shadydom/src/patches/ParentNode.js","../node_modules/@webcomponents/shadydom/src/patches/DocumentOrFragment.js","../node_modules/@webcomponents/shadydom/src/patches/DocumentOrShadowRoot.js","../node_modules/@webcomponents/shadydom/src/patches/ElementOrShadowRoot.js","../node_modules/@webcomponents/shadydom/src/patches/ShadowRoot.js","../node_modules/@webcomponents/shadydom/src/patch-shadyRoot.js","../node_modules/@webcomponents/shadydom/src/attach-shadow.js","../node_modules/@webcomponents/shadydom/src/wrapper.js","../node_modules/@webcomponents/shadydom/src/patches/EventTarget.js","../node_modules/@webcomponents/shadydom/src/patches/Slotable.js","../node_modules/@webcomponents/shadydom/src/patches/Element.js","../node_modules/@webcomponents/shadydom/src/patches/HTMLElement.js","../node_modules/@webcomponents/shadydom/src/patches/Slot.js","../node_modules/@webcomponents/shadydom/src/patches/Document.js","../node_modules/@webcomponents/shadydom/src/patches/Window.js","../node_modules/@webcomponents/shadydom/src/patch-prototypes.js","../node_modules/@webcomponents/shadydom/src/shadydom.js","../node_modules/@webcomponents/custom-elements/src/Utilities.js","../node_modules/@webcomponents/custom-elements/src/CustomElementState.js","../node_modules/@webcomponents/custom-elements/src/CustomElementInternals.js","../node_modules/@webcomponents/custom-elements/src/DocumentConstructionObserver.js","../node_modules/@webcomponents/custom-elements/src/Deferred.js","../node_modules/@webcomponents/custom-elements/src/CustomElementRegistry.js","../node_modules/@webcomponents/custom-elements/src/Patch/Native.js","../node_modules/@webcomponents/custom-elements/src/AlreadyConstructedMarker.js","../node_modules/@webcomponents/custom-elements/src/Patch/HTMLElement.js","../node_modules/@webcomponents/custom-elements/src/Patch/Interface/ParentNode.js","../node_modules/@webcomponents/custom-elements/src/Patch/Document.js","../node_modules/@webcomponents/custom-elements/src/Patch/DocumentFragment.js","../node_modules/@webcomponents/custom-elements/src/Patch/Node.js","../node_modules/@webcomponents/custom-elements/src/Patch/Interface/ChildNode.js","../node_modules/@webcomponents/custom-elements/src/Patch/Element.js","../node_modules/@webcomponents/custom-elements/src/custom-elements.js","../node_modules/@webcomponents/shadycss/src/css-parse.js","../node_modules/@webcomponents/shadycss/src/style-settings.js","../node_modules/@webcomponents/shadycss/src/common-regex.js","../node_modules/@webcomponents/shadycss/src/unscoped-style-handler.js","../node_modules/@webcomponents/shadycss/src/style-util.js","../node_modules/@webcomponents/shadycss/src/style-transformer.js","../node_modules/@webcomponents/shadycss/src/style-info.js","../node_modules/@webcomponents/shadycss/src/style-properties.js","../node_modules/@webcomponents/shadycss/src/style-placeholder.js","../node_modules/@webcomponents/shadycss/src/style-cache.js","../node_modules/@webcomponents/shadycss/src/document-watcher.js","../node_modules/@webcomponents/shadycss/src/template-map.js","../node_modules/@webcomponents/shadycss/src/apply-shim-utils.js","../node_modules/@webcomponents/shadycss/src/common-utils.js","../node_modules/@webcomponents/shadycss/src/document-wait.js","../node_modules/@webcomponents/shadycss/src/custom-style-interface.js","../node_modules/@webcomponents/shadycss/src/scoping-shim.js","../node_modules/@webcomponents/shadycss/entrypoints/scoping-shim.js"],"sourcesContent":["/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n\nexport class ShadyData {\n  constructor() {\n    /** @type {ShadowRoot} */\n    this.root = null;\n    /** @type {ShadowRoot} */\n    this.publicRoot = null;\n    this.dirty = false;\n    this.observer = null;\n    /** @type {Array<Node>} */\n    this.assignedNodes = null;\n    /** @type {Element} */\n    this.assignedSlot = null;\n    /** @type {Array<Node>} */\n    this._previouslyAssignedNodes = null;\n    /** @type {Element} */\n    this._prevAssignedSlot = null;\n    /** @type {Array<Node>} */\n    this.flattenedNodes = null;\n    this.ownerShadyRoot = undefined;\n    /** @type {Node|undefined} */\n    this.parentNode = undefined;\n    /** @type {Node|undefined} */\n    this.firstChild = undefined;\n    /** @type {Node|undefined} */\n    this.lastChild = undefined;\n    /** @type {Node|undefined} */\n    this.previousSibling = undefined;\n    /** @type {Node|undefined} */\n    this.nextSibling = undefined;\n    /** @type {Array<Node>|undefined} */\n    this.childNodes = undefined;\n    this.__outsideAccessors = false;\n    this.__insideAccessors = false;\n    this.__onCallbackListeners = {};\n  }\n\n  /** @override */\n  toJSON() {\n    return {};\n  }\n}\n\nexport function ensureShadyDataForNode(node) {\n  if (!node.__shady) {\n    node.__shady = new ShadyData();\n  }\n  return node.__shady;\n}\n\nexport function shadyDataForNode(node) {\n  return node && node.__shady;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport {shadyDataForNode} from './shady-data.js';\n\n/** @type {!Object} */\nexport const settings = window['ShadyDOM'] || {};\n\nsettings.hasNativeShadowDOM = Boolean(Element.prototype.attachShadow && Node.prototype.getRootNode);\n\nconst desc = Object.getOwnPropertyDescriptor(Node.prototype, 'firstChild');\n\nsettings.hasDescriptors = Boolean(desc && desc.configurable && desc.get);\nsettings.inUse = settings['force'] || !settings.hasNativeShadowDOM;\nsettings.noPatch = settings['noPatch'] || false;\nsettings.preferPerformance = settings['preferPerformance'];\n\nexport const isTrackingLogicalChildNodes = (node) => {\n  const nodeData = shadyDataForNode(node);\n  return (nodeData && nodeData.firstChild !== undefined);\n}\n\nexport const isShadyRoot = (obj) => {\n  return Boolean(obj._localName === 'ShadyRoot');\n}\n\nexport const hasShadowRootWithSlot = (node) => {\n  const nodeData = shadyDataForNode(node);\n  let root = nodeData && nodeData.root;\n  return (root && root._hasInsertionPoint());\n}\n\nlet p = Element.prototype;\nlet matches = p.matches || p.matchesSelector ||\n  p.mozMatchesSelector || p.msMatchesSelector ||\n  p.oMatchesSelector || p.webkitMatchesSelector;\n\nexport const matchesSelector = (element, selector) => {\n  return matches.call(element, selector);\n}\n\nexport const mixin = (target, source) => {\n  for (var i in source) {\n    target[i] = source[i];\n  }\n  return target;\n}\n\n// NOTE, prefer MutationObserver over Promise for microtask timing\n// for consistency x-platform.\nlet twiddle = document.createTextNode('');\nlet content = 0;\nlet queue = [];\nnew MutationObserver(() => {\n  while (queue.length) {\n    // catch errors in user code...\n    try {\n      queue.shift()();\n    } catch(e) {\n      // enqueue another record and throw\n      twiddle.textContent = content++;\n      throw(e);\n    }\n  }\n}).observe(twiddle, {characterData: true});\n\n// use MutationObserver to get microtask async timing.\nexport const microtask = (callback) => {\n  queue.push(callback);\n  twiddle.textContent = content++;\n}\n\nexport const hasDocumentContains = Boolean(document.contains);\n\nexport const contains = (container, node) => {\n  while (node) {\n    if (node == container) {\n      return true;\n    }\n    node = node[SHADY_PREFIX + 'parentNode'];\n  }\n  return false;\n}\n\nconst getNodeHTMLCollectionName = (node) =>\n    node.getAttribute('id') || node.getAttribute('name');\n\nconst isValidHTMLCollectionName = (name) => name !== 'length' && isNaN(name);\n\nexport const createPolyfilledHTMLCollection = (nodes) => {\n  // Note: loop in reverse so that the first named item matches the named property\n  for (let l = nodes.length - 1; l >= 0; l--) {\n    const node = nodes[l];\n    const name = getNodeHTMLCollectionName(node);\n\n    if (name && isValidHTMLCollectionName(name)) {\n      nodes[name] = node;\n    }\n  }\n  nodes.item = function(index) {\n    return nodes[index];\n  }\n  nodes.namedItem = function(name) {\n    if (isValidHTMLCollectionName(name) && nodes[name]) {\n      return nodes[name];\n    }\n\n    for (const node of nodes) {\n      const nodeName = getNodeHTMLCollectionName(node);\n\n      if (nodeName == name) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n  return nodes;\n}\n\nexport const NATIVE_PREFIX = '__shady_native_';\nexport const SHADY_PREFIX = '__shady_';\n\n\n\n/**\n * Patch a group of accessors on an object only if it exists or if the `force`\n * argument is true.\n * @param {!Object} proto\n * @param {!Object} descriptors\n * @param {string=} prefix\n * @param {Array=} disallowedPatches\n */\nexport const patchProperties = (proto, descriptors, prefix = '', disallowedPatches) => {\n  for (let p in descriptors) {\n    const newDescriptor = descriptors[p];\n    if (disallowedPatches && disallowedPatches.indexOf(p) >= 0) {\n      continue;\n    }\n    newDescriptor.configurable = true;\n    const name = prefix + p;\n    // NOTE: we prefer writing directly because some browsers\n    // have descriptors that are writable but not configurable (e.g.\n    // `appendChild` on older browsers)\n    if (newDescriptor.value) {\n      proto[name] = newDescriptor.value;\n    } else {\n      // NOTE: this can throw if 'force' is used so catch the error.\n      try {\n        Object.defineProperty(proto, name, newDescriptor);\n      } catch(e) {\n        // this error is harmless so we just trap it.\n      }\n    }\n  }\n}\n\n/** @type {!function(new:HTMLElement)} */\nexport const NativeHTMLElement =\n    (window['customElements'] && window['customElements']['nativeHTMLElement']) ||\n    HTMLElement;\n\n// note, this is not a perfect polyfill since it doesn't include symbols\n/** @return {!Object<!ObjectPropertyDescriptor>} */\nexport const getOwnPropertyDescriptors = (obj) => {\n  const descriptors = {};\n  Object.getOwnPropertyNames(obj).forEach((name) => {\n    descriptors[name] = Object.getOwnPropertyDescriptor(obj, name);\n  });\n  return descriptors;\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\n// render enqueuer/flusher\nlet flushList = [];\nlet scheduled;\nexport function enqueue(callback) {\n  if (!scheduled) {\n    scheduled = true;\n    utils.microtask(flush);\n  }\n  flushList.push(callback);\n}\n\nexport function flush() {\n  scheduled = false;\n  let didFlush = Boolean(flushList.length);\n  while (flushList.length) {\n    flushList.shift()();\n  }\n  return didFlush;\n}\n\nflush['list'] = flushList;\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nclass AsyncObserver {\n\n  constructor() {\n    this._scheduled = false;\n    this.addedNodes = [];\n    this.removedNodes = [];\n    this.callbacks = new Set();\n  }\n\n  schedule() {\n    if (!this._scheduled) {\n      this._scheduled = true;\n      utils.microtask(() => {\n        this.flush();\n      });\n    }\n  }\n\n  flush() {\n    if (this._scheduled) {\n      this._scheduled = false;\n      let mutations = this.takeRecords();\n      if (mutations.length) {\n        this.callbacks.forEach(function(cb) {\n          cb(mutations);\n        });\n      }\n    }\n  }\n\n  takeRecords() {\n    if (this.addedNodes.length || this.removedNodes.length) {\n      let mutations = [{\n        addedNodes: this.addedNodes,\n        removedNodes: this.removedNodes\n      }];\n      this.addedNodes = [];\n      this.removedNodes = [];\n      return mutations;\n    }\n    return [];\n  }\n\n}\n\n// TODO(sorvell): consider instead polyfilling MutationObserver\n// directly so that users do not have to fork their code.\n// Supporting the entire api may be challenging: e.g. filtering out\n// removed nodes in the wrong scope and seeing non-distributing\n// subtree child mutations.\nexport let observeChildren = function(node, callback) {\n  const sd = ensureShadyDataForNode(node);\n  if (!sd.observer) {\n    sd.observer = new AsyncObserver();\n  }\n  sd.observer.callbacks.add(callback);\n  let observer = sd.observer;\n  return {\n    _callback: callback,\n    _observer: observer,\n    _node: node,\n    takeRecords() {\n      return observer.takeRecords()\n    }\n  };\n}\n\nexport let unobserveChildren = function(handle) {\n  let observer = handle && handle._observer;\n  if (observer) {\n    observer.callbacks.delete(handle._callback);\n    if (!observer.callbacks.size) {\n      ensureShadyDataForNode(handle._node).observer = null;\n    }\n  }\n}\n\nexport function filterMutations(mutations, target) {\n  /** @const {Node} */\n  const targetRootNode = target.getRootNode();\n  return mutations.map(function(mutation) {\n    /** @const {boolean} */\n    const mutationInScope = (targetRootNode === mutation.target.getRootNode());\n    if (mutationInScope && mutation.addedNodes) {\n      let nodes = Array.from(mutation.addedNodes).filter(function(n) {\n        return (targetRootNode === n.getRootNode());\n      });\n      if (nodes.length) {\n        mutation = Object.create(mutation);\n        Object.defineProperty(mutation, 'addedNodes', {\n          value: nodes,\n          configurable: true\n        });\n        return mutation;\n      }\n    } else if (mutationInScope) {\n      return mutation;\n    }\n  }).filter(function(m) { return m});\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n// Cribbed from ShadowDOM polyfill\n// https://github.com/webcomponents/webcomponentsjs/blob/master/src/ShadowDOM/wrappers/HTMLElement.js#L28\n/////////////////////////////////////////////////////////////////////////////\n// innerHTML and outerHTML\n\n// http://www.whatwg.org/specs/web-apps/current-work/multipage/the-end.html#escapingString\nlet escapeAttrRegExp = /[&\\u00A0\"]/g;\nlet escapeDataRegExp = /[&\\u00A0<>]/g;\n\nfunction escapeReplace(c) {\n  switch (c) {\n    case '&':\n      return '&amp;';\n    case '<':\n      return '&lt;';\n    case '>':\n      return '&gt;';\n    case '\"':\n      return '&quot;';\n    case '\\u00A0':\n      return '&nbsp;';\n  }\n}\n\nfunction escapeAttr(s) {\n  return s.replace(escapeAttrRegExp, escapeReplace);\n}\n\nfunction escapeData(s) {\n  return s.replace(escapeDataRegExp, escapeReplace);\n}\n\nfunction makeSet(arr) {\n  let set = {};\n  for (let i = 0; i < arr.length; i++) {\n    set[arr[i]] = true;\n  }\n  return set;\n}\n\n// http://www.whatwg.org/specs/web-apps/current-work/#void-elements\nlet voidElements = makeSet([\n  'area',\n  'base',\n  'br',\n  'col',\n  'command',\n  'embed',\n  'hr',\n  'img',\n  'input',\n  'keygen',\n  'link',\n  'meta',\n  'param',\n  'source',\n  'track',\n  'wbr'\n]);\n\nlet plaintextParents = makeSet([\n  'style',\n  'script',\n  'xmp',\n  'iframe',\n  'noembed',\n  'noframes',\n  'plaintext',\n  'noscript'\n]);\n\n/**\n * @param {Node} node\n * @param {Node} parentNode\n * @param {Function=} callback\n */\nexport function getOuterHTML(node, parentNode, callback) {\n  switch (node.nodeType) {\n    case Node.ELEMENT_NODE: {\n      let tagName = node.localName;\n      let s = '<' + tagName;\n      let attrs = node.attributes;\n      for (let i = 0, attr; (attr = attrs[i]); i++) {\n        s += ' ' + attr.name + '=\"' + escapeAttr(attr.value) + '\"';\n      }\n      s += '>';\n      if (voidElements[tagName]) {\n        return s;\n      }\n      return s + getInnerHTML(node, callback) + '</' + tagName + '>';\n    }\n    case Node.TEXT_NODE: {\n      let data = /** @type {Text} */ (node).data;\n      if (parentNode && plaintextParents[parentNode.localName]) {\n        return data;\n      }\n      return escapeData(data);\n    }\n    case Node.COMMENT_NODE: {\n      return '<!--' + /** @type {Comment} */ (node).data + '-->';\n    }\n    default: {\n      window.console.error(node);\n      throw new Error('not implemented');\n    }\n  }\n}\n\n/**\n * @param {Node} node\n * @param {Function=} callback\n */\nexport function getInnerHTML(node, callback) {\n  if (node.localName === 'template') {\n    node =  /** @type {HTMLTemplateElement} */ (node).content;\n  }\n  let s = '';\n  let c$ = callback ? callback(node) : node.childNodes;\n  for (let i=0, l=c$.length, child; (i<l) && (child=c$[i]); i++) {\n    s += getOuterHTML(child, node, callback);\n  }\n  return s;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from './utils.js';\nimport {patchProperties} from './utils.js';\nimport {getInnerHTML} from './innerHTML.js';\n\nconst hasDescriptors = utils.settings.hasDescriptors;\nexport const NATIVE_PREFIX = utils.NATIVE_PREFIX;\n\n// Object on which raw native methods are stored.\n// e.g. `nativeMethods.querySelector.call(node, selector)`\n// same as `node.querySelector(selector)`\nexport const nativeMethods = {\n  /** @this {Element} */\n  querySelector(selector) {\n    return this[NATIVE_PREFIX + 'querySelector'](selector);\n  },\n  /** @this {Element} */\n  querySelectorAll(selector) {\n    return this[NATIVE_PREFIX + 'querySelectorAll'](selector);\n  }\n};\n// Object on which raw native accessors are available via `accessorName(node)`.\n// e.g. `nativeTree.firstChild(node)`\n// same as `node.firstChild`\nexport const nativeTree = {};\n\nconst installNativeAccessor = (name) => {\n  nativeTree[name] = (node) => node[NATIVE_PREFIX + name];\n}\n\nconst installNativeMethod = (name, fn) => {\n  if (!nativeMethods[name]) {\n    nativeMethods[name] = fn;\n  }\n}\n\n\nconst defineNativeAccessors = (proto, descriptors) => {\n  patchProperties(proto, descriptors, NATIVE_PREFIX);\n  // make native accessors available to users\n  for (let prop in descriptors) {\n    installNativeAccessor(prop);\n  }\n}\n\nconst copyProperties = (proto, list = []) => {\n  for (let i = 0; i < list.length; i++) {\n    const name = list[i];\n    const descriptor = Object.getOwnPropertyDescriptor(proto, name);\n    if (descriptor) {\n      Object.defineProperty(proto, NATIVE_PREFIX + name, descriptor);\n      // make native methods/accessors available to users\n      if (descriptor.value) {\n        installNativeMethod(name, descriptor.value);\n      } else {\n        installNativeAccessor(name);\n\n      }\n    }\n  }\n}\n\n/** @type {!TreeWalker} */\nconst nodeWalker = document.createTreeWalker(document, NodeFilter.SHOW_ALL,\n  null, false);\n\n/** @type {!TreeWalker} */\nconst elementWalker = document.createTreeWalker(document, NodeFilter.SHOW_ELEMENT,\n  null, false);\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nconst clearNode = node => {\n  let firstChild;\n  while ((firstChild = node[NATIVE_PREFIX + 'firstChild'])) {\n    node[NATIVE_PREFIX + 'removeChild'](firstChild);\n  }\n}\n\nconst ParentNodeAccessors = [\n  'firstElementChild',\n  'lastElementChild',\n  'children',\n  'childElementCount',\n];\n\nconst ParentNodeMethods = [\n  'querySelector',\n  'querySelectorAll'\n  // 'append', 'prepend'\n];\n\nexport const addNativePrefixedProperties = () => {\n\n  // EventTarget\n  const eventProps = [\n    'dispatchEvent',\n    'addEventListener',\n    'removeEventListener'\n  ];\n  if (window.EventTarget) {\n    copyProperties(window.EventTarget.prototype, eventProps);\n  } else {\n    copyProperties(Node.prototype, eventProps);\n    copyProperties(Window.prototype, eventProps);\n  }\n\n\n  // Node\n  if (hasDescriptors) {\n    copyProperties(Node.prototype, [\n      'parentNode',\n      'firstChild',\n      'lastChild',\n      'previousSibling',\n      'nextSibling',\n      'childNodes',\n      'parentElement',\n      'textContent',\n    ]);\n  } else {\n    defineNativeAccessors(Node.prototype, {\n      parentNode: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.parentNode();\n        }\n      },\n      firstChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.firstChild();\n        }\n      },\n      lastChild: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.lastChild();\n        }\n\n      },\n      previousSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.previousSibling();\n        }\n      },\n      nextSibling: {\n        /** @this {Node} */\n        get() {\n          nodeWalker.currentNode = this;\n          return nodeWalker.nextSibling();\n        }\n      },\n      // TODO(sorvell): make this a NodeList or whatever\n      childNodes: {\n        /** @this {Node} */\n        get() {\n          const nodes = [];\n          nodeWalker.currentNode = this;\n          let n = nodeWalker.firstChild();\n          while (n) {\n            nodes.push(n);\n            n = nodeWalker.nextSibling();\n          }\n          return nodes;\n        }\n      },\n      parentElement: {\n        /** @this {Node} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.parentNode();\n        }\n      },\n      textContent: {\n        /** @this {Node} */\n        get() {\n          /* eslint-disable no-case-declarations */\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              // TODO(sorvell): This cannot be a single TreeWalker that's reused\n              // at least for Safari 9, but it's unclear why.\n              const textWalker = document.createTreeWalker(this, NodeFilter.SHOW_TEXT,\n                null, false);\n              let content = '', n;\n              while ( (n = textWalker.nextNode()) ) {\n                // TODO(sorvell): can't use textContent since we patch it on Node.prototype!\n                // However, should probably patch it only on element.\n                content += n.nodeValue;\n              }\n              return content;\n            default:\n              return this.nodeValue;\n          }\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Node} */\n        set(value) {\n          if (typeof value === 'undefined' || value === null) {\n            value = ''\n          }\n          switch (this.nodeType) {\n            case Node.ELEMENT_NODE:\n            case Node.DOCUMENT_FRAGMENT_NODE:\n              clearNode(this);\n              // Document fragments must have no childnodes if setting a blank string\n              if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n                // Note: old Chrome versions require 2nd argument here\n                this[NATIVE_PREFIX + 'insertBefore'](document.createTextNode(value), undefined);\n              }\n              break;\n            default:\n              // TODO(sorvell): can't do this if patch nodeValue.\n              this.nodeValue = value;\n              break;\n          }\n        }\n      }\n    });\n  }\n\n  copyProperties(Node.prototype, [\n    'appendChild',\n    'insertBefore',\n    'removeChild',\n    'replaceChild',\n    'cloneNode',\n    'contains'\n  ]);\n\n  const ParentNodeWalkerDescriptors = {\n    firstElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.firstChild();\n      }\n    },\n    lastElementChild: {\n      /** @this {ParentNode} */\n      get() {\n        elementWalker.currentNode = this;\n        return elementWalker.lastChild();\n      }\n    },\n    children: {\n      /** @this {ParentNode} */\n      get() {\n        let nodes = [];\n        elementWalker.currentNode = this;\n        let n = elementWalker.firstChild();\n        while (n) {\n          nodes.push(n);\n          n = elementWalker.nextSibling();\n        }\n        return utils.createPolyfilledHTMLCollection(nodes);\n      }\n    },\n    childElementCount: {\n      /** @this {ParentNode} */\n      get() {\n        if (this.children) {\n          return this.children.length;\n        }\n        return 0;\n      }\n    }\n  };\n\n  // Element\n  if (hasDescriptors) {\n    copyProperties(Element.prototype, ParentNodeAccessors);\n\n    copyProperties(Element.prototype, [\n      'previousElementSibling',\n      'nextElementSibling',\n      'innerHTML'\n    ]);\n\n    // NOTE, on IE 11 / Edge 15 children and/or innerHTML are on HTMLElement instead of Element\n    if (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'children')) {\n      copyProperties(HTMLElement.prototype, [\n        'children'\n      ]);\n    }\n    if (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'innerHTML')) {\n      copyProperties(HTMLElement.prototype, [\n        'innerHTML'\n      ]);\n    }\n  } else {\n    defineNativeAccessors(Element.prototype, ParentNodeWalkerDescriptors);\n    defineNativeAccessors(Element.prototype, {\n      previousElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.previousSibling();\n        }\n      },\n      nextElementSibling: {\n        /** @this {Element} */\n        get() {\n          elementWalker.currentNode = this;\n          return elementWalker.nextSibling();\n        }\n      },\n      innerHTML: {\n        /** @this {Element} */\n        get() {\n          return getInnerHTML(this, n => n[NATIVE_PREFIX + 'childNodes']);\n        },\n        // Needed on browsers that do not proper accessors (e.g. old versions of Chrome)\n        /** @this {Element} */\n        set(value) {\n          const content = this.localName === 'template' ?\n          /** @type {HTMLTemplateElement} */(this).content : this;\n          clearNode(content);\n          const containerName = this.localName || 'div';\n          let htmlContainer;\n          if (!this.namespaceURI || this.namespaceURI === inertDoc.namespaceURI) {\n            htmlContainer = inertDoc.createElement(containerName);\n          } else {\n            htmlContainer = inertDoc.createElementNS(this.namespaceURI, containerName);\n          }\n          htmlContainer.innerHTML = value;\n          const newContent = this.localName === 'template' ?\n            /** @type {HTMLTemplateElement} */(htmlContainer).content : htmlContainer;\n          let firstChild;\n          while ((firstChild = newContent[NATIVE_PREFIX + 'firstChild'])) {\n            // Note: old Chrome versions require 2nd argument here\n            content[NATIVE_PREFIX + 'insertBefore'](firstChild, undefined);\n          }\n        }\n      }\n    });\n  }\n\n  copyProperties(Element.prototype, [\n    'setAttribute',\n    'getAttribute',\n    'hasAttribute',\n    'removeAttribute',\n    // on older Safari, these are on Element.\n    'focus',\n    'blur',\n  ]);\n  copyProperties(Element.prototype, ParentNodeMethods);\n\n  // HTMLElement\n  copyProperties(HTMLElement.prototype, [\n    'focus',\n    'blur',\n    // On IE these are on HTMLElement\n    'contains'\n  ]);\n\n  if (hasDescriptors) {\n    copyProperties(HTMLElement.prototype, [\n      'parentElement',\n      'children',\n      'innerHTML'\n    ]);\n  }\n\n  // HTMLTemplateElement\n  if (window.HTMLTemplateElement) {\n    copyProperties(window.HTMLTemplateElement.prototype, ['innerHTML']);\n  }\n\n  // DocumentFragment\n  if (hasDescriptors) {\n    // NOTE, IE 11 does not have on DocumentFragment\n    // firstElementChild\n    // lastElementChild\n    copyProperties(DocumentFragment.prototype, ParentNodeAccessors);\n  } else {\n    defineNativeAccessors(DocumentFragment.prototype, ParentNodeWalkerDescriptors);\n  }\n\n  copyProperties(DocumentFragment.prototype, ParentNodeMethods);\n\n  // Document\n  if (hasDescriptors) {\n    copyProperties(Document.prototype, ParentNodeAccessors);\n    copyProperties(Document.prototype, [\n      'activeElement'\n    ]);\n  } else {\n    defineNativeAccessors(Document.prototype, ParentNodeWalkerDescriptors);\n  }\n\n  copyProperties(Document.prototype, [\n    'importNode',\n    'getElementById'\n  ]);\n  copyProperties(Document.prototype, ParentNodeMethods);\n\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {ensureShadyDataForNode} from './shady-data.js';\n\nexport const InsideDescriptors = utils.getOwnPropertyDescriptors({\n\n  /** @this {Node} */\n  get childNodes() {\n    return this[utils.SHADY_PREFIX + 'childNodes'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    return this[utils.SHADY_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    return this[utils.SHADY_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get textContent() {\n    return this[utils.SHADY_PREFIX + 'textContent'];\n  },\n\n  /** @this {Node} */\n  set textContent(value) {\n    this[utils.SHADY_PREFIX + 'textContent'] = value;\n  },\n\n  /** @this {Node} */\n  get childElementCount() {\n    return this[utils.SHADY_PREFIX + 'childElementCount'];\n  },\n\n  /** @this {Node} */\n  get children() {\n    return this[utils.SHADY_PREFIX + 'children'];\n  },\n\n  /** @this {Node} */\n  get firstElementChild() {\n    return this[utils.SHADY_PREFIX + 'firstElementChild'];\n  },\n\n  /** @this {Node} */\n  get lastElementChild() {\n    return this[utils.SHADY_PREFIX + 'lastElementChild'];\n  },\n\n  /** @this {Node} */\n  get innerHTML() {\n    return this[utils.SHADY_PREFIX + 'innerHTML'];\n  },\n\n  /** @this {Node} */\n  set innerHTML(value) {\n    return this[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  },\n\n  /** @this {Node} */\n  get shadowRoot() {\n    return this[utils.SHADY_PREFIX + 'shadowRoot'];\n  }\n\n});\n\nexport const OutsideDescriptors = utils.getOwnPropertyDescriptors({\n\n  /** @this {Node} */\n  get parentElement() {\n    return this[utils.SHADY_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get parentNode() {\n    return this[utils.SHADY_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    return this[utils.SHADY_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    return this[utils.SHADY_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get nextElementSibling() {\n    return this[utils.SHADY_PREFIX + 'nextElementSibling'];\n  },\n\n  /** @this {Node} */\n  get previousElementSibling() {\n    return this[utils.SHADY_PREFIX + 'previousElementSibling'];\n  },\n\n  /** @this {Node} */\n  get className() {\n    return this[utils.SHADY_PREFIX + 'className'];\n  },\n\n  /** @this {Node} */\n  set className(value) {\n    return this[utils.SHADY_PREFIX + 'className'] = value;\n  }\n\n});\n\nfor (let prop in InsideDescriptors) {\n  InsideDescriptors[prop].enumerable = false;\n}\n\nfor (let prop in OutsideDescriptors) {\n  OutsideDescriptors[prop].enumerable = false;\n}\n\nconst noInstancePatching = utils.settings.hasDescriptors || utils.settings.noPatch;\n\n// ensure an element has patched \"outside\" accessors; no-op when not needed\nexport let patchOutsideElementAccessors = noInstancePatching ?\n  function() {} : function(element) {\n    const sd = ensureShadyDataForNode(element);\n    if (!sd.__outsideAccessors) {\n      sd.__outsideAccessors = true;\n      utils.patchProperties(element, OutsideDescriptors);\n    }\n  }\n\n// ensure an element has patched \"inside\" accessors; no-op when not needed\nexport let patchInsideElementAccessors = noInstancePatching ?\n  function() {} : function(element) {\n    const sd = ensureShadyDataForNode(element);\n    if (!sd.__insideAccessors) {\n      sd.__insideAccessors = true;\n      utils.patchProperties(element, InsideDescriptors);\n    }\n  }","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {shadyDataForNode} from './shady-data.js';\n\n/*\nMake this name unique so it is unlikely to conflict with properties on objects passed to `addEventListener`\nhttps://github.com/webcomponents/shadydom/issues/173\n*/\nconst /** string */ eventWrappersName = `__eventWrappers${Date.now()}`;\n\n/** @type {?function(!Event): boolean} */\nconst composedGetter = (() => {\n  const composedProp = Object.getOwnPropertyDescriptor(Event.prototype, 'composed');\n  return composedProp ? (ev) => composedProp.get.call(ev) : null;\n})();\n\n// https://github.com/w3c/webcomponents/issues/513#issuecomment-224183937\nconst alwaysComposed = {\n  'blur': true,\n  'focus': true,\n  'focusin': true,\n  'focusout': true,\n  'click': true,\n  'dblclick': true,\n  'mousedown': true,\n  'mouseenter': true,\n  'mouseleave': true,\n  'mousemove': true,\n  'mouseout': true,\n  'mouseover': true,\n  'mouseup': true,\n  'wheel': true,\n  'beforeinput': true,\n  'input': true,\n  'keydown': true,\n  'keyup': true,\n  'compositionstart': true,\n  'compositionupdate': true,\n  'compositionend': true,\n  'touchstart': true,\n  'touchend': true,\n  'touchmove': true,\n  'touchcancel': true,\n  'pointerover': true,\n  'pointerenter': true,\n  'pointerdown': true,\n  'pointermove': true,\n  'pointerup': true,\n  'pointercancel': true,\n  'pointerout': true,\n  'pointerleave': true,\n  'gotpointercapture': true,\n  'lostpointercapture': true,\n  'dragstart': true,\n  'drag': true,\n  'dragenter': true,\n  'dragleave': true,\n  'dragover': true,\n  'drop': true,\n  'dragend': true,\n  'DOMActivate': true,\n  'DOMFocusIn': true,\n  'DOMFocusOut': true,\n  'keypress': true\n};\n\nconst unpatchedEvents = {\n  'DOMAttrModified': true,\n  'DOMAttributeNameChanged': true,\n  'DOMCharacterDataModified': true,\n  'DOMElementNameChanged': true,\n  'DOMNodeInserted': true,\n  'DOMNodeInsertedIntoDocument': true,\n  'DOMNodeRemoved': true,\n  'DOMNodeRemovedFromDocument': true,\n  'DOMSubtreeModified': true\n}\n\n/**\n * Some EventTarget subclasses are not Node subclasses, and you cannot call\n * `getRootNode()` on them.\n *\n * @param {!(Node|EventTarget)} eventTarget\n * @return {!(Node|EventTarget)}\n */\nfunction getRootNodeWithFallback(eventTarget) {\n  if (eventTarget instanceof Node) {\n    return eventTarget[utils.SHADY_PREFIX + 'getRootNode']();\n  } else {\n    return eventTarget;\n  }\n}\n\nfunction pathComposer(startNode, composed) {\n  let composedPath = [];\n  let current = startNode;\n  let startRoot = getRootNodeWithFallback(startNode);\n  while (current) {\n    composedPath.push(current);\n    if (current[utils.SHADY_PREFIX + 'assignedSlot']) {\n      current = current[utils.SHADY_PREFIX + 'assignedSlot'];\n    } else if (current.nodeType === Node.DOCUMENT_FRAGMENT_NODE && current.host && (composed || current !== startRoot)) {\n      current = current.host;\n    } else {\n      current = current[utils.SHADY_PREFIX + 'parentNode'];\n    }\n  }\n  // event composedPath includes window when startNode's ownerRoot is document\n  if (composedPath[composedPath.length - 1] === document) {\n    composedPath.push(window);\n  }\n  return composedPath;\n}\n\nexport const composedPath = (event) => {\n  if (!event.__composedPath) {\n    event.__composedPath = pathComposer(event.target, true);\n  }\n  return event.__composedPath;\n}\n\nfunction retarget(refNode, path) {\n  if (!utils.isShadyRoot) {\n    return refNode;\n  }\n  // If ANCESTOR's root is not a shadow root or ANCESTOR's root is BASE's\n  // shadow-including inclusive ancestor, return ANCESTOR.\n  let refNodePath = pathComposer(refNode, true);\n  let p$ = path;\n  for (let i=0, ancestor, lastRoot, root, rootIdx; i < p$.length; i++) {\n    ancestor = p$[i];\n    root = getRootNodeWithFallback(ancestor);\n    if (root !== lastRoot) {\n      rootIdx = refNodePath.indexOf(root);\n      lastRoot = root;\n    }\n    if (!utils.isShadyRoot(root) || rootIdx > -1) {\n      return ancestor;\n    }\n  }\n}\n\nlet EventPatches = {\n\n  /**\n   * @this {Event}\n   */\n  get composed() {\n    if (this.__composed === undefined) {\n      // if there's an original `composed` getter on the Event prototype, use that\n      if (composedGetter) {\n        // TODO(web-padawan): see https://github.com/webcomponents/shadydom/issues/275\n        this.__composed = this.type === 'focusin' || this.type === 'focusout' || composedGetter(this);\n      // If the event is trusted, or `isTrusted` is not supported, check the list of always composed events\n      } else if (this.isTrusted !== false) {\n        this.__composed = alwaysComposed[this.type];\n      }\n    }\n    return /** @type {!Event} */(this).__composed || false;\n  },\n\n  /**\n   * @this {Event}\n   */\n  composedPath() {\n    if (!this.__composedPath) {\n      this.__composedPath = pathComposer(this['__target'], this.composed);\n    }\n    return /** @type {!Event} */(this).__composedPath;\n  },\n\n  /**\n   * @this {Event}\n   */\n  get target() {\n    return retarget(this.currentTarget || this['__previousCurrentTarget'], this.composedPath());\n  },\n\n  // http://w3c.github.io/webcomponents/spec/shadow/#event-relatedtarget-retargeting\n  /**\n   * @this {Event}\n   */\n  get relatedTarget() {\n    if (!this.__relatedTarget) {\n      return null;\n    }\n    if (!this.__relatedTargetComposedPath) {\n      this.__relatedTargetComposedPath = pathComposer(this.__relatedTarget, true);\n    }\n    // find the deepest node in relatedTarget composed path that is in the same root with the currentTarget\n    return retarget(this.currentTarget || this['__previousCurrentTarget'], /** @type {!Event} */(this).__relatedTargetComposedPath);\n  },\n  /**\n   * @this {Event}\n   */\n  stopPropagation() {\n    Event.prototype.stopPropagation.call(this);\n    this.__propagationStopped = true;\n  },\n  /**\n   * @this {Event}\n   */\n  stopImmediatePropagation() {\n    Event.prototype.stopImmediatePropagation.call(this);\n    this.__immediatePropagationStopped = true;\n    this.__propagationStopped = true;\n  }\n\n};\n\nfunction mixinComposedFlag(Base) {\n  // NOTE: avoiding use of `class` here so that transpiled output does not\n  // try to do `Base.call` with a dom construtor.\n  let klazz = function(type, options) {\n    let event = new Base(type, options);\n    event.__composed = options && Boolean(options['composed']);\n    return event;\n  }\n  // put constructor properties on subclass\n  klazz.__proto__ = Base;\n  klazz.prototype = Base.prototype;\n  return klazz;\n}\n\nlet nonBubblingEventsToRetarget = {\n  'focus': true,\n  'blur': true\n};\n\n\n/**\n * Check if the event has been retargeted by comparing original `target`, and calculated `target`\n * @param {Event} event\n * @return {boolean} True if the original target and calculated target are the same\n */\nfunction hasRetargeted(event) {\n  return event['__target'] !== event.target || event.__relatedTarget !== event.relatedTarget;\n}\n\n/**\n *\n * @param {Event} event\n * @param {Node} node\n * @param {string} phase\n */\nfunction fireHandlers(event, node, phase) {\n  let hs = node.__handlers && node.__handlers[event.type] &&\n    node.__handlers[event.type][phase];\n  if (hs) {\n    for (let i = 0, fn; (fn = hs[i]); i++) {\n      if (hasRetargeted(event) && event.target === event.relatedTarget) {\n        return;\n      }\n      fn.call(node, event);\n      if (event.__immediatePropagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\nfunction retargetNonBubblingEvent(e) {\n  let path = e.composedPath();\n  let node;\n  // override `currentTarget` to let patched `target` calculate correctly\n  Object.defineProperty(e, 'currentTarget', {\n    get: function() {\n      return node;\n    },\n    configurable: true\n  });\n  for (let i = path.length - 1; i >= 0; i--) {\n    node = path[i];\n    // capture phase fires all capture handlers\n    fireHandlers(e, node, 'capture');\n    if (e.__propagationStopped) {\n      return;\n    }\n  }\n\n  // set the event phase to `AT_TARGET` as in spec\n  Object.defineProperty(e, 'eventPhase', {get() { return Event.AT_TARGET }});\n\n  // the event only needs to be fired when owner roots change when iterating the event path\n  // keep track of the last seen owner root\n  let lastFiredRoot;\n  for (let i = 0; i < path.length; i++) {\n    node = path[i];\n    const nodeData = shadyDataForNode(node);\n    const root = nodeData && nodeData.root;\n    if (i === 0 || (root && root === lastFiredRoot)) {\n      fireHandlers(e, node, 'bubble');\n      // don't bother with window, it doesn't have `getRootNode` and will be last in the path anyway\n      if (node !== window) {\n        lastFiredRoot = node[utils.SHADY_PREFIX + 'getRootNode']();\n      }\n      if (e.__propagationStopped) {\n        return;\n      }\n    }\n  }\n}\n\nfunction listenerSettingsEqual(savedListener, node, type, capture, once, passive) {\n  let {\n    node: savedNode,\n    type: savedType,\n    capture: savedCapture,\n    once: savedOnce,\n    passive: savedPassive\n  } = savedListener;\n  return node === savedNode &&\n    type === savedType &&\n    capture === savedCapture &&\n    once === savedOnce &&\n    passive === savedPassive;\n}\n\nexport function findListener(wrappers, node, type, capture, once, passive) {\n  for (let i = 0; i < wrappers.length; i++) {\n    if (listenerSettingsEqual(wrappers[i], node, type, capture, once, passive)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Firefox can throw on accessing eventWrappers inside of `removeEventListener` during a selenium run\n * Try/Catch accessing eventWrappers to work around\n * https://bugzilla.mozilla.org/show_bug.cgi?id=1353074\n */\nfunction getEventWrappers(eventLike) {\n  let wrappers = null;\n  try {\n    wrappers = eventLike[eventWrappersName];\n  } catch (e) {} // eslint-disable-line no-empty\n  return wrappers;\n}\n\n/**\n * @this {EventTarget}\n */\nexport function addEventListener(type, fnOrObj, optionsOrCapture) {\n  if (!fnOrObj) {\n    return;\n  }\n\n  const handlerType = typeof fnOrObj;\n\n  // bail if `fnOrObj` is not a function, not an object\n  if (handlerType !== 'function' && handlerType !== 'object') {\n    return;\n  }\n\n  // bail if `fnOrObj` is an object without a `handleEvent` method\n  if (handlerType === 'object' && (!fnOrObj.handleEvent || typeof fnOrObj.handleEvent !== 'function')) {\n    return;\n  }\n\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'addEventListener'](type, fnOrObj, optionsOrCapture);\n  }\n\n  // The callback `fn` might be used for multiple nodes/events. Since we generate\n  // a wrapper function, we need to keep track of it when we remove the listener.\n  // It's more efficient to store the node/type/options information as Array in\n  // `fn` itself rather than the node (we assume that the same callback is used\n  // for few nodes at most, whereas a node will likely have many event listeners).\n  // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n  let capture, once, passive;\n  if (optionsOrCapture && typeof optionsOrCapture === 'object') {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    passive = Boolean(optionsOrCapture.passive);\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n    passive = false;\n  }\n  // hack to let ShadyRoots have event listeners\n  // event listener will be on host, but `currentTarget`\n  // will be set to shadyroot for event listener\n  let target = (optionsOrCapture && optionsOrCapture.__shadyTarget) || this;\n\n  let wrappers = fnOrObj[eventWrappersName];\n  if (wrappers) {\n    // Stop if the wrapper function has already been created.\n    if (findListener(wrappers, target, type, capture, once, passive) > -1) {\n      return;\n    }\n  } else {\n    fnOrObj[eventWrappersName] = [];\n  }\n\n  /**\n   * @this {HTMLElement}\n   * @param {Event} e\n   */\n  const wrapperFn = function(e) {\n    // Support `once` option.\n    if (once) {\n      this[utils.SHADY_PREFIX + 'removeEventListener'](type, fnOrObj, optionsOrCapture);\n    }\n    if (!e['__target']) {\n      patchEvent(e);\n    }\n    let lastCurrentTargetDesc;\n    if (target !== this) {\n      // replace `currentTarget` to make `target` and `relatedTarget` correct for inside the shadowroot\n      lastCurrentTargetDesc = Object.getOwnPropertyDescriptor(e, 'currentTarget');\n      Object.defineProperty(e, 'currentTarget', {get() { return target }, configurable: true});\n    }\n    e['__previousCurrentTarget'] = e['currentTarget'];\n    // Always check if a shadowRoot is in the current event path.\n    // If it is not, the event was generated on either the host of the shadowRoot\n    // or a children of the host.\n    if (utils.isShadyRoot(target) && e.composedPath().indexOf(target) == -1) {\n      return;\n    }\n    // There are two critera that should stop events from firing on this node\n    // 1. the event is not composed and the current node is not in the same root as the target\n    // 2. when bubbling, if after retargeting, relatedTarget and target point to the same node\n    if (e.composed || e.composedPath().indexOf(target) > -1) {\n      if (hasRetargeted(e) && e.target === e.relatedTarget) {\n        if (e.eventPhase === Event.BUBBLING_PHASE) {\n          e.stopImmediatePropagation();\n        }\n        return;\n      }\n      // prevent non-bubbling events from triggering bubbling handlers on shadowroot, but only if not in capture phase\n      if (e.eventPhase !== Event.CAPTURING_PHASE && !e.bubbles && e.target !== target && !(target instanceof Window)) {\n        return;\n      }\n      let ret = handlerType === 'function' ?\n        fnOrObj.call(target, e) :\n        (fnOrObj.handleEvent && fnOrObj.handleEvent(e));\n      if (target !== this) {\n        // replace the \"correct\" `currentTarget`\n        if (lastCurrentTargetDesc) {\n          Object.defineProperty(e, 'currentTarget', lastCurrentTargetDesc);\n          lastCurrentTargetDesc = null;\n        } else {\n          delete e['currentTarget'];\n        }\n      }\n      return ret;\n    }\n  };\n\n  // Store the wrapper information.\n  fnOrObj[eventWrappersName].push({\n    // note: use target here which is either a shadowRoot\n    // (when the host element is proxy'ing the event) or this element\n    node: target,\n    type: type,\n    capture: capture,\n    once: once,\n    passive: passive,\n    wrapperFn: wrapperFn\n  });\n\n  if (nonBubblingEventsToRetarget[type]) {\n    this.__handlers = this.__handlers || {};\n    this.__handlers[type] = this.__handlers[type] ||\n      {'capture': [], 'bubble': []};\n    this.__handlers[type][capture ? 'capture' : 'bubble'].push(wrapperFn);\n  } else {\n    this[utils.NATIVE_PREFIX + 'addEventListener'](type, wrapperFn, optionsOrCapture);\n  }\n}\n\n/**\n * @this {EventTarget}\n */\nexport function removeEventListener(type, fnOrObj, optionsOrCapture) {\n  if (!fnOrObj) {\n    return;\n  }\n  if (unpatchedEvents[type]) {\n    return this[utils.NATIVE_PREFIX + 'removeEventListener'](type, fnOrObj, optionsOrCapture);\n  }\n  // NOTE(valdrin) invoking external functions is costly, inline has better perf.\n  let capture, once, passive;\n  if (optionsOrCapture && typeof optionsOrCapture === 'object') {\n    capture = Boolean(optionsOrCapture.capture);\n    once = Boolean(optionsOrCapture.once);\n    passive = Boolean(optionsOrCapture.passive);\n  } else {\n    capture = Boolean(optionsOrCapture);\n    once = false;\n    passive = false;\n  }\n  let target = (optionsOrCapture && optionsOrCapture.__shadyTarget) || this;\n  // Search the wrapped function.\n  let wrapperFn = undefined;\n  let wrappers = getEventWrappers(fnOrObj);\n  if (wrappers) {\n    let idx = findListener(wrappers, target, type, capture, once, passive);\n    if (idx > -1) {\n      wrapperFn = wrappers.splice(idx, 1)[0].wrapperFn;\n      // Cleanup.\n      if (!wrappers.length) {\n        fnOrObj[eventWrappersName] = undefined;\n      }\n    }\n  }\n  this[utils.NATIVE_PREFIX + 'removeEventListener'](type, wrapperFn || fnOrObj, optionsOrCapture);\n  if (wrapperFn && nonBubblingEventsToRetarget[type] &&\n      this.__handlers && this.__handlers[type]) {\n    const arr = this.__handlers[type][capture ? 'capture' : 'bubble'];\n    const idx = arr.indexOf(wrapperFn);\n    if (idx > -1) {\n      arr.splice(idx, 1);\n    }\n  }\n}\n\nfunction activateFocusEventOverrides() {\n  for (let ev in nonBubblingEventsToRetarget) {\n    window[utils.NATIVE_PREFIX + 'addEventListener'](ev, function(e) {\n      if (!e['__target']) {\n        patchEvent(e);\n        retargetNonBubblingEvent(e);\n      }\n    }, true);\n  }\n}\n\nconst EventPatchesDescriptors = utils.getOwnPropertyDescriptors(EventPatches);\n\nconst SHADY_PROTO = '__shady_patchedProto';\nconst SHADY_SOURCE_PROTO = '__shady_sourceProto';\n\nfunction patchEvent(event) {\n  event['__target'] = event.target;\n  event.__relatedTarget = event.relatedTarget;\n  // attempt to patch prototype (via cache)\n  if (utils.settings.hasDescriptors) {\n    const proto = Object.getPrototypeOf(event);\n    if (!Object.hasOwnProperty(proto, SHADY_PROTO)) {\n      const patchedProto = Object.create(proto);\n      patchedProto[SHADY_SOURCE_PROTO] = proto;\n      utils.patchProperties(patchedProto, EventPatchesDescriptors);\n      proto[SHADY_PROTO] = patchedProto;\n    }\n    event.__proto__ = proto[SHADY_PROTO];\n  // and fallback to patching instance\n  } else {\n    utils.patchProperties(event, EventPatchesDescriptors);\n  }\n}\n\nlet PatchedEvent = mixinComposedFlag(Event);\nlet PatchedCustomEvent = mixinComposedFlag(CustomEvent);\nlet PatchedMouseEvent = mixinComposedFlag(MouseEvent);\n\n\nexport function patchEvents() {\n  activateFocusEventOverrides();\n  window.Event = PatchedEvent;\n  window.CustomEvent = PatchedCustomEvent;\n  window.MouseEvent = PatchedMouseEvent;\n}\n\nexport function patchClick() {\n  // Fix up `Element.prototype.click()` if `isTrusted` is supported, but `composed` isn't\n  if (!composedGetter && Object.getOwnPropertyDescriptor(Event.prototype, 'isTrusted')) {\n    /** @this {Element} */\n    const composedClickFn = function() {\n      const ev = new MouseEvent('click', {\n        bubbles: true,\n        cancelable: true,\n        composed: true\n      });\n      this[utils.SHADY_PREFIX + 'dispatchEvent'](ev);\n    };\n    if (Element.prototype.click) {\n      Element.prototype.click = composedClickFn;\n    } else if (HTMLElement.prototype.click) {\n      HTMLElement.prototype.click = composedClickFn;\n    }\n  }\n}\n\nexport const eventPropertyNames = Object.getOwnPropertyNames(Document.prototype)\n    .filter(name => name.substring(0,2) === 'on');\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nfunction newSplice(index, removed, addedCount) {\n  return {\n    index: index,\n    removed: removed,\n    addedCount: addedCount\n  };\n}\n\nconst EDIT_LEAVE = 0;\nconst EDIT_UPDATE = 1;\nconst EDIT_ADD = 2;\nconst EDIT_DELETE = 3;\n\n// Note: This function is *based* on the computation of the Levenshtein\n// \"edit\" distance. The one change is that \"updates\" are treated as two\n// edits - not one. With Array splices, an update is really a delete\n// followed by an add. By retaining this, we optimize for \"keeping\" the\n// maximum array items in the original array. For example:\n//\n//   'xxxx123' -> '123yyyy'\n//\n// With 1-edit updates, the shortest path would be just to update all seven\n// characters. With 2-edit updates, we delete 4, leave 3, and add 4. This\n// leaves the substring '123' intact.\nfunction calcEditDistances(current, currentStart, currentEnd,\n                            old, oldStart, oldEnd) {\n  // \"Deletion\" columns\n  let rowCount = oldEnd - oldStart + 1;\n  let columnCount = currentEnd - currentStart + 1;\n  let distances = new Array(rowCount);\n\n  // \"Addition\" rows. Initialize null column.\n  for (let i = 0; i < rowCount; i++) {\n    distances[i] = new Array(columnCount);\n    distances[i][0] = i;\n  }\n\n  // Initialize null row\n  for (let j = 0; j < columnCount; j++)\n    distances[0][j] = j;\n\n  for (let i = 1; i < rowCount; i++) {\n    for (let j = 1; j < columnCount; j++) {\n      if (equals(current[currentStart + j - 1], old[oldStart + i - 1]))\n        distances[i][j] = distances[i - 1][j - 1];\n      else {\n        let north = distances[i - 1][j] + 1;\n        let west = distances[i][j - 1] + 1;\n        distances[i][j] = north < west ? north : west;\n      }\n    }\n  }\n\n  return distances;\n}\n\n// This starts at the final weight, and walks \"backward\" by finding\n// the minimum previous weight recursively until the origin of the weight\n// matrix.\nfunction spliceOperationsFromEditDistances(distances) {\n  let i = distances.length - 1;\n  let j = distances[0].length - 1;\n  let current = distances[i][j];\n  let edits = [];\n  while (i > 0 || j > 0) {\n    if (i == 0) {\n      edits.push(EDIT_ADD);\n      j--;\n      continue;\n    }\n    if (j == 0) {\n      edits.push(EDIT_DELETE);\n      i--;\n      continue;\n    }\n    let northWest = distances[i - 1][j - 1];\n    let west = distances[i - 1][j];\n    let north = distances[i][j - 1];\n\n    let min;\n    if (west < north)\n      min = west < northWest ? west : northWest;\n    else\n      min = north < northWest ? north : northWest;\n\n    if (min == northWest) {\n      if (northWest == current) {\n        edits.push(EDIT_LEAVE);\n      } else {\n        edits.push(EDIT_UPDATE);\n        current = northWest;\n      }\n      i--;\n      j--;\n    } else if (min == west) {\n      edits.push(EDIT_DELETE);\n      i--;\n      current = west;\n    } else {\n      edits.push(EDIT_ADD);\n      j--;\n      current = north;\n    }\n  }\n\n  edits.reverse();\n  return edits;\n}\n\n/**\n * Splice Projection functions:\n *\n * A splice map is a representation of how a previous array of items\n * was transformed into a new array of items. Conceptually it is a list of\n * tuples of\n *\n *   <index, removed, addedCount>\n *\n * which are kept in ascending index order of. The tuple represents that at\n * the |index|, |removed| sequence of items were removed, and counting forward\n * from |index|, |addedCount| items were added.\n */\n\n/**\n * Lacking individual splice mutation information, the minimal set of\n * splices can be synthesized given the previous state and final state of an\n * array. The basic approach is to calculate the edit distance matrix and\n * choose the shortest path through it.\n *\n * Complexity: O(l * p)\n *   l: The length of the current array\n *   p: The length of the old array\n */\nfunction calcSplices(current, currentStart, currentEnd,\n                      old, oldStart, oldEnd) {\n  let prefixCount = 0;\n  let suffixCount = 0;\n  let splice;\n\n  let minLength = Math.min(currentEnd - currentStart, oldEnd - oldStart);\n  if (currentStart == 0 && oldStart == 0)\n    prefixCount = sharedPrefix(current, old, minLength);\n\n  if (currentEnd == current.length && oldEnd == old.length)\n    suffixCount = sharedSuffix(current, old, minLength - prefixCount);\n\n  currentStart += prefixCount;\n  oldStart += prefixCount;\n  currentEnd -= suffixCount;\n  oldEnd -= suffixCount;\n\n  if (currentEnd - currentStart == 0 && oldEnd - oldStart == 0)\n    return [];\n\n  if (currentStart == currentEnd) {\n    splice = newSplice(currentStart, [], 0);\n    while (oldStart < oldEnd)\n      splice.removed.push(old[oldStart++]);\n\n    return [ splice ];\n  } else if (oldStart == oldEnd)\n    return [ newSplice(currentStart, [], currentEnd - currentStart) ];\n\n  let ops = spliceOperationsFromEditDistances(\n      calcEditDistances(current, currentStart, currentEnd,\n                             old, oldStart, oldEnd));\n\n  splice = undefined;\n  let splices = [];\n  let index = currentStart;\n  let oldIndex = oldStart;\n  for (let i = 0; i < ops.length; i++) {\n    switch(ops[i]) {\n      case EDIT_LEAVE:\n        if (splice) {\n          splices.push(splice);\n          splice = undefined;\n        }\n\n        index++;\n        oldIndex++;\n        break;\n      case EDIT_UPDATE:\n        if (!splice)\n          splice = newSplice(index, [], 0);\n\n        splice.addedCount++;\n        index++;\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n      case EDIT_ADD:\n        if (!splice)\n          splice = newSplice(index, [], 0);\n\n        splice.addedCount++;\n        index++;\n        break;\n      case EDIT_DELETE:\n        if (!splice)\n          splice = newSplice(index, [], 0);\n\n        splice.removed.push(old[oldIndex]);\n        oldIndex++;\n        break;\n    }\n  }\n\n  if (splice) {\n    splices.push(splice);\n  }\n  return splices;\n}\n\nfunction sharedPrefix(current, old, searchLength) {\n  for (let i = 0; i < searchLength; i++)\n    if (!equals(current[i], old[i]))\n      return i;\n  return searchLength;\n}\n\nfunction sharedSuffix(current, old, searchLength) {\n  let index1 = current.length;\n  let index2 = old.length;\n  let count = 0;\n  while (count < searchLength && equals(current[--index1], old[--index2]))\n    count++;\n\n  return count;\n}\n\nfunction equals(currentValue, previousValue) {\n  return currentValue === previousValue;\n}\n\nexport function calculateSplices(current, previous) {\n  return calcSplices(current, 0, current.length, previous, 0,\n                          previous.length);\n}\n\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from './shady-data.js';\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\n\nfunction linkNode(node, container, ref_node) {\n  patchOutsideElementAccessors(node);\n  ref_node = ref_node || null;\n  const nodeData = ensureShadyDataForNode(node);\n  const containerData = ensureShadyDataForNode(container);\n  const ref_nodeData = ref_node ? ensureShadyDataForNode(ref_node) : null;\n  // update ref_node.previousSibling <-> node\n  nodeData.previousSibling = ref_node ? ref_nodeData.previousSibling :\n    container[utils.SHADY_PREFIX + 'lastChild'];\n  let psd = shadyDataForNode(nodeData.previousSibling);\n  if (psd) {\n    psd.nextSibling = node;\n  }\n  // update node <-> ref_node\n  let nsd = shadyDataForNode(nodeData.nextSibling = ref_node);\n  if (nsd) {\n    nsd.previousSibling = node;\n  }\n  // update node <-> container\n  nodeData.parentNode = container;\n  if (ref_node) {\n    if (ref_node === containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  } else {\n    containerData.lastChild = node;\n    if (!containerData.firstChild) {\n      containerData.firstChild = node;\n    }\n  }\n  // remove caching of childNodes\n  containerData.childNodes = null;\n}\n\nexport const recordInsertBefore = (node, container, ref_node) => {\n  patchInsideElementAccessors(container);\n  const containerData = ensureShadyDataForNode(container);\n  if (containerData.firstChild !== undefined) {\n    containerData.childNodes = null;\n  }\n  // handle document fragments\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    let c$ = node[utils.SHADY_PREFIX + 'childNodes'];\n    for (let i=0; i < c$.length; i++) {\n      linkNode(c$[i], container, ref_node);\n    }\n    // cleanup logical dom in doc fragment.\n    const nodeData = ensureShadyDataForNode(node);\n    let resetTo = (nodeData.firstChild !== undefined) ? null : undefined;\n    nodeData.firstChild = nodeData.lastChild = resetTo;\n    nodeData.childNodes = resetTo;\n  } else {\n    linkNode(node, container, ref_node);\n  }\n}\n\nexport const recordRemoveChild = (node, container) => {\n  const nodeData = ensureShadyDataForNode(node);\n  const containerData = ensureShadyDataForNode(container);\n  if (node === containerData.firstChild) {\n    containerData.firstChild = nodeData.nextSibling;\n  }\n  if (node === containerData.lastChild) {\n    containerData.lastChild = nodeData.previousSibling;\n  }\n  let p = nodeData.previousSibling;\n  let n = nodeData.nextSibling;\n  if (p) {\n    ensureShadyDataForNode(p).nextSibling = n;\n  }\n  if (n) {\n    ensureShadyDataForNode(n).previousSibling = p;\n  }\n  // When an element is removed, logical data is no longer tracked.\n  // Explicitly set `undefined` here to indicate this. This is disginguished\n  // from `null` which is set if info is null.\n  nodeData.parentNode = nodeData.previousSibling =\n  nodeData.nextSibling = undefined;\n  if (containerData.childNodes !== undefined) {\n    // remove caching of childNodes\n    containerData.childNodes = null;\n  }\n}\n\n/**\n * @param  {!Node} node\n */\nexport const recordChildNodes = (node) => {\n  const nodeData = ensureShadyDataForNode(node);\n  if (nodeData.firstChild === undefined) {\n    // remove caching of childNodes\n    nodeData.childNodes = null;\n    const first = nodeData.firstChild = node[utils.NATIVE_PREFIX + 'firstChild'] || null;\n    nodeData.lastChild = node[utils.NATIVE_PREFIX + 'lastChild'] || null;\n    patchInsideElementAccessors(node);\n    for (let n = first, previous; n; (n = n[utils.NATIVE_PREFIX + 'nextSibling'])) {\n      const sd = ensureShadyDataForNode(n);\n      sd.parentNode = node;\n      sd.nextSibling = n[utils.NATIVE_PREFIX + 'nextSibling'] || null;\n      sd.previousSibling = previous || null;\n      previous = n;\n      patchOutsideElementAccessors(n);\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\n\nlet scopingShim = null;\n\nexport function getScopingShim() {\n  if (!scopingShim) {\n    scopingShim = window['ShadyCSS'] && window['ShadyCSS']['ScopingShim'];\n  }\n  return scopingShim || null;\n}\n\n/**\n * @param {!Node} node\n * @param {string} attr\n * @param {string} value\n */\nexport function scopeClassAttribute(node, attr, value) {\n  const scopingShim = getScopingShim();\n  if (scopingShim && attr === 'class') {\n    scopingShim['setElementClass'](node, value);\n    return true;\n  }\n  return false;\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n */\nexport function addShadyScoping(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['scopeNode'](node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} currentScopeName\n */\nexport function removeShadyScoping(node, currentScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  scopingShim['unscopeNode'](node, currentScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @param {string} oldScopeName\n */\nexport function replaceShadyScoping(node, newScopeName, oldScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return;\n  }\n  if (oldScopeName) {\n    removeShadyScoping(node, oldScopeName);\n  }\n  addShadyScoping(node, newScopeName);\n}\n\n/**\n * @param {!Node} node\n * @param {string} newScopeName\n * @return {boolean}\n */\nexport function currentScopeIsCorrect(node, newScopeName) {\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return true;\n  }\n  if (node.nodeType === Node.DOCUMENT_FRAGMENT_NODE) {\n    // NOTE: as an optimization, only check that all the top-level children\n    // have the correct scope.\n    let correctScope = true;\n    const childNodes = node[utils.SHADY_PREFIX + 'childNodes'];\n    for (let idx = 0; correctScope && (idx < childNodes.length); idx++) {\n      correctScope = correctScope &&\n        currentScopeIsCorrect(childNodes[idx], newScopeName);\n    }\n    return correctScope;\n  }\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return true;\n  }\n  const currentScope = scopingShim['currentScopeForNode'](node);\n  return currentScope === newScopeName;\n}\n\n/**\n * @param {!Node} node\n * @return {string}\n */\nexport function currentScopeForNode(node) {\n  if (node.nodeType !== Node.ELEMENT_NODE) {\n    return '';\n  }\n  const scopingShim = getScopingShim();\n  if (!scopingShim) {\n    return '';\n  }\n  return scopingShim['currentScopeForNode'](node);\n}\n\n/**\n * Walk over a node's tree and apply visitorFn to each element node\n *\n * @param {Node} node\n * @param {function(!Node):void} visitorFn\n */\nexport function treeVisitor(node, visitorFn) {\n  if (!node) {\n    return;\n  }\n  // this check is necessary if `node` is a Document Fragment\n  if (node.nodeType === Node.ELEMENT_NODE) {\n    visitorFn(node);\n  }\n  const childNodes = node[utils.SHADY_PREFIX + 'childNodes'];\n  for (let idx = 0, n; idx < childNodes.length; idx++) {\n    n = childNodes[idx];\n    if (n.nodeType === Node.ELEMENT_NODE) {\n      treeVisitor(n, visitorFn);\n    }\n  }\n}","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {getScopingShim, removeShadyScoping, replaceShadyScoping,\n  treeVisitor, currentScopeForNode, currentScopeIsCorrect } from '../style-scoping.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from '../shady-data.js';\nimport {recordInsertBefore, recordRemoveChild} from '../link-nodes.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nconst doc = window.document;\n\nconst preferPerformance = utils.settings.preferPerformance;\n\nconst nativeIsConnectedAccessors =\n/** @type {ObjectPropertyDescriptor} */(\n  Object.getOwnPropertyDescriptor(Node.prototype, 'isConnected')\n);\n\nconst nativeIsConnected = nativeIsConnectedAccessors && nativeIsConnectedAccessors.get;\n\nexport function clearNode(node) {\n  let firstChild;\n  while ((firstChild = node[utils.SHADY_PREFIX + 'firstChild'])) {\n    node[utils.SHADY_PREFIX + 'removeChild'](firstChild);\n  }\n}\n\nfunction removeOwnerShadyRoot(node) {\n  // optimization: only reset the tree if node is actually in a root\n  if (hasCachedOwnerRoot(node)) {\n    let c$ = node[utils.SHADY_PREFIX + 'childNodes'];\n    for (let i=0, l=c$.length, n; (i<l) && (n=c$[i]); i++) {\n      removeOwnerShadyRoot(n);\n    }\n  }\n  const nodeData = shadyDataForNode(node);\n  if (nodeData) {\n    nodeData.ownerShadyRoot = undefined;\n  }\n}\n\nfunction hasCachedOwnerRoot(node) {\n  const nodeData = shadyDataForNode(node);\n  return Boolean(nodeData && nodeData.ownerShadyRoot !== undefined);\n}\n\n/**\n * Finds the first flattened node that is composed in the node's parent.\n * If the given node is a slot, then the first flattened node is returned\n * if it exists, otherwise advance to the node's nextSibling.\n * @param {Node} node within which to find first composed node\n * @returns {Node} first composed node\n */\nfunction firstComposedNode(node) {\n  let composed = node;\n  if (node && node.localName === 'slot') {\n    const nodeData = shadyDataForNode(node);\n    const flattened = nodeData && nodeData.flattenedNodes;\n    composed = flattened && flattened.length ? flattened[0] :\n      firstComposedNode(node[utils.SHADY_PREFIX + 'nextSibling']);\n  }\n  return composed;\n}\n\n/**\n * @param {Node} node\n * @param {Node=} addedNode\n * @param {Node=} removedNode\n */\nfunction scheduleObserver(node, addedNode, removedNode) {\n  const nodeData = shadyDataForNode(node);\n  const observer = nodeData && nodeData.observer;\n  if (observer) {\n    if (addedNode) {\n      observer.addedNodes.push(addedNode);\n    }\n    if (removedNode) {\n      observer.removedNodes.push(removedNode);\n    }\n    observer.schedule();\n  }\n}\n\nexport const NodePatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Node} */\n  get parentNode() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.parentNode;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentNode'];\n  },\n\n  /** @this {Node} */\n  get firstChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.firstChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'firstChild'];\n  },\n\n  /** @this {Node} */\n  get lastChild() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.lastChild;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'lastChild'];\n  },\n\n  /** @this {Node} */\n  get nextSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.nextSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'nextSibling'];\n  },\n\n  /** @this {Node} */\n  get previousSibling() {\n    const nodeData = shadyDataForNode(this);\n    const l = nodeData && nodeData.previousSibling;\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'previousSibling'];\n  },\n\n  /** @this {Node} */\n  get childNodes() {\n    let childNodes;\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const nodeData = shadyDataForNode(this);\n      if (!nodeData.childNodes) {\n        nodeData.childNodes = [];\n        for (let n=this[utils.SHADY_PREFIX + 'firstChild']; n; n=n[utils.SHADY_PREFIX + 'nextSibling']) {\n          nodeData.childNodes.push(n);\n        }\n      }\n      childNodes = nodeData.childNodes;\n    } else {\n      childNodes = this[utils.NATIVE_PREFIX + 'childNodes'];\n    }\n    childNodes.item = function(index) {\n      return childNodes[index];\n    }\n    return childNodes;\n  },\n\n  /** @this {Node} */\n  get parentElement() {\n    const nodeData = shadyDataForNode(this);\n    let l = nodeData && nodeData.parentNode;\n    if (l && l.nodeType !== Node.ELEMENT_NODE) {\n      l = null;\n    }\n    return l !== undefined ? l : this[utils.NATIVE_PREFIX + 'parentElement'];\n  },\n\n  /** @this {Node} */\n  get isConnected() {\n    if (nativeIsConnected && nativeIsConnected.call(this)) {\n      return true;\n    }\n    if (this.nodeType == Node.DOCUMENT_FRAGMENT_NODE) {\n      return false;\n    }\n    // Fast path for distributed nodes.\n    const ownerDocument = this.ownerDocument;\n    if (utils.hasDocumentContains) {\n      if (ownerDocument[utils.NATIVE_PREFIX + 'contains'](this)) {\n        return true;\n      }\n    } else if (ownerDocument.documentElement &&\n      ownerDocument.documentElement[utils.NATIVE_PREFIX + 'contains'](this)) {\n      return true;\n    }\n    // Slow path for non-distributed nodes.\n    let node = this;\n    while (node && !(node instanceof Document)) {\n      node = node[utils.SHADY_PREFIX + 'parentNode'] || (utils.isShadyRoot(node) ? /** @type {ShadowRoot} */(node).host : undefined);\n    }\n    return !!(node && node instanceof Document);\n  },\n\n  /** @this {Node} */\n  get textContent() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      let tc = [];\n      for (let i = 0, cn = this[utils.SHADY_PREFIX + 'childNodes'], c; (c = cn[i]); i++) {\n        if (c.nodeType !== Node.COMMENT_NODE) {\n          tc.push(c[utils.SHADY_PREFIX + 'textContent']);\n        }\n      }\n      return tc.join('');\n    } else {\n      return this[utils.NATIVE_PREFIX + 'textContent'];\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {string} value\n   */\n  set textContent(value) {\n    if (typeof value === 'undefined' || value === null) {\n      value = ''\n    }\n    switch (this.nodeType) {\n      case Node.ELEMENT_NODE:\n      case Node.DOCUMENT_FRAGMENT_NODE:\n        if (!utils.isTrackingLogicalChildNodes(this) && utils.settings.hasDescriptors) {\n          // may be removing a nested slot but fast path if we know we are not.\n          const firstChild = this[utils.SHADY_PREFIX + 'firstChild'];\n          if (firstChild != this[utils.SHADY_PREFIX + 'lastChild'] ||\n            (firstChild && firstChild.nodeType != Node.TEXT_NODE)) {\n            clearNode(this);\n          }\n          this[utils.NATIVE_PREFIX + 'textContent'] = value;\n        } else {\n          clearNode(this);\n          // Document fragments must have no childNodes if setting a blank string\n          if (value.length > 0 || this.nodeType === Node.ELEMENT_NODE) {\n            this[utils.SHADY_PREFIX + 'insertBefore'](document.createTextNode(value))\n          }\n        }\n        break;\n      default:\n        // Note, be wary of patching `nodeValue`.\n        this.nodeValue = value;\n        break;\n    }\n  },\n\n  // Patched `insertBefore`. Note that all mutations that add nodes are routed\n  // here. When a <slot> is added or a node is added to a host with a shadowRoot\n  // with a slot, a standard dom `insert` call is aborted and `_asyncRender`\n  // is called on the relevant shadowRoot. In all other cases, a standard dom\n  // `insert` can be made, but the location and ref_node may need to be changed.\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  insertBefore(node, ref_node) {\n    // optimization: assume native insertBefore is ok if the nodes are not in the document.\n    if (this.ownerDocument !== doc && node.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      return node;\n    }\n    if (node === this) {\n      throw Error(`Failed to execute 'appendChild' on 'Node': The new child element contains the parent.`);\n    }\n    if (ref_node) {\n      const refData = shadyDataForNode(ref_node);\n      const p = refData && refData.parentNode;\n      if ((p !== undefined && p !== this) ||\n        (p === undefined && ref_node[utils.NATIVE_PREFIX + 'parentNode'] !== this)) {\n        throw Error(`Failed to execute 'insertBefore' on 'Node': The node ` +\n        `before which the new node is to be inserted is not a child of this node.`);\n      }\n    }\n    if (ref_node === node) {\n      return node;\n    }\n    /** @type {!Array<!HTMLSlotElement>} */\n    const slotsAdded = [];\n    const ownerRoot = ownerShadyRootForNode(this);\n    /** @type {string} */\n    const newScopeName = ownerRoot ? ownerRoot.host.localName : currentScopeForNode(this);\n    /** @type {string} */\n    let oldScopeName;\n    // remove from existing location\n    const parentNode = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (parentNode) {\n      oldScopeName = currentScopeForNode(node);\n      parentNode[utils.SHADY_PREFIX + 'removeChild'](node,\n        Boolean(ownerRoot) || !ownerShadyRootForNode(node));\n    }\n    // add to new parent\n    let allowNativeInsert = true;\n    const needsScoping = (!preferPerformance || node['__noInsertionPoint'] === undefined) &&\n        !currentScopeIsCorrect(node, newScopeName);\n    const needsSlotFinding = ownerRoot && !node['__noInsertionPoint'] &&\n        (!preferPerformance || node.nodeType === Node.DOCUMENT_FRAGMENT_NODE);\n    if (needsSlotFinding || needsScoping) {\n      // NOTE: avoid node.removeChild as this *can* trigger another patched\n      // method (e.g. custom elements) and we want only the shady method to run.\n      // The following table describes what style scoping actions should happen as a result of this insertion.\n      // document -> shadowRoot: replace\n      // shadowRoot -> shadowRoot: replace\n      // shadowRoot -> shadowRoot of same type: do nothing\n      // shadowRoot -> document: allow unscoping\n      // document -> document: do nothing\n      // The \"same type of shadowRoot\" and \"document to document cases rely on `currentScopeIsCorrect` returning true\n      if (needsScoping) {\n        // in a document or disconnected tree, replace scoping if necessary\n        oldScopeName = oldScopeName || currentScopeForNode(node);\n      }\n      treeVisitor(node, (node) => {\n        if (needsSlotFinding && node.localName === 'slot') {\n          slotsAdded.push(/** @type {!HTMLSlotElement} */(node));\n        }\n        if (needsScoping) {\n          replaceShadyScoping(node, newScopeName, oldScopeName);\n        }\n      });\n    }\n    // if a slot is added, must render containing root.\n    if (this.localName === 'slot' || slotsAdded.length) {\n      if (slotsAdded.length) {\n        ownerRoot._addSlots(slotsAdded);\n      }\n      if (ownerRoot) {\n        ownerRoot._asyncRender();\n      }\n    }\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordInsertBefore(node, this, ref_node);\n      // when inserting into a host with a shadowRoot with slot, use\n      // `shadowRoot._asyncRender()` via `attach-shadow` module\n      const parentData = shadyDataForNode(this);\n      if (utils.hasShadowRootWithSlot(this)) {\n        parentData.root._asyncRender();\n        allowNativeInsert = false;\n      // when inserting into a host with shadowRoot with NO slot, do nothing\n      // as the node should not be added to composed dome anywhere.\n      } else if (parentData.root) {\n        allowNativeInsert = false;\n      }\n    }\n    if (allowNativeInsert) {\n      // if adding to a shadyRoot, add to host instead\n      let container = utils.isShadyRoot(this) ?\n        /** @type {ShadowRoot} */(this).host : this;\n      // if ref_node, get the ref_node that's actually in composed dom.\n      if (ref_node) {\n        ref_node = firstComposedNode(ref_node);\n        container[utils.NATIVE_PREFIX + 'insertBefore'](node, ref_node);\n      } else {\n        container[utils.NATIVE_PREFIX + 'appendChild'](node);\n      }\n    // Since ownerDocument is not patched, it can be incorrect after this call\n    // if the node is physically appended via distribution. This can result\n    // in the custom elements polyfill not upgrading the node if it's in an inert doc.\n    // We correct this by calling `adoptNode`.\n    } else if (node.ownerDocument !== this.ownerDocument) {\n      this.ownerDocument.adoptNode(node);\n    }\n    scheduleObserver(this, node);\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   */\n  appendChild(node) {\n    return this[utils.SHADY_PREFIX + 'insertBefore'](node);\n  },\n\n  /**\n   * Patched `removeChild`. Note that all dom \"removals\" are routed here.\n   * Removes the given `node` from the element's `children`.\n   * This method also performs dom composition.\n   * @this {Node}\n   * @param {Node} node\n   * @param {boolean=} skipUnscoping\n   */\n  removeChild(node, skipUnscoping = false) {\n    if (this.ownerDocument !== doc) {\n      return this[utils.NATIVE_PREFIX + 'removeChild'](node);\n    }\n    if (node[utils.SHADY_PREFIX + 'parentNode'] !== this) {\n      throw Error('The node to be removed is not a child of this node: ' +\n        node);\n    }\n    let preventNativeRemove;\n    let ownerRoot = ownerShadyRootForNode(node);\n    const removingInsertionPoint = ownerRoot && ownerRoot._removeContainedSlots(node);\n    const parentData = shadyDataForNode(this);\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      recordRemoveChild(node, this);\n      if (utils.hasShadowRootWithSlot(this)) {\n        parentData.root._asyncRender();\n        preventNativeRemove = true;\n      }\n    }\n    // unscope a node leaving a ShadowRoot if ShadyCSS is present, and this node\n    // is not going to be rescoped in `insertBefore`\n    if (getScopingShim() && !skipUnscoping && ownerRoot) {\n      const oldScopeName = currentScopeForNode(node);\n      treeVisitor(node, (node) => {\n        removeShadyScoping(node, oldScopeName);\n      });\n    }\n    removeOwnerShadyRoot(node);\n    // if removing slot, must render containing root\n    if (ownerRoot) {\n      let changeSlotContent = this && this.localName === 'slot';\n      if (changeSlotContent) {\n        preventNativeRemove = true;\n      }\n      if (removingInsertionPoint || changeSlotContent) {\n        ownerRoot._asyncRender();\n      }\n    }\n    if (!preventNativeRemove) {\n      // if removing from a shadyRoot, remove from host instead\n      let container = utils.isShadyRoot(this) ?\n        /** @type {ShadowRoot} */(this).host :\n        this;\n      // not guaranteed to physically be in container; e.g.\n      // (1) if parent has a shadyRoot, element may or may not at distributed\n      // location (could be undistributed)\n      // (2) if parent is a slot, element may not ben in composed dom\n      if (!(parentData.root || node.localName === 'slot') ||\n        (container === node[utils.NATIVE_PREFIX + 'parentNode'])) {\n        container[utils.NATIVE_PREFIX + 'removeChild'](node);\n      }\n    }\n    scheduleObserver(this, null, node);\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {Node} node\n   * @param {Node=} ref_node\n   */\n  replaceChild(node, ref_node) {\n    this[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n    this[utils.SHADY_PREFIX + 'removeChild'](ref_node);\n    return node;\n  },\n\n  /**\n   * @this {Node}\n   * @param {boolean=} deep\n   */\n  cloneNode(deep) {\n    if (this.localName == 'template') {\n      return this[utils.NATIVE_PREFIX + 'cloneNode'](deep);\n    } else {\n      const n = this[utils.NATIVE_PREFIX + 'cloneNode'](false);\n      // Attribute nodes historically had childNodes, but they have later\n      // been removed from the spec.\n      // Make sure we do not do a deep clone on them for old browsers (IE11)\n      if (deep && n.nodeType !== Node.ATTRIBUTE_NODE) {\n        let c$ = this[utils.SHADY_PREFIX + 'childNodes'];\n        for (let i=0, nc; i < c$.length; i++) {\n          nc = c$[i][utils.SHADY_PREFIX + 'cloneNode'](true);\n          n[utils.SHADY_PREFIX + 'appendChild'](nc);\n        }\n      }\n      return n;\n    }\n  },\n\n  /**\n   * @this {Node}\n   * @param {Object=} options\n   */\n  // TODO(sorvell): implement `options` e.g. `{ composed: boolean }`\n  getRootNode(options) { // eslint-disable-line no-unused-vars\n    if (!this || !this.nodeType) {\n      return;\n    }\n    const nodeData = ensureShadyDataForNode(this);\n    let root = nodeData.ownerShadyRoot;\n    if (root === undefined) {\n      if (utils.isShadyRoot(this)) {\n        root = this;\n        nodeData.ownerShadyRoot = root;\n      } else {\n        let parent = this[utils.SHADY_PREFIX + 'parentNode'];\n        root = parent ? parent[utils.SHADY_PREFIX + 'getRootNode'](options) : this;\n        // memo-ize result for performance but only memo-ize\n        // result if node is in the document. This avoids a problem where a root\n        // can be cached while an element is inside a fragment.\n        // If this happens and we cache the result, the value can become stale\n        // because for perf we avoid processing the subtree of added fragments.\n        if (document.documentElement[utils.NATIVE_PREFIX + 'contains'](this)) {\n          nodeData.ownerShadyRoot = root;\n        }\n      }\n\n    }\n    return root;\n  },\n\n  /** @this {Node} */\n  contains(node) {\n    return utils.contains(this, node);\n  }\n\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\n/**\n * @param {Node} node\n * @param {Function} matcher\n * @param {Function=} halter\n */\nexport function query(node, matcher, halter) {\n  let list = [];\n  queryElements(node[utils.SHADY_PREFIX + 'childNodes'], matcher,\n    halter, list);\n  return list;\n}\n\nfunction queryElements(elements, matcher, halter, list) {\n  for (let i=0, l=elements.length, c; (i<l) && (c=elements[i]); i++) {\n    if (c.nodeType === Node.ELEMENT_NODE &&\n        queryElement(c, matcher, halter, list)) {\n      return true;\n    }\n  }\n}\n\nfunction queryElement(node, matcher, halter, list) {\n  let result = matcher(node);\n  if (result) {\n    list.push(node);\n  }\n  if (halter && halter(result)) {\n    return result;\n  }\n  queryElements(node[utils.SHADY_PREFIX + 'childNodes'], matcher,\n    halter, list);\n}\n\n// Needed on Element, DocumentFragment, Document\nexport const ParentNodePatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Element} */\n  get firstElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.firstChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'firstChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'firstElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get lastElementChild() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.lastChild !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'lastChild'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'lastElementChild'];\n    }\n  },\n\n  /** @this {Element} */\n  get children() {\n    if (!utils.isTrackingLogicalChildNodes(this)) {\n      return this[utils.NATIVE_PREFIX + 'children'];\n    }\n    return utils.createPolyfilledHTMLCollection(Array.prototype.filter.call(\n        this[utils.SHADY_PREFIX + 'childNodes'], function(n) {\n      return (n.nodeType === Node.ELEMENT_NODE);\n    }));\n  },\n\n  /** @this {Element} */\n  get childElementCount() {\n    let children = this[utils.SHADY_PREFIX + 'children'];\n    if(children) {\n      return children.length;\n    }\n    return 0;\n  }\n\n});\n\nexport const QueryPatches = utils.getOwnPropertyDescriptors({\n  // TODO(sorvell): consider doing native QSA and filtering results.\n  /**\n   * @this {Element}\n   * @param  {string} selector\n   */\n  querySelector(selector) {\n    // match selector and halt on first result.\n    let result = query(this, function(n) {\n      return utils.matchesSelector(n, selector);\n    }, function(n) {\n      return Boolean(n);\n    })[0];\n    return result || null;\n  },\n\n  /**\n   * @this {Element}\n   * @param  {string} selector\n   * @param  {boolean} useNative\n   */\n  // TODO(sorvell): `useNative` option relies on native querySelectorAll and\n  // misses distributed nodes, see\n  // https://github.com/webcomponents/shadydom/pull/210#issuecomment-361435503\n  querySelectorAll(selector, useNative) {\n    if (useNative) {\n      const o = Array.prototype.slice.call(this[utils.NATIVE_PREFIX + 'querySelectorAll'](selector));\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      return o.filter(e => e[utils.SHADY_PREFIX + 'getRootNode']() == root);\n    }\n    return query(this, function(n) {\n      return utils.matchesSelector(n, selector);\n    });\n  }\n\n});\n\n// Create a custom `ParentNodeDocumentOrFragment` that optionally does not\n// mixin querySelector/All; this is a performance optimization.\nexport const ParentNodeDocumentOrFragmentPatches = utils.settings.preferPerformance ?\n  Object.assign({}, ParentNodePatches) : ParentNodePatches;\n\nObject.assign(ParentNodePatches, QueryPatches);","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\nimport { query } from './ParentNode.js';\n\nexport const DocumentOrFragmentPatches = utils.getOwnPropertyDescriptors({\n\n  /**\n   * @this {Element}\n   * @param {string} id\n   */\n  getElementById(id) {\n    if (id === '') {\n      return null;\n    }\n    let result = query(this, function(n) {\n      return n.id == id;\n    }, function(n) {\n      return Boolean(n);\n    })[0];\n    return result || null;\n  }\n\n});","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {ownerShadyRootForNode} from '../attach-shadow.js';\n\nfunction getDocumentActiveElement() {\n  if (utils.settings.hasDescriptors) {\n    return document[utils.NATIVE_PREFIX + 'activeElement'];\n  } else {\n    return document.activeElement;\n  }\n}\n\nexport const DocumentOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Document|ShadowRoot} */\n  get activeElement() {\n    let active = getDocumentActiveElement();\n    // In IE11, activeElement might be an empty object if the document is\n    // contained in an iframe.\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/10998788/\n    if (!active || !active.nodeType) {\n      return null;\n    }\n    let isShadyRoot = !!(utils.isShadyRoot(this));\n    if (this !== document) {\n      // If this node isn't a document or shady root, then it doesn't have\n      // an active element.\n      if (!isShadyRoot) {\n        return null;\n      }\n      // If this shady root's host is the active element or the active\n      // element is not a descendant of the host (in the composed tree),\n      // then it doesn't have an active element.\n      if (this.host === active ||\n          !this.host[utils.NATIVE_PREFIX + 'contains'](active)) {\n        return null;\n      }\n    }\n    // This node is either the document or a shady root of which the active\n    // element is a (composed) descendant of its host; iterate upwards to\n    // find the active element's most shallow host within it.\n    let activeRoot = ownerShadyRootForNode(active);\n    while (activeRoot && activeRoot !== this) {\n      active = activeRoot.host;\n      activeRoot = ownerShadyRootForNode(active);\n    }\n    if (this === document) {\n      // This node is the document, so activeRoot should be null.\n      return activeRoot ? null : active;\n    } else {\n      // This node is a non-document shady root, and it should be\n      // activeRoot.\n      return activeRoot === this ? active : null;\n    }\n  }\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {getInnerHTML} from '../innerHTML.js';\nimport {clearNode} from './Node.js';\n\n/** @type {!Document} */\nconst inertDoc = document.implementation.createHTMLDocument('inert');\n\nexport const ElementOrShadowRootPatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Element} */\n  get innerHTML() {\n    if (utils.isTrackingLogicalChildNodes(this)) {\n      const content = this.localName === 'template' ?\n      /** @type {HTMLTemplateElement} */(this).content : this;\n      return getInnerHTML(content, (e) => e[utils.SHADY_PREFIX + 'childNodes']);\n    } else {\n      return this[utils.NATIVE_PREFIX + 'innerHTML'];\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set innerHTML(value) {\n    if (this.localName === 'template') {\n      this[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n    } else {\n      clearNode(this);\n      const containerName = this.localName || 'div';\n      let htmlContainer;\n      if (!this.namespaceURI || this.namespaceURI === inertDoc.namespaceURI) {\n        htmlContainer = inertDoc.createElement(containerName);\n      } else {\n        htmlContainer = inertDoc.createElementNS(this.namespaceURI, containerName);\n      }\n      if (utils.settings.hasDescriptors) {\n        htmlContainer[utils.NATIVE_PREFIX + 'innerHTML'] = value;\n      } else {\n        htmlContainer.innerHTML = value;\n      }\n      let firstChild;\n      while ((firstChild = htmlContainer[utils.SHADY_PREFIX + 'firstChild'])) {\n        this[utils.SHADY_PREFIX + 'insertBefore'](firstChild);\n      }\n    }\n  }\n\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nexport const ShadowRootPatches = utils.getOwnPropertyDescriptors({\n\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  addEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture)\n      }\n    }\n    optionsOrCapture.__shadyTarget = this;\n    this.host[utils.SHADY_PREFIX + 'addEventListener'](type, fn, optionsOrCapture);\n  },\n\n  /**\n   * @this {ShadowRoot}\n   * @param {string} type\n   * @param {Function} fn\n   * @param {Object|boolean=} optionsOrCapture\n   */\n  removeEventListener(type, fn, optionsOrCapture) {\n    if (typeof optionsOrCapture !== 'object') {\n      optionsOrCapture = {\n        capture: Boolean(optionsOrCapture)\n      }\n    }\n    optionsOrCapture.__shadyTarget = this;\n    this.host[utils.SHADY_PREFIX + 'removeEventListener'](type, fn, optionsOrCapture);\n  }\n\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {NodePatches} from './patches/Node.js';\nimport {OutsideDescriptors, InsideDescriptors} from './patch-instances.js';\nimport {ParentNodePatches} from './patches/ParentNode.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {ShadowRootPatches} from './patches/ShadowRoot.js';\n\n/**\n * @param {!Object} proto\n * @param {string=} prefix\n */\nconst patchShadyAccessors = (proto, prefix) => {\n  utils.patchProperties(proto, ShadowRootPatches, prefix);\n  utils.patchProperties(proto, DocumentOrShadowRootPatches, prefix);\n  utils.patchProperties(proto, ElementOrShadowRootPatches, prefix);\n  // We ensure ParentNode accessors since these do not exist in Edge/IE on DocumentFragments.\n  utils.patchProperties(proto, ParentNodePatches, prefix);\n  // Ensure `shadowRoot` has basic descriptors when we cannot rely\n  // on them coming from DocumentFragment.\n  //\n  // Case 1, noPatching: Because we want noPatch ShadyRoots to have native property\n  // names so that they do not have to be wrapped...\n  // When we do *not* patch Node/DocumentFragment.prototype\n  // we must manually install those properties on ShadyRoot's prototype.\n  // Note, it's important to only install these in this mode so as not to stomp\n  // over CustomElements polyfill's patches on Node/DocumentFragment methods.\n  if (utils.settings.noPatch && !prefix) {\n    utils.patchProperties(proto, NodePatches, prefix);\n    utils.patchProperties(proto, DocumentOrFragmentPatches, prefix);\n  // Case 2, bad descriptors: Ensure accessors are on ShadowRoot.\n  // These descriptors are normally used for instance patching but because\n  // ShadyRoot can always be patched, just do it to the prototype.\n  } else if (!utils.settings.hasDescriptors) {\n    utils.patchProperties(proto, OutsideDescriptors);\n    utils.patchProperties(proto, InsideDescriptors);\n  }\n}\n\nexport const patchShadyRoot = (proto) => {\n  proto.__proto__ = DocumentFragment.prototype;\n\n  // patch both prefixed and not, even when noPatch == true.\n  patchShadyAccessors(proto, utils.SHADY_PREFIX);\n  patchShadyAccessors(proto);\n\n  // Ensure native properties are all safely wrapped since ShadowRoot is not an\n  // actual DocumentFragment instance.\n  Object.defineProperties(proto, {\n    nodeType: {\n      value: Node.DOCUMENT_FRAGMENT_NODE,\n      configurable: true\n    },\n    nodeName: {\n      value: '#document-fragment',\n      configurable: true\n    },\n    nodeValue: {\n      value: null,\n      configurable: true\n    }\n  });\n\n  // make undefined\n  [\n    'localName',\n    'namespaceURI',\n    'prefix'\n  ].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      value: undefined,\n      configurable: true\n    });\n  });\n\n  // defer properties to host\n  [\n    'ownerDocument',\n    'baseURI',\n    'isConnected'\n  ].forEach((prop) => {\n    Object.defineProperty(proto, prop, {\n      /** @this {ShadowRoot} */\n      get() {\n        return this.host[prop];\n      },\n      configurable: true\n    });\n  });\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport {calculateSplices} from './array-splice.js';\nimport * as utils from './utils.js';\nimport {enqueue} from './flush.js';\nimport {ensureShadyDataForNode, shadyDataForNode} from './shady-data.js';\nimport {recordChildNodes} from './link-nodes.js';\nimport {patchShadyRoot} from './patch-shadyRoot.js';\n\n// Do not export this object. It must be passed as the first argument to the\n// ShadyRoot constructor in `attachShadow` to prevent the constructor from\n// throwing. This prevents the user from being able to manually construct a\n// ShadyRoot (i.e. `new ShadowRoot()`).\nconst ShadyRootConstructionToken = {};\n\nconst CATCHALL_NAME = '__catchall';\nconst SHADYROOT_NAME = 'ShadyRoot';\n\nconst MODE_CLOSED = 'closed';\n\nlet isRendering = utils.settings['deferConnectionCallbacks'] && document.readyState === 'loading';\nlet rootRendered;\n\nfunction ancestorList(node) {\n  let ancestors = [];\n  do {\n    ancestors.unshift(node);\n  } while ((node = node[utils.SHADY_PREFIX + 'parentNode']));\n  return ancestors;\n}\n\n/**\n * @extends {ShadowRoot}\n */\nclass ShadyRoot {\n\n  constructor(token, host, options) {\n    if (token !== ShadyRootConstructionToken) {\n      throw new TypeError('Illegal constructor');\n    }\n    // NOTE: set a fake local name so this element can be\n    // distinguished from a DocumentFragment when patching.\n    // FF doesn't allow this to be `localName`\n    this._localName = SHADYROOT_NAME;\n    // root <=> host\n    this.host = host;\n    /** @type {!string|undefined} */\n    this.mode = options && options.mode;\n    recordChildNodes(host);\n    const hostData = ensureShadyDataForNode(host);\n    /** @type {!ShadyRoot} */\n    hostData.root = this;\n    hostData.publicRoot = this.mode !== MODE_CLOSED ? this : null;\n    // setup root\n    const rootData = ensureShadyDataForNode(this);\n    rootData.firstChild = rootData.lastChild =\n        rootData.parentNode = rootData.nextSibling =\n        rootData.previousSibling = null;\n    rootData.childNodes = [];\n    // state flags\n    this._renderPending = false;\n    this._hasRendered = false;\n    // marsalled lazily\n    this._slotList = null;\n    /** @type {Object<string, Array<HTMLSlotElement>>} */\n    this._slotMap = null;\n    this._pendingSlots = null;\n    // NOTE: optimization flag, only require an asynchronous render\n    // to record parsed children if flag is not set.\n    if (utils.settings['preferPerformance']) {\n      let n;\n      while ((n = host[utils.NATIVE_PREFIX + 'firstChild'])) {\n        host[utils.NATIVE_PREFIX + 'removeChild'](n);\n      }\n    } else {\n      this._asyncRender();\n    }\n  }\n\n  _asyncRender() {\n    if (!this._renderPending) {\n      this._renderPending = true;\n      enqueue(() => this._render());\n    }\n  }\n\n  // returns the oldest renderPending ancestor root.\n  _getPendingDistributionRoot() {\n    let renderRoot;\n    let root = this;\n    while (root) {\n      if (root._renderPending) {\n        renderRoot = root;\n      }\n      root = root._getDistributionParent();\n    }\n    return renderRoot;\n  }\n\n  // Returns the shadyRoot `this.host` if `this.host`\n  // has children that require distribution.\n  _getDistributionParent() {\n    let root = this.host[utils.SHADY_PREFIX + 'getRootNode']();\n    if (!utils.isShadyRoot(root)) {\n      return;\n    }\n    const nodeData = shadyDataForNode(this.host);\n    if (nodeData && nodeData.__childSlotCount > 0) {\n      return root;\n    }\n  }\n\n  // Renders the top most render pending shadowRoot in the distribution tree.\n  // This is safe because when a distribution parent renders, all children render.\n  _render() {\n    // If this root is not pending, it needs no rendering work. Any pending\n    // parent that needs to render wll cause this root to render.\n    const root = this._renderPending && this._getPendingDistributionRoot();\n    if (root) {\n      root._renderSelf();\n    }\n  }\n\n  _flushInitial() {\n    if (!this._hasRendered && this._renderPending) {\n      this._render();\n    }\n  }\n\n  /** @override */\n  _renderSelf() {\n    // track rendering state.\n    const wasRendering = isRendering;\n    isRendering = true;\n    this._renderPending = false;\n    if (this._slotList) {\n      this._distribute();\n      this._compose();\n    }\n    // NOTE: optimization flag, only process parsed children\n    // if optimization flag is not set.\n    // on initial render remove any undistributed children.\n    if (!utils.settings['preferPerformance'] && !this._hasRendered) {\n      const c$ = this.host[utils.SHADY_PREFIX + 'childNodes'];\n      for (let i=0, l=c$.length; i < l; i++) {\n        const child = c$[i];\n        const data = shadyDataForNode(child);\n        if (child[utils.NATIVE_PREFIX + 'parentNode'] === this.host &&\n            (child.localName === 'slot' || !data.assignedSlot)) {\n          this.host[utils.NATIVE_PREFIX + 'removeChild'](child);\n        }\n      }\n    }\n    this._hasRendered = true;\n    isRendering = wasRendering;\n    if (rootRendered) {\n      rootRendered();\n    }\n  }\n\n  _distribute() {\n    this._validateSlots();\n    // capture # of previously assigned nodes to help determine if dirty.\n    for (let i=0, slot; i < this._slotList.length; i++) {\n      slot = this._slotList[i];\n      this._clearSlotAssignedNodes(slot);\n    }\n    // distribute host children.\n    for (let n=this.host[utils.SHADY_PREFIX + 'firstChild']; n; n=n[utils.SHADY_PREFIX + 'nextSibling']) {\n      this._distributeNodeToSlot(n);\n    }\n    // fallback content, slotchange, and dirty roots\n    for (let i=0; i < this._slotList.length; i++) {\n      const slot = this._slotList[i];\n      const slotData = shadyDataForNode(slot);\n      // distribute fallback content\n      if (!slotData.assignedNodes.length) {\n        for (let n=slot[utils.SHADY_PREFIX + 'firstChild']; n; n=n[utils.SHADY_PREFIX + 'nextSibling']) {\n          this._distributeNodeToSlot(n, slot);\n        }\n      }\n      const slotParentData = shadyDataForNode(slot[utils.SHADY_PREFIX + 'parentNode']);\n      const slotParentRoot = slotParentData && slotParentData.root;\n      if (slotParentRoot && (slotParentRoot._hasInsertionPoint() || slotParentRoot._renderPending)) {\n        slotParentRoot._renderSelf();\n      }\n      this._addAssignedToFlattenedNodes(slotData.flattenedNodes,\n        slotData.assignedNodes);\n      let prevAssignedNodes = slotData._previouslyAssignedNodes;\n      if (prevAssignedNodes) {\n        for (let i=0; i < prevAssignedNodes.length; i++) {\n          shadyDataForNode(prevAssignedNodes[i])._prevAssignedSlot = null;\n        }\n        slotData._previouslyAssignedNodes = null;\n        // dirty if previously less assigned nodes than previously assigned.\n        if (prevAssignedNodes.length > slotData.assignedNodes.length) {\n          slotData.dirty = true;\n        }\n      }\n      /* Note: A slot is marked dirty whenever a node is newly assigned to it\n      or a node is assigned to a different slot (done in `_distributeNodeToSlot`)\n      or if the number of nodes assigned to the slot has decreased (done above);\n      */\n      if (slotData.dirty) {\n        slotData.dirty = false;\n        this._fireSlotChange(slot);\n      }\n    }\n  }\n\n  /**\n   * Distributes given `node` to the appropriate slot based on its `slot`\n   * attribute. If `forcedSlot` is given, then the node is distributed to the\n   * `forcedSlot`.\n   * Note: slot to which the node is assigned will be marked dirty for firing\n   * `slotchange`.\n   * @param {Node} node\n   * @param {Node=} forcedSlot\n   *\n   */\n  _distributeNodeToSlot(node, forcedSlot) {\n    const nodeData = ensureShadyDataForNode(node);\n    let oldSlot = nodeData._prevAssignedSlot;\n    nodeData._prevAssignedSlot = null;\n    let slot = forcedSlot;\n    if (!slot) {\n      let name = node[utils.SHADY_PREFIX + 'slot'] || CATCHALL_NAME;\n      const list = this._slotMap[name];\n      slot = list && list[0];\n    }\n    if (slot) {\n      const slotData = ensureShadyDataForNode(slot);\n      slotData.assignedNodes.push(node);\n      nodeData.assignedSlot = slot;\n    } else {\n      nodeData.assignedSlot = undefined;\n    }\n    if (oldSlot !== nodeData.assignedSlot) {\n      if (nodeData.assignedSlot) {\n        ensureShadyDataForNode(nodeData.assignedSlot).dirty = true;\n      }\n    }\n  }\n\n  /**\n   * Clears the assignedNodes tracking data for a given `slot`. Note, the current\n   * assigned node data is tracked (via _previouslyAssignedNodes and\n   * _prevAssignedSlot) to see if `slotchange` should fire. This data may be out\n   *  of date at this time because the assigned nodes may have already been\n   * distributed to another root. This is ok since this data is only used to\n   * track changes.\n   * @param {HTMLSlotElement} slot\n   */\n  _clearSlotAssignedNodes(slot) {\n    const slotData = shadyDataForNode(slot);\n    let n$ = slotData.assignedNodes;\n    slotData.assignedNodes = [];\n    slotData.flattenedNodes = [];\n    slotData._previouslyAssignedNodes = n$;\n    if (n$) {\n      for (let i=0; i < n$.length; i++) {\n        let n = shadyDataForNode(n$[i]);\n        n._prevAssignedSlot = n.assignedSlot;\n        // only clear if it was previously set to this slot;\n        // this helps ensure that if the node has otherwise been distributed\n        // ignore it.\n        if (n.assignedSlot === slot) {\n          n.assignedSlot = null;\n        }\n      }\n    }\n  }\n\n  _addAssignedToFlattenedNodes(flattened, assigned) {\n    for (let i=0, n; (i<assigned.length) && (n=assigned[i]); i++) {\n      if (n.localName == 'slot') {\n        const nestedAssigned = shadyDataForNode(n).assignedNodes;\n        if (nestedAssigned && nestedAssigned.length) {\n          this._addAssignedToFlattenedNodes(flattened, nestedAssigned);\n        }\n      } else {\n        flattened.push(assigned[i]);\n      }\n    }\n  }\n\n  _fireSlotChange(slot) {\n    // NOTE: cannot bubble correctly here so not setting bubbles: true\n    // Safari tech preview does not bubble but chrome does\n    // Spec says it bubbles (https://dom.spec.whatwg.org/#mutation-observers)\n    slot[utils.NATIVE_PREFIX + 'dispatchEvent'](new Event('slotchange'));\n    const slotData = shadyDataForNode(slot);\n    if (slotData.assignedSlot) {\n      this._fireSlotChange(slotData.assignedSlot);\n    }\n  }\n\n  // Reify dom such that it is at its correct rendering position\n  // based on logical distribution.\n  // NOTE: here we only compose parents of <slot> elements and not the\n  // shadowRoot into the host. The latter is performend via a fast path\n  // in the `logical-mutation`.insertBefore.\n  _compose() {\n    const slots = this._slotList;\n    let composeList = [];\n    for (let i=0; i < slots.length; i++) {\n      const parent = slots[i][utils.SHADY_PREFIX + 'parentNode'];\n      /* compose node only if:\n        (1) parent does not have a shadowRoot since shadowRoot has already\n        composed into the host\n        (2) we're not already composing it\n        [consider (n^2) but rare better than Set]\n      */\n      const parentData = shadyDataForNode(parent);\n      if (!(parentData && parentData.root) &&\n        composeList.indexOf(parent) < 0) {\n        composeList.push(parent);\n      }\n    }\n    for (let i=0; i < composeList.length; i++) {\n      const node = composeList[i];\n      const targetNode = node === this ? this.host : node;\n      this._updateChildNodes(targetNode, this._composeNode(node));\n    }\n  }\n\n  // Returns the list of nodes which should be rendered inside `node`.\n  _composeNode(node) {\n    let children = [];\n    let c$ = node[utils.SHADY_PREFIX + 'childNodes'];\n    for (let i = 0; i < c$.length; i++) {\n      let child = c$[i];\n      // Note: if we see a slot here, the nodes are guaranteed to need to be\n      // composed here. This is because if there is redistribution, it has\n      // already been handled by this point.\n      if (this._isInsertionPoint(child)) {\n        let flattenedNodes = shadyDataForNode(child).flattenedNodes;\n        for (let j = 0; j < flattenedNodes.length; j++) {\n          let distributedNode = flattenedNodes[j];\n            children.push(distributedNode);\n        }\n      } else {\n        children.push(child);\n      }\n    }\n    return children;\n  }\n\n  _isInsertionPoint(node) {\n      return node.localName == 'slot';\n    }\n\n  // Ensures that the rendered node list inside `container` is `children`.\n  _updateChildNodes(container, children) {\n    let composed = Array.prototype.slice.call(container[utils.NATIVE_PREFIX + 'childNodes']);\n    let splices = calculateSplices(children, composed);\n    // process removals\n    for (let i=0, d=0, s; (i<splices.length) && (s=splices[i]); i++) {\n      for (let j=0, n; (j < s.removed.length) && (n=s.removed[j]); j++) {\n        // check if the node is still where we expect it is before trying\n        // to remove it; this can happen if we move a node and\n        // then schedule its previous host for distribution resulting in\n        // the node being removed here.\n        if (n[utils.NATIVE_PREFIX + 'parentNode'] === container) {\n          container[utils.NATIVE_PREFIX + 'removeChild'](n);\n        }\n        // TODO(sorvell): avoid the need for splicing here.\n        composed.splice(s.index + d, 1);\n      }\n      d -= s.addedCount;\n    }\n    // process adds\n    for (let i=0, s, next; (i<splices.length) && (s=splices[i]); i++) { //eslint-disable-line no-redeclare\n      next = composed[s.index];\n      for (let j=s.index, n; j < s.index + s.addedCount; j++) {\n        n = children[j];\n        container[utils.NATIVE_PREFIX + 'insertBefore'](n, next);\n        composed.splice(j, 0, n);\n      }\n    }\n  }\n\n  _ensureSlotData() {\n    this._pendingSlots = this._pendingSlots || [];\n    this._slotList = this._slotList || [];\n    this._slotMap = this._slotMap || {};\n  }\n\n  _addSlots(slots) {\n    this._ensureSlotData();\n    this._pendingSlots.push(...slots);\n  }\n\n  _validateSlots() {\n    if (this._pendingSlots && this._pendingSlots.length) {\n      this._mapSlots(this._pendingSlots);\n      this._pendingSlots = [];\n    }\n  }\n\n  /**\n   * Adds the given slots. Slots are maintained in an dom-ordered list.\n   * In addition a map of name to slot is updated.\n   */\n  _mapSlots(slots) {\n    let slotNamesToSort;\n    for (let i=0; i < slots.length; i++) {\n      const slot = slots[i];\n      // ensure insertionPoints's and their parents have logical dom info.\n      // save logical tree info\n      // a. for shadyRoot\n      // b. for insertion points (fallback)\n      // c. for parents of insertion points\n      recordChildNodes(slot);\n      const slotParent = slot[utils.SHADY_PREFIX + 'parentNode'];\n      recordChildNodes(slotParent);\n      const slotParentData = shadyDataForNode(slotParent);\n      slotParentData.__childSlotCount = (slotParentData.__childSlotCount || 0) + 1;\n      let name = this._nameForSlot(slot);\n      if (this._slotMap[name]) {\n        slotNamesToSort = slotNamesToSort || {};\n        slotNamesToSort[name] = true;\n        this._slotMap[name].push(slot);\n      } else {\n        this._slotMap[name] = [slot];\n      }\n      this._slotList.push(slot);\n    }\n    if (slotNamesToSort) {\n      for (let n in slotNamesToSort) {\n        this._slotMap[n] = this._sortSlots(this._slotMap[n]);\n      }\n    }\n  }\n\n  _nameForSlot(slot) {\n    const name = slot['name'] || slot.getAttribute('name') || CATCHALL_NAME;\n    slot.__slotName = name;\n    return name;\n  }\n\n  /**\n   * Slots are kept in an ordered list. Slots with the same name\n   * are sorted here by tree order.\n   */\n  _sortSlots(slots) {\n    // NOTE: Cannot use `compareDocumentPosition` because it's not polyfilled,\n    // but the code here could be used to polyfill the preceeding/following info\n    // in `compareDocumentPosition`.\n    return slots.sort((a, b) => {\n      let listA = ancestorList(a);\n      let listB = ancestorList(b);\n      for (var i=0; i < listA.length; i++) {\n        let nA = listA[i];\n        let nB = listB[i];\n        if (nA !== nB) {\n          let c$ = Array.from(nA[utils.SHADY_PREFIX + 'parentNode'][utils.SHADY_PREFIX + 'childNodes']);\n          return c$.indexOf(nA) - c$.indexOf(nB);\n        }\n      }\n    });\n  }\n\n  /**\n   * Removes from tracked slot data any slots contained within `container` and\n   * then updates the tracked data (_slotList and _slotMap).\n   * Any removed slots also have their `assignedNodes` removed from comopsed dom.\n   */\n  _removeContainedSlots(container) {\n    if (!this._slotList) {\n      return;\n    }\n    this._validateSlots();\n    let didRemove;\n    const map = this._slotMap;\n    for (let n in map) {\n      const slots = map[n];\n      for (let i=0; i < slots.length; i++) {\n        const slot = slots[i];\n        if (utils.contains(container, slot)) {\n          slots.splice(i, 1);\n          const x = this._slotList.indexOf(slot);\n          if (x >= 0) {\n            this._slotList.splice(x, 1);\n            const slotParentData = shadyDataForNode(slot[utils.SHADY_PREFIX + 'parentNode']);\n            if (slotParentData && slotParentData.__childSlotCount) {\n              slotParentData.__childSlotCount--;\n            }\n          }\n          i--;\n          this._removeFlattenedNodes(slot);\n          didRemove = true;\n        }\n      }\n    }\n    return didRemove;\n  }\n\n  _updateSlotName(slot) {\n    if (!this._slotList) {\n      return;\n    }\n    // make sure slotMap is initialized with this slot\n    this._validateSlots();\n    const oldName = slot.__slotName;\n    const name = this._nameForSlot(slot);\n    if (name === oldName) {\n      return;\n    }\n    // remove from existing tracking\n    let slots = this._slotMap[oldName];\n    const i = slots.indexOf(slot);\n    if (i >= 0) {\n      slots.splice(i, 1);\n    }\n    // add to new location and sort if nedessary\n    let list = this._slotMap[name] || (this._slotMap[name] = []);\n    list.push(slot);\n    if (list.length > 1) {\n      this._slotMap[name] = this._sortSlots(list);\n    }\n  }\n\n  _removeFlattenedNodes(slot) {\n    const data = shadyDataForNode(slot);\n    let n$ = data.flattenedNodes;\n    if (n$) {\n      for (let i=0; i<n$.length; i++) {\n        let node = n$[i];\n        let parent = node[utils.NATIVE_PREFIX + 'parentNode'];\n        if (parent) {\n          parent[utils.NATIVE_PREFIX + 'removeChild'](node);\n        }\n      }\n    }\n    data.flattenedNodes = [];\n    data.assignedNodes = [];\n  }\n\n  _hasInsertionPoint() {\n    this._validateSlots();\n    return Boolean(this._slotList && this._slotList.length);\n  }\n}\n\npatchShadyRoot(ShadyRoot.prototype);\nexport {ShadyRoot};\n\n/**\n  Implements a pared down version of ShadowDOM's scoping, which is easy to\n  polyfill across browsers.\n*/\nexport const attachShadow = (host, options) => {\n  if (!host) {\n    throw new Error('Must provide a host.');\n  }\n  if (!options) {\n    throw new Error('Not enough arguments.');\n  }\n  return new ShadyRoot(ShadyRootConstructionToken, host, options);\n}\n\n// Mitigate connect/disconnect spam by wrapping custom element classes.\nif (window['customElements'] && utils.settings.inUse && !utils.settings['preferPerformance']) {\n\n  // process connect/disconnect after roots have rendered to avoid\n  // issues with reaction stack.\n  let connectMap = new Map();\n  rootRendered = function() {\n    // allow elements to connect\n    // save map state (without needing polyfills on IE11)\n    const r = [];\n    connectMap.forEach((v, k) => {\n      r.push([k, v]);\n    });\n    connectMap.clear();\n    for (let i=0; i < r.length; i++) {\n      const e = r[i][0], value = r[i][1];\n      if (value) {\n        e.__shadydom_connectedCallback();\n      } else {\n        e.__shadydom_disconnectedCallback();\n      }\n    }\n  }\n\n  // Document is in loading state and flag is set (deferConnectionCallbacks)\n  // so process connection stack when `readystatechange` fires.\n  if (isRendering) {\n    document.addEventListener('readystatechange', () => {\n      isRendering = false;\n      rootRendered();\n    }, {once: true});\n  }\n\n  /*\n   * (1) elements can only be connected/disconnected if they are in the expected\n   * state.\n   * (2) never run connect/disconnect during rendering to avoid reaction stack issues.\n   */\n  const ManageConnect = (base, connected, disconnected) => {\n    let counter = 0;\n    const connectFlag = `__isConnected${counter++}`;\n    if (connected || disconnected) {\n\n      /** @this {!HTMLElement} */\n      base.prototype.connectedCallback = base.prototype.__shadydom_connectedCallback = function() {\n        // if rendering defer connected\n        // otherwise connect only if we haven't already\n        if (isRendering) {\n          connectMap.set(this, true);\n        } else if (!this[connectFlag]) {\n          this[connectFlag] = true;\n          if (connected) {\n            connected.call(this);\n          }\n        }\n      }\n\n      /** @this {!HTMLElement} */\n      base.prototype.disconnectedCallback = base.prototype.__shadydom_disconnectedCallback = function() {\n        // if rendering, cancel a pending connection and queue disconnect,\n        // otherwise disconnect only if a connection has been allowed\n        if (isRendering) {\n          // This is necessary only because calling removeChild\n          // on a node that requires distribution leaves it in the DOM tree\n          // until distribution.\n          // NOTE: remember this is checking the patched isConnected to determine\n          // if the node is in the logical tree.\n          if (!this.isConnected) {\n            connectMap.set(this, false);\n          }\n        } else if (this[connectFlag]) {\n          this[connectFlag] = false;\n          if (disconnected) {\n            disconnected.call(this);\n          }\n        }\n      }\n    }\n\n    return base;\n  }\n\n  const define = window['customElements']['define'];\n  // NOTE: Instead of patching customElements.define,\n  // re-define on the CustomElementRegistry.prototype.define\n  // for Safari 10 compatibility (it's flakey otherwise).\n  Object.defineProperty(window['CustomElementRegistry'].prototype, 'define', {\n    value: function(name, constructor) {\n      const connected = constructor.prototype.connectedCallback;\n      const disconnected = constructor.prototype.disconnectedCallback;\n      define.call(window['customElements'], name,\n          ManageConnect(constructor, connected, disconnected));\n      // unpatch connected/disconnected on class; custom elements tears this off\n      // so the patch is maintained, but if the user calls these methods for\n      // e.g. testing, they will be as expected.\n      constructor.prototype.connectedCallback = connected;\n      constructor.prototype.disconnectedCallback = disconnected;\n    }\n  });\n\n}\n\n/** @return {!ShadyRoot|undefined} */\nexport const ownerShadyRootForNode = (node) => {\n  let root = node[utils.SHADY_PREFIX + 'getRootNode']();\n  if (utils.isShadyRoot(root)) {\n    return root;\n  }\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {eventPropertyNames} from './patch-events.js';\n\n/** @implements {IWrapper} */\nclass Wrapper {\n\n  /** @param {!Node} node */\n  constructor(node) {\n    this.node = node;\n  }\n\n  // node\n  addEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'addEventListener'](name, fn, options);\n  }\n\n  removeEventListener(name, fn, options) {\n    return this.node[utils.SHADY_PREFIX + 'removeEventListener'](name, fn, options);\n  }\n\n  appendChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'appendChild'](node);\n  }\n\n  insertBefore(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'insertBefore'](node, ref_node);\n  }\n\n  removeChild(node) {\n    return this.node[utils.SHADY_PREFIX + 'removeChild'](node);\n  }\n\n  replaceChild(node, ref_node) {\n    return this.node[utils.SHADY_PREFIX + 'replaceChild'](node, ref_node);\n  }\n\n  cloneNode(deep) {\n    return this.node[utils.SHADY_PREFIX + 'cloneNode'](deep);\n  }\n\n  getRootNode(options) {\n    return this.node[utils.SHADY_PREFIX + 'getRootNode'](options);\n  }\n\n  contains(node) {\n    return this.node[utils.SHADY_PREFIX + 'contains'](node);\n  }\n\n  dispatchEvent(event) {\n    return this.node[utils.SHADY_PREFIX + 'dispatchEvent'](event);\n  }\n\n  // element\n  setAttribute(name, value) {\n    this.node[utils.SHADY_PREFIX + 'setAttribute'](name, value);\n  }\n\n  // NOTE: not needed, just here for balance\n  getAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'getAttribute'](name);\n  }\n\n  // NOTE: not needed, just here for balance\n  hasAttribute(name) {\n    return this.node[utils.NATIVE_PREFIX + 'hasAttribute'](name);\n  }\n\n  removeAttribute(name) {\n    this.node[utils.SHADY_PREFIX + 'removeAttribute'](name);\n  }\n\n  attachShadow(options) {\n    return this.node[utils.SHADY_PREFIX + 'attachShadow'](options);\n  }\n\n  /** @return {!Node|undefined} */\n  get activeElement() {\n    if (utils.isShadyRoot(this.node) || this.node.nodeType === Node.DOCUMENT_NODE) {\n      const e = this.node[utils.SHADY_PREFIX + 'activeElement'];\n      return e;\n    }\n  }\n\n  /**\n   * Installed for compatibility with browsers (older Chrome/Safari) that do\n   * not have a configurable `activeElement` accessor. Enables noPatch and\n   * patch mode both to consistently use ShadyDOM.wrap(document)._activeElement.\n   * @override\n   * @return {!Node|undefined}\n   */\n  get _activeElement() {\n    return this.activeElement;\n  }\n\n  // NOTE: not needed, just here for balance\n  /** @override */\n  focus() {\n    this.node[utils.NATIVE_PREFIX + 'focus']();\n  }\n\n  blur() {\n    this.node[utils.SHADY_PREFIX + 'blur']();\n  }\n\n  // document\n  importNode(node, deep) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'importNode'](node, deep);\n    }\n  }\n\n  getElementById(id) {\n    if (this.node.nodeType === Node.DOCUMENT_NODE) {\n      return this.node[utils.SHADY_PREFIX + 'getElementById'](id);\n    }\n  }\n\n  // query\n  querySelector(selector) {\n    return this.node[utils.SHADY_PREFIX + 'querySelector'](selector);\n  }\n\n  querySelectorAll(selector, useNative) {\n    return this.node[utils.SHADY_PREFIX + 'querySelectorAll'](selector, useNative);\n  }\n\n  // slot\n  assignedNodes(options) {\n    if (this.node.localName === 'slot') {\n      return this.node[utils.SHADY_PREFIX + 'assignedNodes'](options);\n    }\n  }\n\n  get host() {\n    if (utils.isShadyRoot(this.node)) {\n      return /** @type {!ShadowRoot} */(this.node).host;\n    }\n  }\n\n  get parentNode() {\n    return this.node[utils.SHADY_PREFIX + 'parentNode'];\n  }\n\n  get firstChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstChild'];\n  }\n\n  get lastChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastChild'];\n  }\n\n  get nextSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextSibling'];\n  }\n\n  get previousSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousSibling'];\n  }\n\n  get childNodes() {\n    return this.node[utils.SHADY_PREFIX + 'childNodes'];\n  }\n\n  get parentElement() {\n    return this.node[utils.SHADY_PREFIX + 'parentElement'];\n  }\n\n  get firstElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'firstElementChild'];\n  }\n\n  get lastElementChild() {\n    return this.node[utils.SHADY_PREFIX + 'lastElementChild'];\n  }\n\n  get nextElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'nextElementSibling'];\n  }\n\n  get previousElementSibling() {\n    return this.node[utils.SHADY_PREFIX + 'previousElementSibling'];\n  }\n\n  get children() {\n    return this.node[utils.SHADY_PREFIX + 'children'];\n  }\n\n  get childElementCount() {\n    return this.node[utils.SHADY_PREFIX + 'childElementCount'];\n  }\n\n  get shadowRoot() {\n    return this.node[utils.SHADY_PREFIX + 'shadowRoot'];\n  }\n\n  get assignedSlot() {\n    return this.node[utils.SHADY_PREFIX + 'assignedSlot'];\n  }\n\n  get isConnected() {\n    return this.node[utils.SHADY_PREFIX + 'isConnected'];\n  }\n\n  get innerHTML() {\n    return this.node[utils.SHADY_PREFIX + 'innerHTML'];\n  }\n\n  set innerHTML(value) {\n    this.node[utils.SHADY_PREFIX + 'innerHTML'] = value;\n  }\n\n  get textContent() {\n    return this.node[utils.SHADY_PREFIX + 'textContent'];\n  }\n\n  set textContent(value) {\n    this.node[utils.SHADY_PREFIX + 'textContent'] = value;\n  }\n\n  get slot() {\n    return this.node[utils.SHADY_PREFIX + 'slot'];\n  }\n\n  set slot(value) {\n    this.node[utils.SHADY_PREFIX + 'slot'] = value;\n  }\n\n}\n\neventPropertyNames.forEach(name => {\n  Object.defineProperty(Wrapper.prototype, name, {\n    /** @this {Wrapper} */\n    get() {\n      return this.node[utils.SHADY_PREFIX + name];\n    },\n    /** @this {Wrapper} */\n    set(value) {\n      this.node[utils.SHADY_PREFIX + name] = value;\n    },\n    configurable: true\n  });\n\n});\n\nexport {Wrapper};\n\nconst wrapperMap = new WeakMap();\n\nexport function wrap(obj) {\n  if (utils.isShadyRoot(obj) || obj instanceof Wrapper) {\n    return obj;\n  }\n  let wrapper = wrapperMap.get(obj)\n  if (!wrapper) {\n    wrapper = new Wrapper(obj);\n    wrapperMap.set(obj, wrapper);\n  }\n  return wrapper;\n}\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {flush} from '../flush.js';\nimport {addEventListener, removeEventListener} from '../patch-events.js';\n\nexport const EventTargetPatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Node} */\n  dispatchEvent(event) {\n    flush();\n    return this[utils.NATIVE_PREFIX + 'dispatchEvent'](event);\n  },\n\n  addEventListener,\n\n  removeEventListener\n\n});","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const SlotablePatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Node} */\n  get assignedSlot() {\n    // Force any parent's shadowRoot to flush so that distribution occurs\n    // and this node has an assignedSlot.\n    const parent = this[utils.SHADY_PREFIX + 'parentNode'];\n    const ownerRoot = parent && parent[utils.SHADY_PREFIX + 'shadowRoot'];\n    if (ownerRoot) {\n      ownerRoot._render();\n    }\n    const nodeData = shadyDataForNode(this);\n    return nodeData && nodeData.assignedSlot || null;\n  }\n\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {scopeClassAttribute} from '../style-scoping.js';\nimport {shadyDataForNode} from '../shady-data.js';\nimport {attachShadow, ownerShadyRootForNode} from '../attach-shadow.js';\n\nconst doc = window.document;\n\n/**\n * Should be called whenever an attribute changes. If the `slot` attribute\n * changes, provokes rendering if necessary. If a `<slot>` element's `name`\n * attribute changes, updates the root's slot map and renders.\n * @param {Node} node\n * @param {string} name\n */\nfunction distributeAttributeChange(node, name) {\n  if (name === 'slot') {\n    const parent = node[utils.SHADY_PREFIX + 'parentNode'];\n    if (utils.hasShadowRootWithSlot(parent)) {\n      shadyDataForNode(parent).root._asyncRender();\n    }\n  } else if (node.localName === 'slot' && name === 'name') {\n    let root = ownerShadyRootForNode(node);\n    if (root) {\n      root._updateSlotName(node);\n      root._asyncRender();\n    }\n  }\n}\n\nexport const ElementPatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {Element} */\n  get previousElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.previousSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'previousSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'previousSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'previousElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get nextElementSibling() {\n    const nodeData = shadyDataForNode(this);\n    if (nodeData && nodeData.nextSibling !== undefined) {\n      let n = this[utils.SHADY_PREFIX + 'nextSibling'];\n      while (n && n.nodeType !== Node.ELEMENT_NODE) {\n        n = n[utils.SHADY_PREFIX + 'nextSibling'];\n      }\n      return n;\n    } else {\n      return this[utils.NATIVE_PREFIX + 'nextElementSibling'];\n    }\n  },\n\n  /** @this {Element} */\n  get slot() {\n    return this.getAttribute('slot');\n  },\n\n  /** @this {Element} */\n  set slot(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('slot', value);\n  },\n\n  // Note: Can be patched on element prototype on all browsers.\n  // Must be patched on instance on browsers that support native Shadow DOM\n  // but do not have builtin accessors (old Chrome).\n  /** @this {Element} */\n  get shadowRoot() {\n    const nodeData = shadyDataForNode(this);\n    return nodeData && nodeData.publicRoot || null;\n  },\n\n  /** @this {Element} */\n  get className() {\n    return this.getAttribute('class') || '';\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} value\n   */\n  set className(value) {\n    this[utils.SHADY_PREFIX + 'setAttribute']('class', value);\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   * @param {string} value\n   */\n  setAttribute(attr, value) {\n    if (this.ownerDocument !== doc) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n    } else if (!scopeClassAttribute(this, attr, value)) {\n      this[utils.NATIVE_PREFIX + 'setAttribute'](attr, value);\n      distributeAttributeChange(this, attr);\n    }\n  },\n\n  /**\n   * @this {Element}\n   * @param {string} attr\n   */\n  removeAttribute(attr) {\n    this[utils.NATIVE_PREFIX + 'removeAttribute'](attr);\n    distributeAttributeChange(this, attr);\n  },\n\n  /**\n   * @this {Element}\n   * @param {!{mode: string}} options\n   */\n  attachShadow(options) {\n    return attachShadow(this, options);\n  }\n\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {eventPropertyNames} from '../patch-events.js';\nimport {shadyDataForNode, ensureShadyDataForNode} from '../shady-data.js';\n\nexport const HTMLElementPatches = utils.getOwnPropertyDescriptors({\n\n  /** @this {HTMLElement} */\n  blur() {\n    const nodeData = shadyDataForNode(this);\n    let root = nodeData && nodeData.root;\n    let shadowActive = root && root.activeElement;\n    if (shadowActive) {\n      shadowActive[utils.SHADY_PREFIX + 'blur']();\n    } else {\n      this[utils.NATIVE_PREFIX + 'blur']();\n    }\n  }\n\n});\n\neventPropertyNames.forEach(property => {\n  HTMLElementPatches[property] = {\n    /** @this {HTMLElement} */\n    set: function(fn) {\n      const shadyData = ensureShadyDataForNode(this);\n      const eventName = property.substring(2);\n      shadyData.__onCallbackListeners[property] && this.removeEventListener(eventName, shadyData.__onCallbackListeners[property]);\n      this[utils.SHADY_PREFIX + 'addEventListener'](eventName, fn);\n      shadyData.__onCallbackListeners[property] = fn;\n    },\n    /** @this {HTMLElement} */\n    get() {\n      const shadyData = shadyDataForNode(this);\n      return shadyData && shadyData.__onCallbackListeners[property];\n    },\n    configurable: true\n  };\n});\n\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\nimport {shadyDataForNode} from '../shady-data.js';\n\nexport const SlotPatches = utils.getOwnPropertyDescriptors({\n\n  /**\n   * @this {HTMLSlotElement}\n   * @param {Object=} options\n   */\n  assignedNodes(options) {\n    if (this.localName === 'slot') {\n      // Force any containing shadowRoot to flush so that distribution occurs\n      // and this node has assignedNodes.\n      const root = this[utils.SHADY_PREFIX + 'getRootNode']();\n      if (root && utils.isShadyRoot(root)) {\n        root._render();\n      }\n      const nodeData = shadyDataForNode(this);\n      return nodeData ?\n        ((options && options.flatten ? nodeData.flattenedNodes :\n          nodeData.assignedNodes) || []) :\n        [];\n    }\n  }\n\n});\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from '../utils.js';\n\nconst doc = window.document;\n\nexport const DocumentPatches = utils.getOwnPropertyDescriptors({\n\n  // note: Though not technically correct, we fast path `importNode`\n  // when called on a node not owned by the main document.\n  // This allows, for example, elements that cannot\n  // contain custom elements and are therefore not likely to contain shadowRoots\n  // to cloned natively. This is a fairly significant performance win.\n  /**\n   * @this {Document}\n   * @param {Node} node\n   * @param {boolean} deep\n   */\n  importNode(node, deep) {\n    // A template element normally has no children with shadowRoots, so make\n    // sure we always make a deep copy to correctly construct the template.content\n    if (node.ownerDocument !== doc || node.localName === 'template') {\n      return this[utils.NATIVE_PREFIX + 'importNode'](node, deep);\n    }\n    let n = this[utils.NATIVE_PREFIX + 'importNode'](node, false);\n    if (deep) {\n      let c$ = node[utils.SHADY_PREFIX + 'childNodes'];\n      for (let i=0, nc; i < c$.length; i++) {\n        nc = this[utils.SHADY_PREFIX + 'importNode'](c$[i], true);\n        n[utils.SHADY_PREFIX + 'appendChild'](nc);\n      }\n    }\n    return n;\n  }\n\n});","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\nimport * as utils from '../utils.js';\nimport {addEventListener, removeEventListener} from '../patch-events.js';\n\nexport const WindowPatches = utils.getOwnPropertyDescriptors({\n\n  // NOTE: ensure these methods are bound to `window` so that `this` is correct\n  // when called directly from global context without a receiver; e.g.\n  // `addEventListener(...)`.\n  addEventListener: addEventListener.bind(window),\n\n  removeEventListener: removeEventListener.bind(window)\n\n});","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nimport * as utils from './utils.js';\nimport {EventTargetPatches} from './patches/EventTarget.js';\nimport {NodePatches} from './patches/Node.js';\nimport {SlotablePatches} from './patches/Slotable.js';\nimport {ParentNodePatches, ParentNodeDocumentOrFragmentPatches} from './patches/ParentNode.js';\nimport {ElementPatches} from './patches/Element.js';\nimport {ElementOrShadowRootPatches} from './patches/ElementOrShadowRoot.js';\nimport {HTMLElementPatches} from './patches/HTMLElement.js';\nimport {SlotPatches} from './patches/Slot.js';\nimport {DocumentOrFragmentPatches} from './patches/DocumentOrFragment.js';\nimport {DocumentOrShadowRootPatches} from './patches/DocumentOrShadowRoot.js';\nimport {DocumentPatches} from './patches/Document.js';\nimport {WindowPatches} from './patches/Window.js';\n\n// Some browsers (IE/Edge) have non-standard HTMLElement accessors.\nconst NonStandardHTMLElement = {};\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'parentElement')) {\n  NonStandardHTMLElement.parentElement = NodePatches.parentElement;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'contains')) {\n  NonStandardHTMLElement.contains = NodePatches.contains;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'children')) {\n  NonStandardHTMLElement.children = ParentNodePatches.children;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'innerHTML')) {\n  NonStandardHTMLElement.innerHTML = ElementOrShadowRootPatches.innerHTML;\n}\n\nif (Object.getOwnPropertyDescriptor(HTMLElement.prototype, 'className')) {\n  NonStandardHTMLElement.className = ElementPatches.className;\n}\n\n// Avoid patching `innerHTML` if it does not exist on Element (IE)\n// and we can patch accessors (hasDescriptors).\nconst ElementShouldHaveInnerHTML = !utils.settings.hasDescriptors || 'innerHTML' in Element.prototype;\n\n// setup patching\nconst patchMap = {\n  EventTarget: [EventTargetPatches],\n  Node: [NodePatches, !window.EventTarget ? EventTargetPatches : null],\n  Text: [SlotablePatches],\n  Element: [ElementPatches, ParentNodePatches, SlotablePatches,\n    ElementShouldHaveInnerHTML ? ElementOrShadowRootPatches : null,\n    !window.HTMLSlotElement ? SlotPatches : null],\n  HTMLElement: [HTMLElementPatches, NonStandardHTMLElement],\n  HTMLSlotElement: [SlotPatches],\n  DocumentFragment: [ParentNodeDocumentOrFragmentPatches, DocumentOrFragmentPatches],\n  Document: [DocumentPatches, ParentNodeDocumentOrFragmentPatches, DocumentOrFragmentPatches, DocumentOrShadowRootPatches],\n  Window: [WindowPatches]\n}\n\nconst getPatchPrototype = (name) => window[name] && window[name].prototype;\n\n// Note, must avoid patching accessors on prototypes when descriptors are not correct\n// because the CustomElements polyfill checks if these exist before patching instances.\n// CustomElements polyfill *only* cares about these accessors.\nconst disallowedNativePatches = utils.settings.hasDescriptors ? null : ['innerHTML', 'textContent'];\n\n/** @param {string=} prefix */\nexport const applyPatches = (prefix) => {\n  const disallowed = prefix ? null : disallowedNativePatches;\n  for (let p in patchMap) {\n    const proto = getPatchPrototype(p);\n    patchMap[p].forEach(patch => proto && patch &&\n        utils.patchProperties(proto, patch, prefix, disallowed));\n  }\n}\n\nexport const addShadyPrefixedProperties = () => {\n  // perform shady patches\n  applyPatches(utils.SHADY_PREFIX);\n\n  // install `_activeElement` because some browsers (older Chrome/Safari) do not have\n  // a 'configurable' `activeElement` accesssor.\n  const descriptor = DocumentOrShadowRootPatches.activeElement;\n  Object.defineProperty(document, '_activeElement', descriptor);\n\n  // On Window, we're patching `addEventListener` which is a weird auto-bound\n  // property that is not directly on the Window prototype.\n  utils.patchProperties(Window.prototype, WindowPatches, utils.SHADY_PREFIX);\n};\n","/**\n@license\nCopyright (c) 2016 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/**\n * Patches elements that interacts with ShadyDOM\n * such that tree traversal and mutation apis act like they would under\n * ShadowDOM.\n *\n * This import enables seemless interaction with ShadyDOM powered\n * custom elements, enabling better interoperation with 3rd party code,\n * libraries, and frameworks that use DOM tree manipulation apis.\n */\n\nimport * as utils from './utils.js';\nimport {flush, enqueue} from './flush.js';\nimport {observeChildren, unobserveChildren, filterMutations} from './observe-changes.js';\nimport {addNativePrefixedProperties, nativeMethods, nativeTree} from './patch-native.js';\nimport {patchInsideElementAccessors, patchOutsideElementAccessors} from './patch-instances.js';\nimport {patchEvents, patchClick, composedPath} from './patch-events.js';\nimport {ShadyRoot} from './attach-shadow.js';\nimport {wrap, Wrapper} from './wrapper.js';\nimport {addShadyPrefixedProperties, applyPatches} from './patch-prototypes.js';\n\nif (utils.settings.inUse) {\n  let ShadyDOM = {\n    // TODO(sorvell): remove when Polymer does not depend on this.\n    'inUse': utils.settings.inUse,\n    // NOTE: old browsers without prototype accessors (very old Chrome\n    // and Safari) need manually patched accessors to properly set\n    // `innerHTML` and `textContent` when an element is:\n    // (1) inside a shadowRoot\n    // (2) does not have special (slot) children itself\n    // (3) and setting the property needs to provoke distribution (because\n    // a nested slot is added/removed)\n    'patch': (node) => {\n      patchInsideElementAccessors(node);\n      patchOutsideElementAccessors(node);\n      return node;\n    },\n    'isShadyRoot': utils.isShadyRoot,\n    'enqueue': enqueue,\n    'flush': flush,\n    'flushInitial': (root) => {\n      root._flushInitial();\n    },\n    'settings': utils.settings,\n    'filterMutations': filterMutations,\n    'observeChildren': observeChildren,\n    'unobserveChildren': unobserveChildren,\n    // Set to true to defer native custom elements connection until the\n    // document has fully parsed. This enables custom elements that create\n    // shadowRoots to be defined while the document is loading. Elements\n    // customized as they are created by the parser will successfully\n    // render with this flag on.\n    'deferConnectionCallbacks': utils.settings['deferConnectionCallbacks'],\n    // Set to true to speed up the polyfill slightly at the cost of correctness\n    // * does not patch querySelector/All on Document or DocumentFragment\n    // * does not wrap connected/disconnected callbacks to de-dup these\n    // when using native customElements\n    // * does not wait to process children of elements with shadowRoots\n    // meaning shadowRoots should not be created while an element is parsing\n    // (e.g. if a custom element that creates a shadowRoot is defined before\n    // a candidate element in the document below it.\n    'preferPerformance': utils.settings['preferPerformance'],\n    // Integration point with ShadyCSS to disable styling MutationObserver,\n    // as ShadyDOM will now handle dynamic scoping.\n    'handlesDynamicScoping': true,\n    'wrap': utils.settings.noPatch ? wrap : (n) => n,\n    'Wrapper': Wrapper,\n    'composedPath': composedPath,\n    // Set to true to avoid patching regular platform property names. When set,\n    // Shadow DOM compatible behavior is only available when accessing DOM\n    // API using `ShadyDOM.wrap`, e.g. `ShadyDOM.wrap(element).shadowRoot`.\n    // This setting provides a small performance boost, but requires all DOM API\n    // access that requires Shadow DOM behavior to be proxied via `ShadyDOM.wrap`.\n    'noPatch': utils.settings.noPatch,\n    'nativeMethods': nativeMethods,\n    'nativeTree': nativeTree\n  };\n\n  window['ShadyDOM'] = ShadyDOM;\n\n  // Modifies native prototypes for Node, Element, etc. to\n  // make native platform behavior available at prefixed names, e.g.\n  // `utils.NATIVE_PREFIX + 'firstChild'` or `__shady_native_firstChild`.\n  // This allows the standard names to be safely patched while retaining the\n  // ability for native behavior to be used. This polyfill manipulates DOM\n  // by using this saved native behavior.\n  // Note, some browsers do not have proper element descriptors for\n  // accessors; in this case, native behavior for these accessors is simulated\n  // via a TreeWalker.\n  addNativePrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to make ShadowDOM\n  // behavior available at prefixed names, e.g.\n  // `utils.SHADY_PREFIX + 'firstChild` or `__shady_firstChild`. This is done\n  // so this polyfill can perform Shadow DOM style DOM manipulation.\n  // Because patching normal platform property names is optional, these prefixed\n  // names are used internally.\n  addShadyPrefixedProperties();\n\n  // Modifies native prototypes for Node, Element, etc. to patch\n  // regular platform property names to have Shadow DOM compatible API behavior.\n  // This applies the utils.SHADY_PREFIX behavior to normal names. For example,\n  // if `noPatch` is not set, then `el.__shady_firstChild` is equivalent to\n  // `el.firstChild`.\n  // NOTE, on older browsers (old Chrome/Safari) native accessors cannot be\n  // patched on prototypes (e.g. Node.prototype.firstChild cannot be modified).\n  // On these browsers, instance level patching is performed where needed; this\n  // instance patching is only done when `noPatch` is *not* set.\n  if (!utils.settings.noPatch) {\n    applyPatches();\n    // Patch click event behavior only if we're patching\n    patchClick()\n  }\n\n  // For simplicity, patch events unconditionally.\n  // Patches the event system to have Shadow DOM compatible behavior (e.g.\n  // event retargeting). When `noPatch` is set, retargeting is only available\n  // when adding event listeners and dispatching events via `ShadyDOM.wrap`\n  // (e.g. `ShadyDOM.wrap(element).addEventListener(...)`).\n  patchEvents();\n\n  window.ShadowRoot = /** @type {function(new:ShadowRoot)} */(ShadyRoot);\n}\n","const reservedTagList = new Set([\n  'annotation-xml',\n  'color-profile',\n  'font-face',\n  'font-face-src',\n  'font-face-uri',\n  'font-face-format',\n  'font-face-name',\n  'missing-glyph',\n]);\n\n/**\n * @param {string} localName\n * @returns {boolean}\n */\nexport function isValidCustomElementName(localName) {\n  const reserved = reservedTagList.has(localName);\n  const validForm = /^[a-z][.0-9_a-z]*-[\\-.0-9_a-z]*$/.test(localName);\n  return !reserved && validForm;\n}\n\n/**\n * @private\n * @param {!Node} node\n * @return {boolean}\n */\nexport function isConnected(node) {\n  // Use `Node#isConnected`, if defined.\n  const nativeValue = node.isConnected;\n  if (nativeValue !== undefined) {\n    return nativeValue;\n  }\n\n  /** @type {?Node|undefined} */\n  let current = node;\n  while (current && !(current.__CE_isImportDocument || current instanceof Document)) {\n    current = current.parentNode || (window.ShadowRoot && current instanceof ShadowRoot ? current.host : undefined);\n  }\n  return !!(current && (current.__CE_isImportDocument || current instanceof Document));\n}\n\n/**\n * @param {!Node} root\n * @param {!Node} start\n * @return {?Node}\n */\nfunction nextSiblingOrAncestorSibling(root, start) {\n  let node = start;\n  while (node && node !== root && !node.nextSibling) {\n    node = node.parentNode;\n  }\n  return (!node || node === root) ? null : node.nextSibling;\n}\n\n/**\n * @param {!Node} root\n * @param {!Node} start\n * @return {?Node}\n */\nfunction nextNode(root, start) {\n  return start.firstChild ? start.firstChild : nextSiblingOrAncestorSibling(root, start);\n}\n\n/**\n * @param {!Node} root\n * @param {!function(!Element)} callback\n * @param {!Set<Node>=} visitedImports\n */\nexport function walkDeepDescendantElements(root, callback, visitedImports = new Set()) {\n  let node = root;\n  while (node) {\n    if (node.nodeType === Node.ELEMENT_NODE) {\n      const element = /** @type {!Element} */(node);\n\n      callback(element);\n\n      const localName = element.localName;\n      if (localName === 'link' && element.getAttribute('rel') === 'import') {\n        // If this import (polyfilled or not) has it's root node available,\n        // walk it.\n        const importNode = /** @type {!Node} */ (element.import);\n        if (importNode instanceof Node && !visitedImports.has(importNode)) {\n          // Prevent multiple walks of the same import root.\n          visitedImports.add(importNode);\n\n          for (let child = importNode.firstChild; child; child = child.nextSibling) {\n            walkDeepDescendantElements(child, callback, visitedImports);\n          }\n        }\n\n        // Ignore descendants of import links to prevent attempting to walk the\n        // elements created by the HTML Imports polyfill that we just walked\n        // above.\n        node = nextSiblingOrAncestorSibling(root, element);\n        continue;\n      } else if (localName === 'template') {\n        // Ignore descendants of templates. There shouldn't be any descendants\n        // because they will be moved into `.content` during construction in\n        // browsers that support template but, in case they exist and are still\n        // waiting to be moved by a polyfill, they will be ignored.\n        node = nextSiblingOrAncestorSibling(root, element);\n        continue;\n      }\n\n      // Walk shadow roots.\n      const shadowRoot = element.__CE_shadowRoot;\n      if (shadowRoot) {\n        for (let child = shadowRoot.firstChild; child; child = child.nextSibling) {\n          walkDeepDescendantElements(child, callback, visitedImports);\n        }\n      }\n    }\n\n    node = nextNode(root, node);\n  }\n}\n\n/**\n * Used to suppress Closure's \"Modifying the prototype is only allowed if the\n * constructor is in the same scope\" warning without using\n * `@suppress {newCheckTypes, duplicate}` because `newCheckTypes` is too broad.\n *\n * @param {!Object} destination\n * @param {string} name\n * @param {*} value\n */\nexport function setPropertyUnchecked(destination, name, value) {\n  destination[name] = value;\n}\n","/**\n * @enum {number}\n */\nconst CustomElementState = {\n  custom: 1,\n  failed: 2,\n};\n\nexport default CustomElementState;\n","import * as Utilities from './Utilities.js';\nimport CEState from './CustomElementState.js';\n\nexport default class CustomElementInternals {\n  constructor() {\n    /** @type {!Map<string, !CustomElementDefinition>} */\n    this._localNameToDefinition = new Map();\n\n    /** @type {!Map<!Function, !CustomElementDefinition>} */\n    this._constructorToDefinition = new Map();\n\n    /** @type {!Array<!function(!Node)>} */\n    this._patches = [];\n\n    /** @type {boolean} */\n    this._hasPatches = false;\n  }\n\n  /**\n   * @param {string} localName\n   * @param {!CustomElementDefinition} definition\n   */\n  setDefinition(localName, definition) {\n    this._localNameToDefinition.set(localName, definition);\n    this._constructorToDefinition.set(definition.constructorFunction, definition);\n  }\n\n  /**\n   * @param {string} localName\n   * @return {!CustomElementDefinition|undefined}\n   */\n  localNameToDefinition(localName) {\n    return this._localNameToDefinition.get(localName);\n  }\n\n  /**\n   * @param {!Function} constructor\n   * @return {!CustomElementDefinition|undefined}\n   */\n  constructorToDefinition(constructor) {\n    return this._constructorToDefinition.get(constructor);\n  }\n\n  /**\n   * @param {!function(!Node)} listener\n   */\n  addPatch(listener) {\n    this._hasPatches = true;\n    this._patches.push(listener);\n  }\n\n  /**\n   * @param {!Node} node\n   */\n  patchTree(node) {\n    if (!this._hasPatches) return;\n\n    Utilities.walkDeepDescendantElements(node, element => this.patch(element));\n  }\n\n  /**\n   * @param {!Node} node\n   */\n  patch(node) {\n    if (!this._hasPatches) return;\n\n    if (node.__CE_patched) return;\n    node.__CE_patched = true;\n\n    for (let i = 0; i < this._patches.length; i++) {\n      this._patches[i](node);\n    }\n  }\n\n  /**\n   * @param {!Node} root\n   */\n  connectTree(root) {\n    const elements = [];\n\n    Utilities.walkDeepDescendantElements(root, element => elements.push(element));\n\n    for (let i = 0; i < elements.length; i++) {\n      const element = elements[i];\n      if (element.__CE_state === CEState.custom) {\n        this.connectedCallback(element);\n      } else {\n        this.upgradeElement(element);\n      }\n    }\n  }\n\n  /**\n   * @param {!Node} root\n   */\n  disconnectTree(root) {\n    const elements = [];\n\n    Utilities.walkDeepDescendantElements(root, element => elements.push(element));\n\n    for (let i = 0; i < elements.length; i++) {\n      const element = elements[i];\n      if (element.__CE_state === CEState.custom) {\n        this.disconnectedCallback(element);\n      }\n    }\n  }\n\n  /**\n   * Upgrades all uncustomized custom elements at and below a root node for\n   * which there is a definition. When custom element reaction callbacks are\n   * assumed to be called synchronously (which, by the current DOM / HTML spec\n   * definitions, they are *not*), callbacks for both elements customized\n   * synchronously by the parser and elements being upgraded occur in the same\n   * relative order.\n   *\n   * NOTE: This function, when used to simulate the construction of a tree that\n   * is already created but not customized (i.e. by the parser), does *not*\n   * prevent the element from reading the 'final' (true) state of the tree. For\n   * example, the element, during truly synchronous parsing / construction would\n   * see that it contains no children as they have not yet been inserted.\n   * However, this function does not modify the tree, the element will\n   * (incorrectly) have children. Additionally, self-modification restrictions\n   * for custom element constructors imposed by the DOM spec are *not* enforced.\n   *\n   *\n   * The following nested list shows the steps extending down from the HTML\n   * spec's parsing section that cause elements to be synchronously created and\n   * upgraded:\n   *\n   * The \"in body\" insertion mode:\n   * https://html.spec.whatwg.org/multipage/syntax.html#parsing-main-inbody\n   * - Switch on token:\n   *   .. other cases ..\n   *   -> Any other start tag\n   *      - [Insert an HTML element](below) for the token.\n   *\n   * Insert an HTML element:\n   * https://html.spec.whatwg.org/multipage/syntax.html#insert-an-html-element\n   * - Insert a foreign element for the token in the HTML namespace:\n   *   https://html.spec.whatwg.org/multipage/syntax.html#insert-a-foreign-element\n   *   - Create an element for a token:\n   *     https://html.spec.whatwg.org/multipage/syntax.html#create-an-element-for-the-token\n   *     - Will execute script flag is true?\n   *       - (Element queue pushed to the custom element reactions stack.)\n   *     - Create an element:\n   *       https://dom.spec.whatwg.org/#concept-create-element\n   *       - Sync CE flag is true?\n   *         - Constructor called.\n   *         - Self-modification restrictions enforced.\n   *       - Sync CE flag is false?\n   *         - (Upgrade reaction enqueued.)\n   *     - Attributes appended to element.\n   *       (`attributeChangedCallback` reactions enqueued.)\n   *     - Will execute script flag is true?\n   *       - (Element queue popped from the custom element reactions stack.\n   *         Reactions in the popped stack are invoked.)\n   *   - (Element queue pushed to the custom element reactions stack.)\n   *   - Insert the element:\n   *     https://dom.spec.whatwg.org/#concept-node-insert\n   *     - Shadow-including descendants are connected. During parsing\n   *       construction, there are no shadow-*excluding* descendants.\n   *       However, the constructor may have validly attached a shadow\n   *       tree to itself and added descendants to that shadow tree.\n   *       (`connectedCallback` reactions enqueued.)\n   *   - (Element queue popped from the custom element reactions stack.\n   *     Reactions in the popped stack are invoked.)\n   *\n   * @param {!Node} root\n   * @param {{\n   *   visitedImports: (!Set<!Node>|undefined),\n   *   upgrade: (!function(!Element)|undefined),\n   * }=} options\n   */\n  patchAndUpgradeTree(root, options = {}) {\n    const visitedImports = options.visitedImports || new Set();\n    const upgrade = options.upgrade || (element => this.upgradeElement(element));\n\n    const elements = [];\n\n    const gatherElements = element => {\n      if (element.localName === 'link' && element.getAttribute('rel') === 'import') {\n        // The HTML Imports polyfill sets a descendant element of the link to\n        // the `import` property, specifically this is *not* a Document.\n        const importNode = /** @type {?Node} */ (element.import);\n\n        if (importNode instanceof Node) {\n          importNode.__CE_isImportDocument = true;\n          // Connected links are associated with the registry.\n          importNode.__CE_hasRegistry = true;\n        }\n\n        if (importNode && importNode.readyState === 'complete') {\n          importNode.__CE_documentLoadHandled = true;\n        } else {\n          // If this link's import root is not available, its contents can't be\n          // walked. Wait for 'load' and walk it when it's ready.\n          element.addEventListener('load', () => {\n            const importNode = /** @type {!Node} */ (element.import);\n\n            if (importNode.__CE_documentLoadHandled) return;\n            importNode.__CE_documentLoadHandled = true;\n\n            // Clone the `visitedImports` set that was populated sync during\n            // the `patchAndUpgradeTree` call that caused this 'load' handler to\n            // be added. Then, remove *this* link's import node so that we can\n            // walk that import again, even if it was partially walked later\n            // during the same `patchAndUpgradeTree` call.\n            const clonedVisitedImports = new Set(visitedImports);\n            clonedVisitedImports.delete(importNode);\n\n            this.patchAndUpgradeTree(importNode, {visitedImports: clonedVisitedImports, upgrade});\n          });\n        }\n      } else {\n        elements.push(element);\n      }\n    };\n\n    // `walkDeepDescendantElements` populates (and internally checks against)\n    // `visitedImports` when traversing a loaded import.\n    Utilities.walkDeepDescendantElements(root, gatherElements, visitedImports);\n\n    if (this._hasPatches) {\n      for (let i = 0; i < elements.length; i++) {\n        this.patch(elements[i]);\n      }\n    }\n\n    for (let i = 0; i < elements.length; i++) {\n      upgrade(elements[i]);\n    }\n  }\n\n  /**\n   * @param {!HTMLElement} element\n   */\n  upgradeElement(element) {\n    const currentState = element.__CE_state;\n    if (currentState !== undefined) return;\n\n    // Prevent elements created in documents without a browsing context from\n    // upgrading.\n    //\n    // https://html.spec.whatwg.org/multipage/custom-elements.html#look-up-a-custom-element-definition\n    //   \"If document does not have a browsing context, return null.\"\n    //\n    // https://html.spec.whatwg.org/multipage/window-object.html#dom-document-defaultview\n    //   \"The defaultView IDL attribute of the Document interface, on getting,\n    //   must return this Document's browsing context's WindowProxy object, if\n    //   this Document has an associated browsing context, or null otherwise.\"\n    const ownerDocument = element.ownerDocument;\n    if (\n      !ownerDocument.defaultView &&\n      !(ownerDocument.__CE_isImportDocument && ownerDocument.__CE_hasRegistry)\n    ) return;\n\n    const definition = this.localNameToDefinition(element.localName);\n    if (!definition) return;\n\n    definition.constructionStack.push(element);\n\n    const constructor = definition.constructorFunction;\n    try {\n      try {\n        let result = new (constructor)();\n        if (result !== element) {\n          throw new Error('The custom element constructor did not produce the element being upgraded.');\n        }\n      } finally {\n        definition.constructionStack.pop();\n      }\n    } catch (e) {\n      element.__CE_state = CEState.failed;\n      throw e;\n    }\n\n    element.__CE_state = CEState.custom;\n    element.__CE_definition = definition;\n\n    if (definition.attributeChangedCallback) {\n      const observedAttributes = definition.observedAttributes;\n      for (let i = 0; i < observedAttributes.length; i++) {\n        const name = observedAttributes[i];\n        const value = element.getAttribute(name);\n        if (value !== null) {\n          this.attributeChangedCallback(element, name, null, value, null);\n        }\n      }\n    }\n\n    if (Utilities.isConnected(element)) {\n      this.connectedCallback(element);\n    }\n  }\n\n  /**\n   * @param {!Element} element\n   */\n  connectedCallback(element) {\n    const definition = element.__CE_definition;\n    if (definition.connectedCallback) {\n      definition.connectedCallback.call(element);\n    }\n  }\n\n  /**\n   * @param {!Element} element\n   */\n  disconnectedCallback(element) {\n    const definition = element.__CE_definition;\n    if (definition.disconnectedCallback) {\n      definition.disconnectedCallback.call(element);\n    }\n  }\n\n  /**\n   * @param {!Element} element\n   * @param {string} name\n   * @param {?string} oldValue\n   * @param {?string} newValue\n   * @param {?string} namespace\n   */\n  attributeChangedCallback(element, name, oldValue, newValue, namespace) {\n    const definition = element.__CE_definition;\n    if (\n      definition.attributeChangedCallback &&\n      definition.observedAttributes.indexOf(name) > -1\n    ) {\n      definition.attributeChangedCallback.call(element, name, oldValue, newValue, namespace);\n    }\n  }\n}\n","import CustomElementInternals from './CustomElementInternals.js';\n\nexport default class DocumentConstructionObserver {\n  constructor(internals, doc) {\n    /**\n     * @type {!CustomElementInternals}\n     */\n    this._internals = internals;\n\n    /**\n     * @type {!Document}\n     */\n    this._document = doc;\n\n    /**\n     * @type {MutationObserver|undefined}\n     */\n    this._observer = undefined;\n\n\n    // Simulate tree construction for all currently accessible nodes in the\n    // document.\n    this._internals.patchAndUpgradeTree(this._document);\n\n    if (this._document.readyState === 'loading') {\n      this._observer = new MutationObserver(this._handleMutations.bind(this));\n\n      // Nodes created by the parser are given to the observer *before* the next\n      // task runs. Inline scripts are run in a new task. This means that the\n      // observer will be able to handle the newly parsed nodes before the inline\n      // script is run.\n      this._observer.observe(this._document, {\n        childList: true,\n        subtree: true,\n      });\n    }\n  }\n\n  disconnect() {\n    if (this._observer) {\n      this._observer.disconnect();\n    }\n  }\n\n  /**\n   * @param {!Array<!MutationRecord>} mutations\n   */\n  _handleMutations(mutations) {\n    // Once the document's `readyState` is 'interactive' or 'complete', all new\n    // nodes created within that document will be the result of script and\n    // should be handled by patching.\n    const readyState = this._document.readyState;\n    if (readyState === 'interactive' || readyState === 'complete') {\n      this.disconnect();\n    }\n\n    for (let i = 0; i < mutations.length; i++) {\n      const addedNodes = mutations[i].addedNodes;\n      for (let j = 0; j < addedNodes.length; j++) {\n        const node = addedNodes[j];\n        this._internals.patchAndUpgradeTree(node);\n      }\n    }\n  }\n}\n","/**\n * @template T\n */\nexport default class Deferred {\n  constructor() {\n    /**\n     * @private\n     * @type {T|undefined}\n     */\n    this._value = undefined;\n\n    /**\n     * @private\n     * @type {Function|undefined}\n     */\n    this._resolve = undefined;\n\n    /**\n     * @private\n     * @type {!Promise<T>}\n     */\n    this._promise = new Promise(resolve => {\n      this._resolve = resolve;\n\n      if (this._value) {\n        resolve(this._value);\n      }\n    });\n  }\n\n  /**\n   * @param {T} value\n   */\n  resolve(value) {\n    if (this._value) {\n      throw new Error('Already resolved.');\n    }\n\n    this._value = value;\n\n    if (this._resolve) {\n      this._resolve(value);\n    }\n  }\n\n  /**\n   * @return {!Promise<T>}\n   */\n  toPromise() {\n    return this._promise;\n  }\n}\n","import CustomElementInternals from './CustomElementInternals.js';\nimport DocumentConstructionObserver from './DocumentConstructionObserver.js';\nimport Deferred from './Deferred.js';\nimport * as Utilities from './Utilities.js';\n\n/**\n * @unrestricted\n */\nexport default class CustomElementRegistry {\n\n  /**\n   * @param {!CustomElementInternals} internals\n   */\n  constructor(internals) {\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._elementDefinitionIsRunning = false;\n\n    /**\n     * @private\n     * @type {!CustomElementInternals}\n     */\n    this._internals = internals;\n\n    /**\n     * @private\n     * @type {!Map<string, !Deferred<undefined>>}\n     */\n    this._whenDefinedDeferred = new Map();\n\n    /**\n     * The default flush callback triggers the document walk synchronously.\n     * @private\n     * @type {!Function}\n     */\n    this._flushCallback = fn => fn();\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    this._flushPending = false;\n\n    /**\n     * @private\n     * @type {!Array<!CustomElementDefinition>}\n     */\n    this._pendingDefinitions = [];\n\n    /**\n     * @private\n     * @type {!DocumentConstructionObserver}\n     */\n    this._documentConstructionObserver = new DocumentConstructionObserver(internals, document);\n  }\n\n  /**\n   * @param {string} localName\n   * @param {!Function} constructor\n   */\n  define(localName, constructor) {\n    if (!(constructor instanceof Function)) {\n      throw new TypeError('Custom element constructors must be functions.');\n    }\n\n    if (!Utilities.isValidCustomElementName(localName)) {\n      throw new SyntaxError(`The element name '${localName}' is not valid.`);\n    }\n\n    if (this._internals.localNameToDefinition(localName)) {\n      throw new Error(`A custom element with name '${localName}' has already been defined.`);\n    }\n\n    if (this._elementDefinitionIsRunning) {\n      throw new Error('A custom element is already being defined.');\n    }\n    this._elementDefinitionIsRunning = true;\n\n    let connectedCallback;\n    let disconnectedCallback;\n    let adoptedCallback;\n    let attributeChangedCallback;\n    let observedAttributes;\n    try {\n      /** @type {!Object} */\n      const prototype = constructor.prototype;\n      if (!(prototype instanceof Object)) {\n        throw new TypeError('The custom element constructor\\'s prototype is not an object.');\n      }\n\n      function getCallback(name) {\n        const callbackValue = prototype[name];\n        if (callbackValue !== undefined && !(callbackValue instanceof Function)) {\n          throw new Error(`The '${name}' callback must be a function.`);\n        }\n        return callbackValue;\n      }\n\n      connectedCallback = getCallback('connectedCallback');\n      disconnectedCallback = getCallback('disconnectedCallback');\n      adoptedCallback = getCallback('adoptedCallback');\n      attributeChangedCallback = getCallback('attributeChangedCallback');\n      observedAttributes = constructor['observedAttributes'] || [];\n    } catch (e) {\n      return;\n    } finally {\n      this._elementDefinitionIsRunning = false;\n    }\n\n    const definition = {\n      localName,\n      constructorFunction: constructor,\n      connectedCallback,\n      disconnectedCallback,\n      adoptedCallback,\n      attributeChangedCallback,\n      observedAttributes,\n      constructionStack: [],\n    };\n\n    this._internals.setDefinition(localName, definition);\n    this._pendingDefinitions.push(definition);\n\n    // If we've already called the flush callback and it hasn't called back yet,\n    // don't call it again.\n    if (!this._flushPending) {\n      this._flushPending = true;\n      this._flushCallback(() => this._flush());\n    }\n  }\n\n  upgrade(element) {\n    this._internals.patchAndUpgradeTree(element);\n  }\n\n  _flush() {\n    // If no new definitions were defined, don't attempt to flush. This could\n    // happen if a flush callback keeps the function it is given and calls it\n    // multiple times.\n    if (this._flushPending === false) return;\n    this._flushPending = false;\n\n    const pendingDefinitions = this._pendingDefinitions;\n\n    /**\n     * Unupgraded elements with definitions that were defined *before* the last\n     * flush, in document order.\n     * @type {!Array<!HTMLElement>}\n     */\n    const elementsWithStableDefinitions = [];\n\n    /**\n     * A map from `localName`s of definitions that were defined *after* the last\n     * flush to unupgraded elements matching that definition, in document order.\n     * @type {!Map<string, !Array<!HTMLElement>>}\n     */\n    const elementsWithPendingDefinitions = new Map();\n    for (let i = 0; i < pendingDefinitions.length; i++) {\n      elementsWithPendingDefinitions.set(pendingDefinitions[i].localName, []);\n    }\n\n    this._internals.patchAndUpgradeTree(document, {\n      upgrade: element => {\n        // Ignore the element if it has already upgraded or failed to upgrade.\n        if (element.__CE_state !== undefined) return;\n\n        const localName = element.localName;\n\n        // If there is an applicable pending definition for the element, add the\n        // element to the list of elements to be upgraded with that definition.\n        const pendingElements = elementsWithPendingDefinitions.get(localName);\n        if (pendingElements) {\n          pendingElements.push(element);\n        // If there is *any other* applicable definition for the element, add it\n        // to the list of elements with stable definitions that need to be upgraded.\n        } else if (this._internals.localNameToDefinition(localName)) {\n          elementsWithStableDefinitions.push(element);\n        }\n      },\n    });\n\n    // Upgrade elements with 'stable' definitions first.\n    for (let i = 0; i < elementsWithStableDefinitions.length; i++) {\n      this._internals.upgradeElement(elementsWithStableDefinitions[i]);\n    }\n\n    // Upgrade elements with 'pending' definitions in the order they were defined.\n    while (pendingDefinitions.length > 0) {\n      const definition = pendingDefinitions.shift();\n      const localName = definition.localName;\n\n      // Attempt to upgrade all applicable elements.\n      const pendingUpgradableElements = elementsWithPendingDefinitions.get(definition.localName);\n      for (let i = 0; i < pendingUpgradableElements.length; i++) {\n        this._internals.upgradeElement(pendingUpgradableElements[i]);\n      }\n\n      // Resolve any promises created by `whenDefined` for the definition.\n      const deferred = this._whenDefinedDeferred.get(localName);\n      if (deferred) {\n        deferred.resolve(undefined);\n      }\n    }\n  }\n\n  /**\n   * @param {string} localName\n   * @return {Function|undefined}\n   */\n  get(localName) {\n    const definition = this._internals.localNameToDefinition(localName);\n    if (definition) {\n      return definition.constructorFunction;\n    }\n\n    return undefined;\n  }\n\n  /**\n   * @param {string} localName\n   * @return {!Promise<undefined>}\n   */\n  whenDefined(localName) {\n    if (!Utilities.isValidCustomElementName(localName)) {\n      return Promise.reject(new SyntaxError(`'${localName}' is not a valid custom element name.`));\n    }\n\n    const prior = this._whenDefinedDeferred.get(localName);\n    if (prior) {\n      return prior.toPromise();\n    }\n\n    const deferred = new Deferred();\n    this._whenDefinedDeferred.set(localName, deferred);\n\n    const definition = this._internals.localNameToDefinition(localName);\n    // Resolve immediately only if the given local name has a definition *and*\n    // the full document walk to upgrade elements with that local name has\n    // already happened.\n    if (definition && !this._pendingDefinitions.some(d => d.localName === localName)) {\n      deferred.resolve(undefined);\n    }\n\n    return deferred.toPromise();\n  }\n\n  polyfillWrapFlushCallback(outer) {\n    this._documentConstructionObserver.disconnect();\n    const inner = this._flushCallback;\n    this._flushCallback = flush => outer(() => inner(flush));\n  }\n}\n\n// Closure compiler exports.\nwindow['CustomElementRegistry'] = CustomElementRegistry;\nCustomElementRegistry.prototype['define'] = CustomElementRegistry.prototype.define;\nCustomElementRegistry.prototype['upgrade'] = CustomElementRegistry.prototype.upgrade;\nCustomElementRegistry.prototype['get'] = CustomElementRegistry.prototype.get;\nCustomElementRegistry.prototype['whenDefined'] = CustomElementRegistry.prototype.whenDefined;\nCustomElementRegistry.prototype['polyfillWrapFlushCallback'] = CustomElementRegistry.prototype.polyfillWrapFlushCallback;\n","export default {\n  Document_createElement: window.Document.prototype.createElement,\n  Document_createElementNS: window.Document.prototype.createElementNS,\n  Document_importNode: window.Document.prototype.importNode,\n  Document_prepend: window.Document.prototype['prepend'],\n  Document_append: window.Document.prototype['append'],\n  DocumentFragment_prepend: window.DocumentFragment.prototype['prepend'],\n  DocumentFragment_append: window.DocumentFragment.prototype['append'],\n  Node_cloneNode: window.Node.prototype.cloneNode,\n  Node_appendChild: window.Node.prototype.appendChild,\n  Node_insertBefore: window.Node.prototype.insertBefore,\n  Node_removeChild: window.Node.prototype.removeChild,\n  Node_replaceChild: window.Node.prototype.replaceChild,\n  Node_textContent: Object.getOwnPropertyDescriptor(window.Node.prototype, 'textContent'),\n  Element_attachShadow: window.Element.prototype['attachShadow'],\n  Element_innerHTML: Object.getOwnPropertyDescriptor(window.Element.prototype, 'innerHTML'),\n  Element_getAttribute: window.Element.prototype.getAttribute,\n  Element_setAttribute: window.Element.prototype.setAttribute,\n  Element_removeAttribute: window.Element.prototype.removeAttribute,\n  Element_getAttributeNS: window.Element.prototype.getAttributeNS,\n  Element_setAttributeNS: window.Element.prototype.setAttributeNS,\n  Element_removeAttributeNS: window.Element.prototype.removeAttributeNS,\n  Element_insertAdjacentElement: window.Element.prototype['insertAdjacentElement'],\n  Element_insertAdjacentHTML: window.Element.prototype['insertAdjacentHTML'],\n  Element_prepend: window.Element.prototype['prepend'],\n  Element_append: window.Element.prototype['append'],\n  Element_before: window.Element.prototype['before'],\n  Element_after: window.Element.prototype['after'],\n  Element_replaceWith: window.Element.prototype['replaceWith'],\n  Element_remove: window.Element.prototype['remove'],\n  HTMLElement: window.HTMLElement,\n  HTMLElement_innerHTML: Object.getOwnPropertyDescriptor(window.HTMLElement.prototype, 'innerHTML'),\n  HTMLElement_insertAdjacentElement: window.HTMLElement.prototype['insertAdjacentElement'],\n  HTMLElement_insertAdjacentHTML: window.HTMLElement.prototype['insertAdjacentHTML'],\n};\n","/**\n * This class exists only to work around Closure's lack of a way to describe\n * singletons. It represents the 'already constructed marker' used in custom\n * element construction stacks.\n *\n * https://html.spec.whatwg.org/#concept-already-constructed-marker\n * @extends AlreadyConstructedMarkerType\n */\nclass AlreadyConstructedMarker {}\n\nexport default new AlreadyConstructedMarker();\n","import Native from './Native.js';\nimport CustomElementInternals from '../CustomElementInternals.js';\nimport CEState from '../CustomElementState.js';\nimport AlreadyConstructedMarker from '../AlreadyConstructedMarker.js';\n\n/**\n * @param {!CustomElementInternals} internals\n */\nexport default function(internals) {\n  window['HTMLElement'] = (function() {\n    /**\n     * @type {function(new: HTMLElement): !HTMLElement}\n     */\n    function HTMLElement() {\n      // This should really be `new.target` but `new.target` can't be emulated\n      // in ES5. Assuming the user keeps the default value of the constructor's\n      // prototype's `constructor` property, this is equivalent.\n      const constructor = /** @type {!Function} */ (this.constructor);\n\n      const definition = internals.constructorToDefinition(constructor);\n      if (!definition) {\n        throw new Error('The custom element being constructed was not registered with `customElements`.');\n      }\n\n      const constructionStack = definition.constructionStack;\n\n      if (constructionStack.length === 0) {\n        const element = /** @type {!HTMLElement} */ (Native.Document_createElement.call(document, definition.localName));\n        Object.setPrototypeOf(element, constructor.prototype);\n        element.__CE_state = CEState.custom;\n        element.__CE_definition = definition;\n        internals.patch(element);\n        return element;\n      }\n\n      const lastIndex = constructionStack.length - 1;\n      const element = constructionStack[lastIndex];\n      if (element === AlreadyConstructedMarker) {\n        throw new Error('The HTMLElement constructor was either called reentrantly for this constructor or called multiple times.');\n      }\n      const toConstructElement = /** @type {!HTMLElement} */ (element);\n      constructionStack[lastIndex] = AlreadyConstructedMarker;\n\n      Object.setPrototypeOf(toConstructElement, constructor.prototype);\n      internals.patch(toConstructElement);\n\n      return toConstructElement;\n    }\n\n    HTMLElement.prototype = Native.HTMLElement.prototype;\n    // Safari 9 has `writable: false` on the propertyDescriptor\n    // Make it writable so that TypeScript can patch up the\n    // constructor in the ES5 compiled code.\n    Object.defineProperty(HTMLElement.prototype, 'constructor', {\n      writable: true,\n      configurable: true,\n      enumerable: false,\n      value: HTMLElement\n    });\n\n    return HTMLElement;\n  })();\n};\n","import CustomElementInternals from '../../CustomElementInternals.js';\nimport * as Utilities from '../../Utilities.js';\n\n/**\n * @typedef {{\n *   prepend: !function(...(!Node|string)),\n  *  append: !function(...(!Node|string)),\n * }}\n */\nlet ParentNodeNativeMethods;\n\n/**\n * @param {!CustomElementInternals} internals\n * @param {!Object} destination\n * @param {!ParentNodeNativeMethods} builtIn\n */\nexport default function(internals, destination, builtIn) {\n  /**\n   * @param {!function(...(!Node|string))} builtInMethod\n   * @return {!function(...(!Node|string))}\n   */\n  function appendPrependPatch(builtInMethod) {\n    return function(...nodes) {\n      /**\n       * A copy of `nodes`, with any DocumentFragment replaced by its children.\n       * @type {!Array<!Node>}\n       */\n      const flattenedNodes = [];\n\n      /**\n       * Elements in `nodes` that were connected before this call.\n       * @type {!Array<!Node>}\n       */\n      const connectedElements = [];\n\n      for (var i = 0; i < nodes.length; i++) {\n        const node = nodes[i];\n\n        if (node instanceof Element && Utilities.isConnected(node)) {\n          connectedElements.push(node);\n        }\n\n        if (node instanceof DocumentFragment) {\n          for (let child = node.firstChild; child; child = child.nextSibling) {\n            flattenedNodes.push(child);\n          }\n        } else {\n          flattenedNodes.push(node);\n        }\n      }\n\n      builtInMethod.apply(this, nodes);\n\n      for (let i = 0; i < connectedElements.length; i++) {\n        internals.disconnectTree(connectedElements[i]);\n      }\n\n      if (Utilities.isConnected(this)) {\n        for (let i = 0; i < flattenedNodes.length; i++) {\n          const node = flattenedNodes[i];\n          if (node instanceof Element) {\n            internals.connectTree(node);\n          }\n        }\n      }\n    };\n  }\n\n  if (builtIn.prepend !== undefined) {\n    Utilities.setPropertyUnchecked(destination, 'prepend', appendPrependPatch(builtIn.prepend));\n  }\n\n  if (builtIn.append !== undefined) {\n    Utilities.setPropertyUnchecked(destination, 'append', appendPrependPatch(builtIn.append));\n  }\n};\n","import Native from './Native.js';\nimport CustomElementInternals from '../CustomElementInternals.js';\nimport * as Utilities from '../Utilities.js';\n\nimport PatchParentNode from './Interface/ParentNode.js';\n\n/**\n * @param {!CustomElementInternals} internals\n */\nexport default function(internals) {\n  Utilities.setPropertyUnchecked(Document.prototype, 'createElement',\n    /**\n     * @this {Document}\n     * @param {string} localName\n     * @return {!Element}\n     */\n    function(localName) {\n      // Only create custom elements if this document is associated with the registry.\n      if (this.__CE_hasRegistry) {\n        const definition = internals.localNameToDefinition(localName);\n        if (definition) {\n          return new (definition.constructorFunction)();\n        }\n      }\n\n      const result = /** @type {!Element} */\n        (Native.Document_createElement.call(this, localName));\n      internals.patch(result);\n      return result;\n    });\n\n  Utilities.setPropertyUnchecked(Document.prototype, 'importNode',\n    /**\n     * @this {Document}\n     * @param {!Node} node\n     * @param {boolean=} deep\n     * @return {!Node}\n     */\n    function(node, deep) {\n      const clone = /** @type {!Node} */ (Native.Document_importNode.call(this, node, !!deep));\n      // Only create custom elements if this document is associated with the registry.\n      if (!this.__CE_hasRegistry) {\n        internals.patchTree(clone);\n      } else {\n        internals.patchAndUpgradeTree(clone);\n      }\n      return clone;\n    });\n\n  const NS_HTML = \"http://www.w3.org/1999/xhtml\";\n\n  Utilities.setPropertyUnchecked(Document.prototype, 'createElementNS',\n    /**\n     * @this {Document}\n     * @param {?string} namespace\n     * @param {string} localName\n     * @return {!Element}\n     */\n    function(namespace, localName) {\n      // Only create custom elements if this document is associated with the registry.\n      if (this.__CE_hasRegistry && (namespace === null || namespace === NS_HTML)) {\n        const definition = internals.localNameToDefinition(localName);\n        if (definition) {\n          return new (definition.constructorFunction)();\n        }\n      }\n\n      const result = /** @type {!Element} */\n        (Native.Document_createElementNS.call(this, namespace, localName));\n      internals.patch(result);\n      return result;\n    });\n\n  PatchParentNode(internals, Document.prototype, {\n    prepend: Native.Document_prepend,\n    append: Native.Document_append,\n  });\n};\n","import CustomElementInternals from '../CustomElementInternals.js';\nimport Native from './Native.js';\nimport PatchParentNode from './Interface/ParentNode.js';\n\n/**\n * @param {!CustomElementInternals} internals\n */\nexport default function(internals) {\n  PatchParentNode(internals, DocumentFragment.prototype, {\n    prepend: Native.DocumentFragment_prepend,\n    append: Native.DocumentFragment_append,\n  });\n};\n","import Native from './Native.js';\nimport CustomElementInternals from '../CustomElementInternals.js';\nimport * as Utilities from '../Utilities.js';\n\n/**\n * @param {!CustomElementInternals} internals\n */\nexport default function(internals) {\n  // `Node#nodeValue` is implemented on `Attr`.\n  // `Node#textContent` is implemented on `Attr`, `Element`.\n\n  Utilities.setPropertyUnchecked(Node.prototype, 'insertBefore',\n    /**\n     * @this {Node}\n     * @param {!Node} node\n     * @param {?Node} refNode\n     * @return {!Node}\n     */\n    function(node, refNode) {\n      if (node instanceof DocumentFragment) {\n        const insertedNodes = Array.prototype.slice.apply(node.childNodes);\n        const nativeResult = Native.Node_insertBefore.call(this, node, refNode);\n\n        // DocumentFragments can't be connected, so `disconnectTree` will never\n        // need to be called on a DocumentFragment's children after inserting it.\n\n        if (Utilities.isConnected(this)) {\n          for (let i = 0; i < insertedNodes.length; i++) {\n            internals.connectTree(insertedNodes[i]);\n          }\n        }\n\n        return nativeResult;\n      }\n\n      const nodeWasConnected = Utilities.isConnected(node);\n      const nativeResult = Native.Node_insertBefore.call(this, node, refNode);\n\n      if (nodeWasConnected) {\n        internals.disconnectTree(node);\n      }\n\n      if (Utilities.isConnected(this)) {\n        internals.connectTree(node);\n      }\n\n      return nativeResult;\n    });\n\n  Utilities.setPropertyUnchecked(Node.prototype, 'appendChild',\n    /**\n     * @this {Node}\n     * @param {!Node} node\n     * @return {!Node}\n     */\n    function(node) {\n      if (node instanceof DocumentFragment) {\n        const insertedNodes = Array.prototype.slice.apply(node.childNodes);\n        const nativeResult = Native.Node_appendChild.call(this, node);\n\n        // DocumentFragments can't be connected, so `disconnectTree` will never\n        // need to be called on a DocumentFragment's children after inserting it.\n\n        if (Utilities.isConnected(this)) {\n          for (let i = 0; i < insertedNodes.length; i++) {\n            internals.connectTree(insertedNodes[i]);\n          }\n        }\n\n        return nativeResult;\n      }\n\n      const nodeWasConnected = Utilities.isConnected(node);\n      const nativeResult = Native.Node_appendChild.call(this, node);\n\n      if (nodeWasConnected) {\n        internals.disconnectTree(node);\n      }\n\n      if (Utilities.isConnected(this)) {\n        internals.connectTree(node);\n      }\n\n      return nativeResult;\n    });\n\n  Utilities.setPropertyUnchecked(Node.prototype, 'cloneNode',\n    /**\n     * @this {Node}\n     * @param {boolean=} deep\n     * @return {!Node}\n     */\n    function(deep) {\n      const clone = Native.Node_cloneNode.call(this, !!deep);\n      // Only create custom elements if this element's owner document is\n      // associated with the registry.\n      if (!this.ownerDocument.__CE_hasRegistry) {\n        internals.patchTree(clone);\n      } else {\n        internals.patchAndUpgradeTree(clone);\n      }\n      return clone;\n    });\n\n  Utilities.setPropertyUnchecked(Node.prototype, 'removeChild',\n    /**\n     * @this {Node}\n     * @param {!Node} node\n     * @return {!Node}\n     */\n    function(node) {\n      const nodeWasConnected = Utilities.isConnected(node);\n      const nativeResult = Native.Node_removeChild.call(this, node);\n\n      if (nodeWasConnected) {\n        internals.disconnectTree(node);\n      }\n\n      return nativeResult;\n    });\n\n  Utilities.setPropertyUnchecked(Node.prototype, 'replaceChild',\n    /**\n     * @this {Node}\n     * @param {!Node} nodeToInsert\n     * @param {!Node} nodeToRemove\n     * @return {!Node}\n     */\n    function(nodeToInsert, nodeToRemove) {\n      if (nodeToInsert instanceof DocumentFragment) {\n        const insertedNodes = Array.prototype.slice.apply(nodeToInsert.childNodes);\n        const nativeResult = Native.Node_replaceChild.call(this, nodeToInsert, nodeToRemove);\n\n        // DocumentFragments can't be connected, so `disconnectTree` will never\n        // need to be called on a DocumentFragment's children after inserting it.\n\n        if (Utilities.isConnected(this)) {\n          internals.disconnectTree(nodeToRemove);\n          for (let i = 0; i < insertedNodes.length; i++) {\n            internals.connectTree(insertedNodes[i]);\n          }\n        }\n\n        return nativeResult;\n      }\n\n      const nodeToInsertWasConnected = Utilities.isConnected(nodeToInsert);\n      const nativeResult = Native.Node_replaceChild.call(this, nodeToInsert, nodeToRemove);\n      const thisIsConnected = Utilities.isConnected(this);\n\n      if (thisIsConnected) {\n        internals.disconnectTree(nodeToRemove);\n      }\n\n      if (nodeToInsertWasConnected) {\n        internals.disconnectTree(nodeToInsert);\n      }\n\n      if (thisIsConnected) {\n        internals.connectTree(nodeToInsert);\n      }\n\n      return nativeResult;\n    });\n\n\n  function patch_textContent(destination, baseDescriptor) {\n    Object.defineProperty(destination, 'textContent', {\n      enumerable: baseDescriptor.enumerable,\n      configurable: true,\n      get: baseDescriptor.get,\n      set: /** @this {Node} */ function(assignedValue) {\n        // If this is a text node then there are no nodes to disconnect.\n        if (this.nodeType === Node.TEXT_NODE) {\n          baseDescriptor.set.call(this, assignedValue);\n          return;\n        }\n\n        let removedNodes = undefined;\n        // Checking for `firstChild` is faster than reading `childNodes.length`\n        // to compare with 0.\n        if (this.firstChild) {\n          // Using `childNodes` is faster than `children`, even though we only\n          // care about elements.\n          const childNodes = this.childNodes;\n          const childNodesLength = childNodes.length;\n          if (childNodesLength > 0 && Utilities.isConnected(this)) {\n            // Copying an array by iterating is faster than using slice.\n            removedNodes = new Array(childNodesLength);\n            for (let i = 0; i < childNodesLength; i++) {\n              removedNodes[i] = childNodes[i];\n            }\n          }\n        }\n\n        baseDescriptor.set.call(this, assignedValue);\n\n        if (removedNodes) {\n          for (let i = 0; i < removedNodes.length; i++) {\n            internals.disconnectTree(removedNodes[i]);\n          }\n        }\n      },\n    });\n  }\n\n  if (Native.Node_textContent && Native.Node_textContent.get) {\n    patch_textContent(Node.prototype, Native.Node_textContent);\n  } else {\n    internals.addPatch(function(element) {\n      patch_textContent(element, {\n        enumerable: true,\n        configurable: true,\n        // NOTE: This implementation of the `textContent` getter assumes that\n        // text nodes' `textContent` getter will not be patched.\n        get: /** @this {Node} */ function() {\n          /** @type {!Array<string>} */\n          const parts = [];\n\n          for (let i = 0; i < this.childNodes.length; i++) {\n            parts.push(this.childNodes[i].textContent);\n          }\n\n          return parts.join('');\n        },\n        set: /** @this {Node} */ function(assignedValue) {\n          while (this.firstChild) {\n            Native.Node_removeChild.call(this, this.firstChild);\n          }\n          Native.Node_appendChild.call(this, document.createTextNode(assignedValue));\n        },\n      });\n    });\n  }\n};\n","import CustomElementInternals from '../../CustomElementInternals.js';\nimport * as Utilities from '../../Utilities.js';\n\n/**\n * @typedef {{\n *   before: !function(...(!Node|string)),\n *   after: !function(...(!Node|string)),\n *   replaceWith: !function(...(!Node|string)),\n *   remove: !function(),\n * }}\n */\nlet ChildNodeNativeMethods;\n\n/**\n * @param {!CustomElementInternals} internals\n * @param {!Object} destination\n * @param {!ChildNodeNativeMethods} builtIn\n */\nexport default function(internals, destination, builtIn) {\n  /**\n   * @param {!function(...(!Node|string))} builtInMethod\n   * @return {!function(...(!Node|string))}\n   */\n  function beforeAfterPatch(builtInMethod) {\n    return function(...nodes) {\n      /**\n       * A copy of `nodes`, with any DocumentFragment replaced by its children.\n       * @type {!Array<!Node>}\n       */\n      const flattenedNodes = [];\n\n      /**\n       * Elements in `nodes` that were connected before this call.\n       * @type {!Array<!Node>}\n       */\n      const connectedElements = [];\n\n      for (var i = 0; i < nodes.length; i++) {\n        const node = nodes[i];\n\n        if (node instanceof Element && Utilities.isConnected(node)) {\n          connectedElements.push(node);\n        }\n\n        if (node instanceof DocumentFragment) {\n          for (let child = node.firstChild; child; child = child.nextSibling) {\n            flattenedNodes.push(child);\n          }\n        } else {\n          flattenedNodes.push(node);\n        }\n      }\n\n      builtInMethod.apply(this, nodes);\n\n      for (let i = 0; i < connectedElements.length; i++) {\n        internals.disconnectTree(connectedElements[i]);\n      }\n\n      if (Utilities.isConnected(this)) {\n        for (let i = 0; i < flattenedNodes.length; i++) {\n          const node = flattenedNodes[i];\n          if (node instanceof Element) {\n            internals.connectTree(node);\n          }\n        }\n      }\n    };\n  }\n\n  if (builtIn.before !== undefined) {\n    Utilities.setPropertyUnchecked(destination, 'before', beforeAfterPatch(builtIn.before));\n  }\n\n  if (builtIn.before !== undefined) {\n    Utilities.setPropertyUnchecked(destination, 'after', beforeAfterPatch(builtIn.after));\n  }\n\n  if (builtIn.replaceWith !== undefined) {\n    Utilities.setPropertyUnchecked(destination, 'replaceWith',\n      /**\n       * @param {...(!Node|string)} nodes\n       */\n      function(...nodes) {\n        /**\n         * A copy of `nodes`, with any DocumentFragment replaced by its children.\n         * @type {!Array<!Node|string>}\n         */\n        const flattenedNodes = [];\n\n        /**\n         * Elements in `nodes` that were connected before this call.\n         * @type {!Array<!Node>}\n         */\n        const connectedElements = [];\n\n        for (var i = 0; i < nodes.length; i++) {\n          const node = nodes[i];\n\n          if (node instanceof Element && Utilities.isConnected(node)) {\n            connectedElements.push(node);\n          }\n\n          if (node instanceof DocumentFragment) {\n            for (let child = node.firstChild; child; child = child.nextSibling) {\n              flattenedNodes.push(child);\n            }\n          } else {\n            flattenedNodes.push(node);\n          }\n        }\n\n        const wasConnected = Utilities.isConnected(this);\n\n        builtIn.replaceWith.apply(this, nodes);\n\n        for (let i = 0; i < connectedElements.length; i++) {\n          internals.disconnectTree(connectedElements[i]);\n        }\n\n        if (wasConnected) {\n          internals.disconnectTree(this);\n          for (let i = 0; i < flattenedNodes.length; i++) {\n            const node = flattenedNodes[i];\n            if (node instanceof Element) {\n              internals.connectTree(node);\n            }\n          }\n        }\n      });\n    }\n\n  if (builtIn.remove !== undefined) {\n    Utilities.setPropertyUnchecked(destination, 'remove',\n      function() {\n        const wasConnected = Utilities.isConnected(this);\n\n        builtIn.remove.call(this);\n\n        if (wasConnected) {\n          internals.disconnectTree(this);\n        }\n      });\n  }\n};\n","import Native from './Native.js';\nimport CustomElementInternals from '../CustomElementInternals.js';\nimport CEState from '../CustomElementState.js';\nimport * as Utilities from '../Utilities.js';\n\nimport PatchParentNode from './Interface/ParentNode.js';\nimport PatchChildNode from './Interface/ChildNode.js';\n\n/**\n * @param {!CustomElementInternals} internals\n */\nexport default function(internals) {\n  if (Native.Element_attachShadow) {\n    Utilities.setPropertyUnchecked(Element.prototype, 'attachShadow',\n      /**\n       * @this {Element}\n       * @param {!{mode: string}} init\n       * @return {ShadowRoot}\n       */\n      function(init) {\n        const shadowRoot = Native.Element_attachShadow.call(this, init);\n        this.__CE_shadowRoot = shadowRoot;\n        return shadowRoot;\n      });\n  }\n\n\n  function patch_innerHTML(destination, baseDescriptor) {\n    Object.defineProperty(destination, 'innerHTML', {\n      enumerable: baseDescriptor.enumerable,\n      configurable: true,\n      get: baseDescriptor.get,\n      set: /** @this {Element} */ function(htmlString) {\n        const isConnected = Utilities.isConnected(this);\n\n        // NOTE: In IE11, when using the native `innerHTML` setter, all nodes\n        // that were previously descendants of the context element have all of\n        // their children removed as part of the set - the entire subtree is\n        // 'disassembled'. This work around walks the subtree *before* using the\n        // native setter.\n        /** @type {!Array<!Element>|undefined} */\n        let removedElements = undefined;\n        if (isConnected) {\n          removedElements = [];\n          Utilities.walkDeepDescendantElements(this, element => {\n            if (element !== this) {\n              removedElements.push(element);\n            }\n          });\n        }\n\n        baseDescriptor.set.call(this, htmlString);\n\n        if (removedElements) {\n          for (let i = 0; i < removedElements.length; i++) {\n            const element = removedElements[i];\n            if (element.__CE_state === CEState.custom) {\n              internals.disconnectedCallback(element);\n            }\n          }\n        }\n\n        // Only create custom elements if this element's owner document is\n        // associated with the registry.\n        if (!this.ownerDocument.__CE_hasRegistry) {\n          internals.patchTree(this);\n        } else {\n          internals.patchAndUpgradeTree(this);\n        }\n        return htmlString;\n      },\n    });\n  }\n\n  if (Native.Element_innerHTML && Native.Element_innerHTML.get) {\n    patch_innerHTML(Element.prototype, Native.Element_innerHTML);\n  } else if (Native.HTMLElement_innerHTML && Native.HTMLElement_innerHTML.get) {\n    patch_innerHTML(HTMLElement.prototype, Native.HTMLElement_innerHTML);\n  } else {\n\n    internals.addPatch(function(element) {\n      patch_innerHTML(element, {\n        enumerable: true,\n        configurable: true,\n        // Implements getting `innerHTML` by performing an unpatched `cloneNode`\n        // of the element and returning the resulting element's `innerHTML`.\n        // TODO: Is this too expensive?\n        get: /** @this {Element} */ function() {\n          return Native.Node_cloneNode.call(this, true).innerHTML;\n        },\n        // Implements setting `innerHTML` by creating an unpatched element,\n        // setting `innerHTML` of that element and replacing the target\n        // element's children with those of the unpatched element.\n        set: /** @this {Element} */ function(assignedValue) {\n          // NOTE: re-route to `content` for `template` elements.\n          // We need to do this because `template.appendChild` does not\n          // route into `template.content`.\n          const isTemplate = (this.localName === 'template');\n          /** @type {!Node} */\n          const content = isTemplate ? (/** @type {!HTMLTemplateElement} */\n            (this)).content : this;\n          /** @type {!Node} */\n          const rawElement = Native.Document_createElementNS.call(document,\n              this.namespaceURI, this.localName);\n          rawElement.innerHTML = assignedValue;\n\n          while (content.childNodes.length > 0) {\n            Native.Node_removeChild.call(content, content.childNodes[0]);\n          }\n          const container = isTemplate ? rawElement.content : rawElement;\n          while (container.childNodes.length > 0) {\n            Native.Node_appendChild.call(content, container.childNodes[0]);\n          }\n        },\n      });\n    });\n  }\n\n\n  Utilities.setPropertyUnchecked(Element.prototype, 'setAttribute',\n    /**\n     * @this {Element}\n     * @param {string} name\n     * @param {string} newValue\n     */\n    function(name, newValue) {\n      // Fast path for non-custom elements.\n      if (this.__CE_state !== CEState.custom) {\n        return Native.Element_setAttribute.call(this, name, newValue);\n      }\n\n      const oldValue = Native.Element_getAttribute.call(this, name);\n      Native.Element_setAttribute.call(this, name, newValue);\n      newValue = Native.Element_getAttribute.call(this, name);\n      internals.attributeChangedCallback(this, name, oldValue, newValue, null);\n    });\n\n  Utilities.setPropertyUnchecked(Element.prototype, 'setAttributeNS',\n    /**\n     * @this {Element}\n     * @param {?string} namespace\n     * @param {string} name\n     * @param {string} newValue\n     */\n    function(namespace, name, newValue) {\n      // Fast path for non-custom elements.\n      if (this.__CE_state !== CEState.custom) {\n        return Native.Element_setAttributeNS.call(this, namespace, name, newValue);\n      }\n\n      const oldValue = Native.Element_getAttributeNS.call(this, namespace, name);\n      Native.Element_setAttributeNS.call(this, namespace, name, newValue);\n      newValue = Native.Element_getAttributeNS.call(this, namespace, name);\n      internals.attributeChangedCallback(this, name, oldValue, newValue, namespace);\n    });\n\n  Utilities.setPropertyUnchecked(Element.prototype, 'removeAttribute',\n    /**\n     * @this {Element}\n     * @param {string} name\n     */\n    function(name) {\n      // Fast path for non-custom elements.\n      if (this.__CE_state !== CEState.custom) {\n        return Native.Element_removeAttribute.call(this, name);\n      }\n\n      const oldValue = Native.Element_getAttribute.call(this, name);\n      Native.Element_removeAttribute.call(this, name);\n      if (oldValue !== null) {\n        internals.attributeChangedCallback(this, name, oldValue, null, null);\n      }\n    });\n\n  Utilities.setPropertyUnchecked(Element.prototype, 'removeAttributeNS',\n    /**\n     * @this {Element}\n     * @param {?string} namespace\n     * @param {string} name\n     */\n    function(namespace, name) {\n      // Fast path for non-custom elements.\n      if (this.__CE_state !== CEState.custom) {\n        return Native.Element_removeAttributeNS.call(this, namespace, name);\n      }\n\n      const oldValue = Native.Element_getAttributeNS.call(this, namespace, name);\n      Native.Element_removeAttributeNS.call(this, namespace, name);\n      // In older browsers, `Element#getAttributeNS` may return the empty string\n      // instead of null if the attribute does not exist. For details, see;\n      // https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNS#Notes\n      const newValue = Native.Element_getAttributeNS.call(this, namespace, name);\n      if (oldValue !== newValue) {\n        internals.attributeChangedCallback(this, name, oldValue, newValue, namespace);\n      }\n    });\n\n\n  function patch_insertAdjacentElement(destination, baseMethod) {\n    Utilities.setPropertyUnchecked(destination, 'insertAdjacentElement',\n      /**\n       * @this {Element}\n       * @param {string} position\n       * @param {!Element} element\n       * @return {?Element}\n       */\n      function(position, element) {\n        const wasConnected = Utilities.isConnected(element);\n        const insertedElement = /** @type {!Element} */\n          (baseMethod.call(this, position, element));\n\n        if (wasConnected) {\n          internals.disconnectTree(element);\n        }\n\n        if (Utilities.isConnected(insertedElement)) {\n          internals.connectTree(element);\n        }\n        return insertedElement;\n      });\n  }\n\n  if (Native.HTMLElement_insertAdjacentElement) {\n    patch_insertAdjacentElement(HTMLElement.prototype, Native.HTMLElement_insertAdjacentElement);\n  } else if (Native.Element_insertAdjacentElement) {\n    patch_insertAdjacentElement(Element.prototype, Native.Element_insertAdjacentElement);\n  } else {\n    console.warn('Custom Elements: `Element#insertAdjacentElement` was not patched.');\n  }\n\n\n  function patch_insertAdjacentHTML(destination, baseMethod) {\n    /**\n     * Patches and upgrades all nodes which are siblings between `start`\n     * (inclusive) and `end` (exclusive). If `end` is `null`, then all siblings\n     * following `start` will be patched and upgraded.\n     * @param {!Node} start\n     * @param {?Node} end\n     */\n    function upgradeNodesInRange(start, end) {\n      const nodes = [];\n      for (let node = start; node !== end; node = node.nextSibling) {\n        nodes.push(node);\n      }\n      for (let i = 0; i < nodes.length; i++) {\n        internals.patchAndUpgradeTree(nodes[i]);\n      }\n    }\n\n    Utilities.setPropertyUnchecked(destination, 'insertAdjacentHTML',\n      /**\n       * @this {Element}\n       * @param {string} position\n       * @param {string} text\n       */\n      function(position, text) {\n        position = position.toLowerCase();\n\n        if (position === \"beforebegin\") {\n          const marker = this.previousSibling;\n          baseMethod.call(this, position, text);\n          upgradeNodesInRange(marker || /** @type {!Node} */ (this.parentNode.firstChild), this);\n        } else if (position === \"afterbegin\") {\n          const marker = this.firstChild;\n          baseMethod.call(this, position, text);\n          upgradeNodesInRange(/** @type {!Node} */ (this.firstChild), marker);\n        } else if (position === \"beforeend\") {\n          const marker = this.lastChild;\n          baseMethod.call(this, position, text);\n          upgradeNodesInRange(marker || /** @type {!Node} */ (this.firstChild), null);\n        } else if (position === \"afterend\") {\n          const marker = this.nextSibling;\n          baseMethod.call(this, position, text);\n          upgradeNodesInRange(/** @type {!Node} */ (this.nextSibling), marker);\n        } else {\n          throw new SyntaxError(`The value provided (${String(position)}) is ` +\n            \"not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.\");\n        }\n      });\n  }\n\n  if (Native.HTMLElement_insertAdjacentHTML) {\n    patch_insertAdjacentHTML(HTMLElement.prototype, Native.HTMLElement_insertAdjacentHTML);\n  } else if (Native.Element_insertAdjacentHTML) {\n    patch_insertAdjacentHTML(Element.prototype, Native.Element_insertAdjacentHTML);\n  } else {\n    console.warn('Custom Elements: `Element#insertAdjacentHTML` was not patched.');\n  }\n\n\n  PatchParentNode(internals, Element.prototype, {\n    prepend: Native.Element_prepend,\n    append: Native.Element_append,\n  });\n\n  PatchChildNode(internals, Element.prototype, {\n    before: Native.Element_before,\n    after: Native.Element_after,\n    replaceWith: Native.Element_replaceWith,\n    remove: Native.Element_remove,\n  });\n};\n","/**\n * @license\n * Copyright (c) 2016 The Polymer Project Authors. All rights reserved.\n * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\n * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\n * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\n * Code distributed by Google as part of the polymer project is also\n * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n */\n\nimport CustomElementInternals from './CustomElementInternals.js';\nimport CustomElementRegistry from './CustomElementRegistry.js';\n\nimport PatchHTMLElement from './Patch/HTMLElement.js';\nimport PatchDocument from './Patch/Document.js';\nimport PatchDocumentFragment from './Patch/DocumentFragment.js';\nimport PatchNode from './Patch/Node.js';\nimport PatchElement from './Patch/Element.js';\n\nconst priorCustomElements = window['customElements'];\n\nif (!priorCustomElements ||\n     priorCustomElements['forcePolyfill'] ||\n     (typeof priorCustomElements['define'] != 'function') ||\n     (typeof priorCustomElements['get'] != 'function')) {\n  /** @type {!CustomElementInternals} */\n  const internals = new CustomElementInternals();\n\n  PatchHTMLElement(internals);\n  PatchDocument(internals);\n  PatchDocumentFragment(internals);\n  PatchNode(internals);\n  PatchElement(internals);\n\n  // The main document is always associated with the registry.\n  document.__CE_hasRegistry = true;\n\n  /** @type {!CustomElementRegistry} */\n  const customElements = new CustomElementRegistry(internals);\n\n  Object.defineProperty(window, 'customElements', {\n    configurable: true,\n    enumerable: true,\n    value: customElements,\n  });\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n/*\nExtremely simple css parser. Intended to be not more than what we need\nand definitely not necessarily correct =).\n*/\n\n'use strict';\n\n/** @unrestricted */\nclass StyleNode {\n  constructor() {\n    /** @type {number} */\n    this['start'] = 0;\n    /** @type {number} */\n    this['end'] = 0;\n    /** @type {StyleNode} */\n    this['previous'] = null;\n    /** @type {StyleNode} */\n    this['parent'] = null;\n    /** @type {Array<StyleNode>} */\n    this['rules'] = null;\n    /** @type {string} */\n    this['parsedCssText'] = '';\n    /** @type {string} */\n    this['cssText'] = '';\n    /** @type {boolean} */\n    this['atRule'] = false;\n    /** @type {number} */\n    this['type'] = 0;\n    /** @type {string} */\n    this['keyframesName'] = '';\n    /** @type {string} */\n    this['selector'] = '';\n    /** @type {string} */\n    this['parsedSelector'] = '';\n  }\n}\n\nexport {StyleNode}\n\n// given a string of css, return a simple rule tree\n/**\n * @param {string} text\n * @return {StyleNode}\n */\nexport function parse(text) {\n  text = clean(text);\n  return parseCss(lex(text), text);\n}\n\n// remove stuff we don't care about that may hinder parsing\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction clean(cssText) {\n  return cssText.replace(RX.comments, '').replace(RX.port, '');\n}\n\n// super simple {...} lexer that returns a node tree\n/**\n * @param {string} text\n * @return {StyleNode}\n */\nfunction lex(text) {\n  let root = new StyleNode();\n  root['start'] = 0;\n  root['end'] = text.length\n  let n = root;\n  for (let i = 0, l = text.length; i < l; i++) {\n    if (text[i] === OPEN_BRACE) {\n      if (!n['rules']) {\n        n['rules'] = [];\n      }\n      let p = n;\n      let previous = p['rules'][p['rules'].length - 1] || null;\n      n = new StyleNode();\n      n['start'] = i + 1;\n      n['parent'] = p;\n      n['previous'] = previous;\n      p['rules'].push(n);\n    } else if (text[i] === CLOSE_BRACE) {\n      n['end'] = i + 1;\n      n = n['parent'] || root;\n    }\n  }\n  return root;\n}\n\n// add selectors/cssText to node tree\n/**\n * @param {StyleNode} node\n * @param {string} text\n * @return {StyleNode}\n */\nfunction parseCss(node, text) {\n  let t = text.substring(node['start'], node['end'] - 1);\n  node['parsedCssText'] = node['cssText'] = t.trim();\n  if (node['parent']) {\n    let ss = node['previous'] ? node['previous']['end'] : node['parent']['start'];\n    t = text.substring(ss, node['start'] - 1);\n    t = _expandUnicodeEscapes(t);\n    t = t.replace(RX.multipleSpaces, ' ');\n    // TODO(sorvell): ad hoc; make selector include only after last ;\n    // helps with mixin syntax\n    t = t.substring(t.lastIndexOf(';') + 1);\n    let s = node['parsedSelector'] = node['selector'] = t.trim();\n    node['atRule'] = (s.indexOf(AT_START) === 0);\n    // note, support a subset of rule types...\n    if (node['atRule']) {\n      if (s.indexOf(MEDIA_START) === 0) {\n        node['type'] = types.MEDIA_RULE;\n      } else if (s.match(RX.keyframesRule)) {\n        node['type'] = types.KEYFRAMES_RULE;\n        node['keyframesName'] =\n          node['selector'].split(RX.multipleSpaces).pop();\n      }\n    } else {\n      if (s.indexOf(VAR_START) === 0) {\n        node['type'] = types.MIXIN_RULE;\n      } else {\n        node['type'] = types.STYLE_RULE;\n      }\n    }\n  }\n  let r$ = node['rules'];\n  if (r$) {\n    for (let i = 0, l = r$.length, r;\n      (i < l) && (r = r$[i]); i++) {\n      parseCss(r, text);\n    }\n  }\n  return node;\n}\n\n/**\n * conversion of sort unicode escapes with spaces like `\\33 ` (and longer) into\n * expanded form that doesn't require trailing space `\\000033`\n * @param {string} s\n * @return {string}\n */\nfunction _expandUnicodeEscapes(s) {\n  return s.replace(/\\\\([0-9a-f]{1,6})\\s/gi, function() {\n    let code = arguments[1],\n      repeat = 6 - code.length;\n    while (repeat--) {\n      code = '0' + code;\n    }\n    return '\\\\' + code;\n  });\n}\n\n/**\n * stringify parsed css.\n * @param {StyleNode} node\n * @param {boolean=} preserveProperties\n * @param {string=} text\n * @return {string}\n */\nexport function stringify(node, preserveProperties, text = '') {\n  // calc rule cssText\n  let cssText = '';\n  if (node['cssText'] || node['rules']) {\n    let r$ = node['rules'];\n    if (r$ && !_hasMixinRules(r$)) {\n      for (let i = 0, l = r$.length, r;\n        (i < l) && (r = r$[i]); i++) {\n        cssText = stringify(r, preserveProperties, cssText);\n      }\n    } else {\n      cssText = preserveProperties ? node['cssText'] :\n        removeCustomProps(node['cssText']);\n      cssText = cssText.trim();\n      if (cssText) {\n        cssText = '  ' + cssText + '\\n';\n      }\n    }\n  }\n  // emit rule if there is cssText\n  if (cssText) {\n    if (node['selector']) {\n      text += node['selector'] + ' ' + OPEN_BRACE + '\\n';\n    }\n    text += cssText;\n    if (node['selector']) {\n      text += CLOSE_BRACE + '\\n\\n';\n    }\n  }\n  return text;\n}\n\n/**\n * @param {Array<StyleNode>} rules\n * @return {boolean}\n */\nfunction _hasMixinRules(rules) {\n  let r = rules[0];\n  return Boolean(r) && Boolean(r['selector']) && r['selector'].indexOf(VAR_START) === 0;\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomProps(cssText) {\n  cssText = removeCustomPropAssignment(cssText);\n  return removeCustomPropApply(cssText);\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nexport function removeCustomPropAssignment(cssText) {\n  return cssText\n    .replace(RX.customProp, '')\n    .replace(RX.mixinProp, '');\n}\n\n/**\n * @param {string} cssText\n * @return {string}\n */\nfunction removeCustomPropApply(cssText) {\n  return cssText\n    .replace(RX.mixinApply, '')\n    .replace(RX.varApply, '');\n}\n\n/** @enum {number} */\nexport const types = {\n  STYLE_RULE: 1,\n  KEYFRAMES_RULE: 7,\n  MEDIA_RULE: 4,\n  MIXIN_RULE: 1000\n}\n\nconst OPEN_BRACE = '{';\nconst CLOSE_BRACE = '}';\n\n// helper regexp's\nconst RX = {\n  comments: /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//gim,\n  port: /@import[^;]*;/gim,\n  customProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\\n]|$)/gim,\n  mixinProp: /(?:^[^;\\-\\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\\n]|$)?/gim,\n  mixinApply: /@apply\\s*\\(?[^);]*\\)?\\s*(?:[;\\n]|$)?/gim,\n  varApply: /[^;:]*?:[^;]*?var\\([^;]*\\)(?:[;\\n]|$)?/gim,\n  keyframesRule: /^@[^\\s]*keyframes/,\n  multipleSpaces: /\\s+/g\n}\n\nconst VAR_START = '--';\nconst MEDIA_START = '@media';\nconst AT_START = '@';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nexport const nativeShadow = !(window['ShadyDOM'] && window['ShadyDOM']['inUse']);\nlet nativeCssVariables_;\n\n/**\n * @param {(ShadyCSSOptions | ShadyCSSInterface)=} settings\n */\nfunction calcCssVariables(settings) {\n  if (settings && settings['shimcssproperties']) {\n    nativeCssVariables_ = false;\n  } else {\n    // chrome 49 has semi-working css vars, check if box-shadow works\n    // safari 9.1 has a recalc bug: https://bugs.webkit.org/show_bug.cgi?id=155782\n    // However, shim css custom properties are only supported with ShadyDOM enabled,\n    // so fall back on native if we do not detect ShadyDOM\n    // Edge 15: custom properties used in ::before and ::after will also be used in the parent element\n    // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12414257/\n    nativeCssVariables_ = nativeShadow || Boolean(!navigator.userAgent.match(/AppleWebKit\\/601|Edge\\/15/) &&\n      window.CSS && CSS.supports && CSS.supports('box-shadow', '0 0 0 var(--foo)'));\n  }\n}\n\n/** @type {string | undefined} */\nexport let cssBuild;\nif (window.ShadyCSS && window.ShadyCSS.cssBuild !== undefined) {\n  cssBuild = window.ShadyCSS.cssBuild;\n}\n\n/** @type {boolean} */\nexport const disableRuntime = Boolean(window.ShadyCSS && window.ShadyCSS.disableRuntime);\n\nif (window.ShadyCSS && window.ShadyCSS.nativeCss !== undefined) {\n  nativeCssVariables_ = window.ShadyCSS.nativeCss;\n} else if (window.ShadyCSS) {\n  calcCssVariables(window.ShadyCSS);\n  // reset window variable to let ShadyCSS API take its place\n  window.ShadyCSS = undefined;\n} else {\n  calcCssVariables(window['WebComponents'] && window['WebComponents']['flags']);\n}\n\n// Hack for type error under new type inference which doesn't like that\n// nativeCssVariables is updated in a function and assigns the type\n// `function(): ?` instead of `boolean`.\nexport const nativeCssVariables = /** @type {boolean} */(nativeCssVariables_);","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\nexport const VAR_ASSIGN = /(?:^|[;\\s{]\\s*)(--[\\w-]*?)\\s*:\\s*(?:((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^)]*?\\)|[^};{])+)|\\{([^}]*)\\}(?:(?=[;\\s}])|$))/gi;\nexport const MIXIN_MATCH = /(?:^|\\W+)@apply\\s*\\(?([^);\\n]*)\\)?/gi;\nexport const VAR_CONSUMED = /(--[\\w-]+)\\s*([:,;)]|$)/gi;\nexport const ANIMATION_MATCH = /(animation\\s*:)|(animation-name\\s*:)/;\nexport const MEDIA_MATCH = /@media\\s(.*)/;\nexport const IS_VAR = /^--/;\nexport const BRACKETED = /\\{[^}]*\\}/g;\nexport const HOST_PREFIX = '(?:^|[^.#[:])';\nexport const HOST_SUFFIX = '($|[.:[\\\\s>+~])';\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {!Set<string>} */\nconst styleTextSet = new Set();\n\nexport const scopingAttribute = 'shady-unscoped';\n\n/**\n * Add a specifically-marked style to the document directly, and only one copy of that style.\n *\n * @param {!HTMLStyleElement} style\n * @return {undefined}\n */\nexport function processUnscopedStyle(style) {\n  const text = style.textContent;\n  if (!styleTextSet.has(text)) {\n    styleTextSet.add(text);\n    const newStyle = style.cloneNode(true);\n    document.head.appendChild(newStyle);\n  }\n}\n\n/**\n * Check if a style is supposed to be unscoped\n * @param {!HTMLStyleElement} style\n * @return {boolean} true if the style has the unscoping attribute\n */\nexport function isUnscopedStyle(style) {\n  return style.hasAttribute(scopingAttribute);\n}","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow, nativeCssVariables, cssBuild} from './style-settings.js';\nimport {parse, stringify, types, StyleNode} from './css-parse.js'; // eslint-disable-line no-unused-vars\nimport {MEDIA_MATCH} from './common-regex.js';\nimport {processUnscopedStyle, isUnscopedStyle} from './unscoped-style-handler.js';\n\n/**\n * @param {string|StyleNode} rules\n * @param {function(StyleNode)=} callback\n * @return {string}\n */\nexport function toCssText (rules, callback) {\n  if (!rules) {\n    return '';\n  }\n  if (typeof rules === 'string') {\n    rules = parse(rules);\n  }\n  if (callback) {\n    forEachRule(rules, callback);\n  }\n  return stringify(rules, nativeCssVariables);\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @return {StyleNode}\n */\nexport function rulesForStyle(style) {\n  if (!style['__cssRules'] && style.textContent) {\n    style['__cssRules'] = parse(style.textContent);\n  }\n  return style['__cssRules'] || null;\n}\n\n// Tests if a rule is a keyframes selector, which looks almost exactly\n// like a normal selector but is not (it has nothing to do with scoping\n// for example).\n/**\n * @param {StyleNode} rule\n * @return {boolean}\n */\nexport function isKeyframesSelector(rule) {\n  return Boolean(rule['parent']) &&\n  rule['parent']['type'] === types.KEYFRAMES_RULE;\n}\n\n/**\n * @param {StyleNode} node\n * @param {Function=} styleRuleCallback\n * @param {Function=} keyframesRuleCallback\n * @param {boolean=} onlyActiveRules\n */\nexport function forEachRule(node, styleRuleCallback, keyframesRuleCallback, onlyActiveRules) {\n  if (!node) {\n    return;\n  }\n  let skipRules = false;\n  let type = node['type'];\n  if (onlyActiveRules) {\n    if (type === types.MEDIA_RULE) {\n      let matchMedia = node['selector'].match(MEDIA_MATCH);\n      if (matchMedia) {\n        // if rule is a non matching @media rule, skip subrules\n        if (!window.matchMedia(matchMedia[1]).matches) {\n          skipRules = true;\n        }\n      }\n    }\n  }\n  if (type === types.STYLE_RULE) {\n    styleRuleCallback(node);\n  } else if (keyframesRuleCallback &&\n    type === types.KEYFRAMES_RULE) {\n    keyframesRuleCallback(node);\n  } else if (type === types.MIXIN_RULE) {\n    skipRules = true;\n  }\n  let r$ = node['rules'];\n  if (r$ && !skipRules) {\n    for (let i=0, l=r$.length, r; (i<l) && (r=r$[i]); i++) {\n      forEachRule(r, styleRuleCallback, keyframesRuleCallback, onlyActiveRules);\n    }\n  }\n}\n\n// add a string of cssText to the document.\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @param {Node} target\n * @param {Node} contextNode\n * @return {HTMLStyleElement}\n */\nexport function applyCss(cssText, moniker, target, contextNode) {\n  let style = createScopeStyle(cssText, moniker);\n  applyStyle(style, target, contextNode);\n  return style;\n}\n\n/**\n * @param {string} cssText\n * @param {string} moniker\n * @return {HTMLStyleElement}\n */\nexport function createScopeStyle(cssText, moniker) {\n  let style = /** @type {HTMLStyleElement} */(document.createElement('style'));\n  if (moniker) {\n    style.setAttribute('scope', moniker);\n  }\n  style.textContent = cssText;\n  return style;\n}\n\n/**\n * Track the position of the last added style for placing placeholders\n * @type {Node}\n */\nlet lastHeadApplyNode = null;\n\n// insert a comment node as a styling position placeholder.\n/**\n * @param {string} moniker\n * @return {!Comment}\n */\nexport function applyStylePlaceHolder(moniker) {\n  let placeHolder = document.createComment(' Shady DOM styles for ' +\n    moniker + ' ');\n  let after = lastHeadApplyNode ?\n    lastHeadApplyNode['nextSibling'] : null;\n  let scope = document.head;\n  scope.insertBefore(placeHolder, after || scope.firstChild);\n  lastHeadApplyNode = placeHolder;\n  return placeHolder;\n}\n\n/**\n * @param {HTMLStyleElement} style\n * @param {?Node} target\n * @param {?Node} contextNode\n */\nexport function applyStyle(style, target, contextNode) {\n  target = target || document.head;\n  let after = (contextNode && contextNode.nextSibling) ||\n    target.firstChild;\n  target.insertBefore(style, after);\n  if (!lastHeadApplyNode) {\n    lastHeadApplyNode = style;\n  } else {\n    // only update lastHeadApplyNode if the new style is inserted after the old lastHeadApplyNode\n    let position = style.compareDocumentPosition(lastHeadApplyNode);\n    if (position === Node.DOCUMENT_POSITION_PRECEDING) {\n      lastHeadApplyNode = style;\n    }\n  }\n}\n\n/**\n * @param {string} buildType\n * @return {boolean}\n */\nexport function isTargetedBuild(buildType) {\n  return nativeShadow ? buildType === 'shadow' : buildType === 'shady';\n}\n\n/**\n * Walk from text[start] matching parens and\n * returns position of the outer end paren\n * @param {string} text\n * @param {number} start\n * @return {number}\n */\nexport function findMatchingParen(text, start) {\n  let level = 0;\n  for (let i=start, l=text.length; i < l; i++) {\n    if (text[i] === '(') {\n      level++;\n    } else if (text[i] === ')') {\n      if (--level === 0) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * @param {string} str\n * @param {function(string, string, string, string)} callback\n */\nexport function processVariableAndFallback(str, callback) {\n  // find 'var('\n  let start = str.indexOf('var(');\n  if (start === -1) {\n    // no var?, everything is prefix\n    return callback(str, '', '', '');\n  }\n  //${prefix}var(${inner})${suffix}\n  let end = findMatchingParen(str, start + 3);\n  let inner = str.substring(start + 4, end);\n  let prefix = str.substring(0, start);\n  // suffix may have other variables\n  let suffix = processVariableAndFallback(str.substring(end + 1), callback);\n  let comma = inner.indexOf(',');\n  // value and fallback args should be trimmed to match in property lookup\n  if (comma === -1) {\n    // variable, no fallback\n    return callback(prefix, inner.trim(), '', suffix);\n  }\n  // var(${value},${fallback})\n  let value = inner.substring(0, comma).trim();\n  let fallback = inner.substring(comma + 1).trim();\n  return callback(prefix, value, fallback, suffix);\n}\n\n/**\n * @param {Element} element\n * @param {string} value\n */\nexport function setElementClassRaw(element, value) {\n  // use native setAttribute provided by ShadyDOM when setAttribute is patched\n  if (nativeShadow) {\n    element.setAttribute('class', value);\n  } else {\n    window['ShadyDOM']['nativeMethods']['setAttribute'].call(element, 'class', value);\n  }\n}\n\n/**\n * @type {function(*):*}\n */\nexport const wrap = window['ShadyDOM'] && window['ShadyDOM']['wrap'] || ((node) => node);\n\n/**\n * @param {Element | {is: string, extends: string}} element\n * @return {{is: string, typeExtension: string}}\n */\nexport function getIsExtends(element) {\n  let localName = element['localName'];\n  let is = '', typeExtension = '';\n  /*\n  NOTE: technically, this can be wrong for certain svg elements\n  with `-` in the name like `<font-face>`\n  */\n  if (localName) {\n    if (localName.indexOf('-') > -1) {\n      is = localName;\n    } else {\n      typeExtension = localName;\n      is = (element.getAttribute && element.getAttribute('is')) || '';\n    }\n  } else {\n    is = /** @type {?} */(element).is;\n    typeExtension = /** @type {?} */(element).extends;\n  }\n  return {is, typeExtension};\n}\n\n/**\n * @param {Element|DocumentFragment} element\n * @return {string}\n */\nexport function gatherStyleText(element) {\n  /** @type {!Array<string>} */\n  const styleTextParts = [];\n  const styles = /** @type {!NodeList<!HTMLStyleElement>} */(element.querySelectorAll('style'));\n  for (let i = 0; i < styles.length; i++) {\n    const style = styles[i];\n    if (isUnscopedStyle(style)) {\n      if (!nativeShadow) {\n        processUnscopedStyle(style);\n        style.parentNode.removeChild(style);\n      }\n    } else {\n      styleTextParts.push(style.textContent);\n      style.parentNode.removeChild(style);\n    }\n  }\n  return styleTextParts.join('').trim();\n}\n\n/**\n * Split a selector separated by commas into an array in a smart way\n * @param {string} selector\n * @return {!Array<string>}\n */\nexport function splitSelectorList(selector) {\n  const parts = [];\n  let part = '';\n  for (let i = 0; i >= 0 && i < selector.length; i++) {\n    // A selector with parentheses will be one complete part\n    if (selector[i] === '(') {\n      // find the matching paren\n      const end = findMatchingParen(selector, i);\n      // push the paren block into the part\n      part += selector.slice(i, end + 1);\n      // move the index to after the paren block\n      i = end;\n    } else if (selector[i] === ',') {\n      parts.push(part);\n      part = '';\n    } else {\n      part += selector[i];\n    }\n  }\n  // catch any pieces after the last comma\n  if (part) {\n    parts.push(part);\n  }\n  return parts;\n}\n\nconst CSS_BUILD_ATTR = 'css-build';\n\n/**\n * Return the polymer-css-build \"build type\" applied to this element\n *\n * @param {!HTMLElement} element\n * @return {string} Can be \"\", \"shady\", or \"shadow\"\n */\nexport function getCssBuild(element) {\n  if (cssBuild !== undefined) {\n    return /** @type {string} */(cssBuild);\n  }\n  if (element.__cssBuild === undefined) {\n    // try attribute first, as it is the common case\n    const attrValue = element.getAttribute(CSS_BUILD_ATTR);\n    if (attrValue) {\n      element.__cssBuild = attrValue;\n    } else {\n      const buildComment = getBuildComment(element);\n      if (buildComment !== '') {\n        // remove build comment so it is not needlessly copied into every element instance\n        removeBuildComment(element);\n      }\n      element.__cssBuild = buildComment;\n    }\n  }\n  return element.__cssBuild || '';\n}\n\n/**\n * Check if the given element, either a <template> or <style>, has been processed\n * by polymer-css-build.\n *\n * If so, then we can make a number of optimizations:\n * - polymer-css-build will decompose mixins into individual CSS Custom Properties,\n * so the ApplyShim can be skipped entirely.\n * - Under native ShadowDOM, the style text can just be copied into each instance\n * without modification\n * - If the build is \"shady\" and ShadyDOM is in use, the styling does not need\n * scoping beyond the shimming of CSS Custom Properties\n *\n * @param {!HTMLElement} element\n * @return {boolean}\n */\nexport function elementHasBuiltCss(element) {\n  return getCssBuild(element) !== '';\n}\n\n/**\n * For templates made with tagged template literals, polymer-css-build will\n * insert a comment of the form `<!--css-build:shadow-->`\n *\n * @param {!HTMLElement} element\n * @return {string}\n */\nexport function getBuildComment(element) {\n  const buildComment = element.localName === 'template' ?\n      /** @type {!HTMLTemplateElement} */ (element).content.firstChild :\n      element.firstChild;\n  if (buildComment instanceof Comment) {\n    const commentParts = buildComment.textContent.trim().split(':');\n    if (commentParts[0] === CSS_BUILD_ATTR) {\n      return commentParts[1];\n    }\n  }\n  return '';\n}\n\n/**\n * Check if the css build status is optimal, and do no unneeded work.\n *\n * @param {string=} cssBuild CSS build status\n * @return {boolean} css build is optimal or not\n */\nexport function isOptimalCssBuild(cssBuild = '') {\n  // CSS custom property shim always requires work\n  if (cssBuild === '' || !nativeCssVariables) {\n    return false;\n  }\n  return nativeShadow ? cssBuild === 'shadow' : cssBuild === 'shady';\n}\n\n/**\n * @param {!HTMLElement} element\n */\nfunction removeBuildComment(element) {\n  const buildComment = element.localName === 'template' ?\n      /** @type {!HTMLTemplateElement} */ (element).content.firstChild :\n      element.firstChild;\n  buildComment.parentNode.removeChild(buildComment);\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line no-unused-vars\nimport * as StyleUtil from './style-util.js';\nimport {nativeShadow} from './style-settings.js';\n\n/* Transforms ShadowDOM styling into ShadyDOM styling\n\n* scoping:\n\n  * elements in scope get scoping selector class=\"x-foo-scope\"\n  * selectors re-written as follows:\n\n    div button -> div.x-foo-scope button.x-foo-scope\n\n* :host -> scopeName\n\n* :host(...) -> scopeName...\n\n* ::slotted(...) -> scopeName > ...\n\n* ...:dir(ltr|rtl) -> [dir=\"ltr|rtl\"] ..., ...[dir=\"ltr|rtl\"]\n\n* :host(:dir[rtl]) -> scopeName:dir(rtl) -> [dir=\"rtl\"] scopeName, scopeName[dir=\"rtl\"]\n\n*/\nconst SCOPE_NAME = 'style-scope';\n\nclass StyleTransformer {\n  get SCOPE_NAME() {\n    return SCOPE_NAME;\n  }\n  /**\n   * Given a node and scope name, add a scoping class to each node\n   * in the tree. This facilitates transforming css into scoped rules.\n   * @param {!Node} node\n   * @param {string} scope\n   * @param {boolean=} shouldRemoveScope\n   * @deprecated\n   */\n  dom(node, scope, shouldRemoveScope) {\n    const fn = (node) => {\n      this.element(node, scope || '', shouldRemoveScope);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * Given a node and scope name, add a scoping class to each node in the tree.\n   * @param {!Node} node\n   * @param {string} scope\n   */\n  domAddScope(node, scope) {\n    const fn = (node) => {\n      this.element(node, scope || '');\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {!Node} startNode\n   * @param {!function(!Node)} transformer\n   */\n  _transformDom(startNode, transformer) {\n    if (startNode.nodeType === Node.ELEMENT_NODE) {\n      transformer(startNode)\n    }\n    let c$;\n    if (startNode.localName === 'template') {\n      const template = /** @type {!HTMLTemplateElement} */ (startNode);\n      // In case the template is in svg context, fall back to the node\n      // since it won't be an HTMLTemplateElement with a .content property\n      c$ = (template.content || template._content || template).childNodes;\n    } else {\n      c$ = /** @type {!ParentNode} */ (startNode).children ||\n          startNode.childNodes;\n    }\n    if (c$) {\n      for (let i = 0; i < c$.length; i++) {\n        this._transformDom(c$[i], transformer);\n      }\n    }\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} scope\n   * @param {?=} shouldRemoveScope\n   */\n  element(element, scope, shouldRemoveScope) {\n    // note: if using classes, we add both the general 'style-scope' class\n    // as well as the specific scope. This enables easy filtering of all\n    // `style-scope` elements\n    if (scope) {\n      // note: svg on IE does not have classList so fallback to class\n      if (element.classList) {\n        if (shouldRemoveScope) {\n          element.classList.remove(SCOPE_NAME);\n          element.classList.remove(scope);\n        } else {\n          element.classList.add(SCOPE_NAME);\n          element.classList.add(scope);\n        }\n      } else if (element.getAttribute) {\n        let c = element.getAttribute(CLASS);\n        if (shouldRemoveScope) {\n          if (c) {\n            let newValue = c.replace(SCOPE_NAME, '').replace(scope, '');\n            StyleUtil.setElementClassRaw(element, newValue);\n          }\n        } else {\n          let newValue = (c ? c + ' ' : '') + SCOPE_NAME + ' ' + scope;\n          StyleUtil.setElementClassRaw(element, newValue);\n        }\n      }\n    }\n  }\n\n  /**\n   * Given a node, replace the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   * @param {string} newScope\n   */\n  domReplaceScope(node, oldScope, newScope) {\n    const fn = (node) => {\n      this.element(node, oldScope, true);\n      this.element(node, newScope);\n    };\n    this._transformDom(node, fn);\n  }\n  /**\n   * Given a node, remove the scoping class to each subnode in the tree.\n   * @param {!Node} node\n   * @param {string} oldScope\n   */\n  domRemoveScope(node, oldScope) {\n    const fn = (node) => {\n      this.element(node, oldScope || '', true);\n    };\n    this._transformDom(node, fn);\n  }\n\n  /**\n   * @param {?} element\n   * @param {?} styleRules\n   * @param {?=} callback\n   * @param {string=} cssBuild\n   * @param {string=} cssText\n   * @return {string}\n   */\n  elementStyles(element, styleRules, callback, cssBuild = '', cssText = '') {\n    // no need to shim selectors if settings.useNativeShadow, also\n    // a shady css build will already have transformed selectors\n    // NOTE: This method may be called as part of static or property shimming.\n    // When there is a targeted build it will not be called for static shimming,\n    // but when the property shim is used it is called and should opt out of\n    // static shimming work when a proper build exists.\n    if (cssText === '') {\n      if (nativeShadow || cssBuild === 'shady') {\n        cssText = StyleUtil.toCssText(styleRules, callback);\n      } else {\n        let {is, typeExtension} = StyleUtil.getIsExtends(element);\n        cssText = this.css(styleRules, is, typeExtension, callback) + '\\n\\n';\n      }\n    }\n    return cssText.trim();\n  }\n\n  // Given a string of cssText and a scoping string (scope), returns\n  // a string of scoped css where each selector is transformed to include\n  // a class created from the scope. ShadowDOM selectors are also transformed\n  // (e.g. :host) to use the scoping selector.\n  css(rules, scope, ext, callback) {\n    let hostScope = this._calcHostScope(scope, ext);\n    scope = this._calcElementScope(scope);\n    let self = this;\n    return StyleUtil.toCssText(rules, function(/** StyleNode */rule) {\n      if (!rule.isScoped) {\n        self.rule(rule, scope, hostScope);\n        rule.isScoped = true;\n      }\n      if (callback) {\n        callback(rule, scope, hostScope);\n      }\n    });\n  }\n\n  _calcElementScope(scope) {\n    if (scope) {\n      return CSS_CLASS_PREFIX + scope;\n    } else {\n      return '';\n    }\n  }\n\n  _calcHostScope(scope, ext) {\n    return ext ? `[is=${scope}]` : scope;\n  }\n\n  rule(rule, scope, hostScope) {\n    this._transformRule(rule, this._transformComplexSelector,\n      scope, hostScope);\n  }\n\n  /**\n   * transforms a css rule to a scoped rule.\n   *\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRule(rule, transformer, scope, hostScope) {\n    // NOTE: save transformedSelector for subsequent matching of elements\n    // against selectors (e.g. when calculating style properties)\n    rule['selector'] = rule.transformedSelector =\n      this._transformRuleCss(rule, transformer, scope, hostScope);\n  }\n\n  /**\n   * @param {StyleNode} rule\n   * @param {Function} transformer\n   * @param {string=} scope\n   * @param {string=} hostScope\n   */\n  _transformRuleCss(rule, transformer, scope, hostScope) {\n    let p$ = StyleUtil.splitSelectorList(rule['selector']);\n    // we want to skip transformation of rules that appear in keyframes,\n    // because they are keyframe selectors, not element selectors.\n    if (!StyleUtil.isKeyframesSelector(rule)) {\n      for (let i=0, l=p$.length, p; (i<l) && (p=p$[i]); i++) {\n        p$[i] = transformer.call(this, p, scope, hostScope);\n      }\n    }\n    return p$.filter((part) => Boolean(part)).join(COMPLEX_SELECTOR_SEP);\n  }\n\n  /**\n   * @param {string} selector\n   * @return {string}\n   */\n  _twiddleNthPlus(selector) {\n    return selector.replace(NTH, (m, type, inside) => {\n      if (inside.indexOf('+') > -1) {\n        inside = inside.replace(/\\+/g, '___');\n      } else if (inside.indexOf('___') > -1) {\n        inside = inside.replace(/___/g, '+');\n      }\n      return `:${type}(${inside})`;\n    });\n  }\n\n  /**\n   * Preserve `:matches()` selectors by replacing them with MATCHES_REPLACMENT\n   * and returning an array of `:matches()` selectors.\n   * Use `_replacesMatchesPseudo` to replace the `:matches()` parts\n   *\n   * @param {string} selector\n   * @return {{selector: string, matches: !Array<string>}}\n   */\n  _preserveMatchesPseudo(selector) {\n    /** @type {!Array<string>} */\n    const matches = [];\n    let match;\n    while ((match = selector.match(MATCHES))) {\n      const start = match.index;\n      const end = StyleUtil.findMatchingParen(selector, start);\n      if (end === -1) {\n        throw new Error(`${match.input} selector missing ')'`)\n      }\n      const part = selector.slice(start, end + 1);\n      selector = selector.replace(part, MATCHES_REPLACEMENT);\n      matches.push(part);\n    }\n    return {selector, matches};\n  }\n\n  /**\n   * Replace MATCHES_REPLACMENT character with the given set of `:matches()`\n   * selectors.\n   *\n   * @param {string} selector\n   * @param {!Array<string>} matches\n   * @return {string}\n   */\n  _replaceMatchesPseudo(selector, matches) {\n    const parts = selector.split(MATCHES_REPLACEMENT);\n    return matches.reduce((acc, cur, idx) => acc + cur + parts[idx + 1], parts[0]);\n  }\n\n/**\n * @param {string} selector\n * @param {string} scope\n * @param {string=} hostScope\n */\n  _transformComplexSelector(selector, scope, hostScope) {\n    let stop = false;\n    selector = selector.trim();\n    // Remove spaces inside of selectors like `:nth-of-type` because it confuses SIMPLE_SELECTOR_SEP\n    let isNth = NTH.test(selector);\n    if (isNth) {\n      selector = selector.replace(NTH, (m, type, inner) => `:${type}(${inner.replace(/\\s/g, '')})`)\n      selector = this._twiddleNthPlus(selector);\n    }\n    // Preserve selectors like `:-webkit-any` so that SIMPLE_SELECTOR_SEP does\n    // not get confused by spaces inside the pseudo selector\n    const isMatches = MATCHES.test(selector);\n    /** @type {!Array<string>} */\n    let matches;\n    if (isMatches) {\n      ({selector, matches} = this._preserveMatchesPseudo(selector));\n    }\n    selector = selector.replace(SLOTTED_START, `${HOST} $1`);\n    selector = selector.replace(SIMPLE_SELECTOR_SEP, (m, c, s) => {\n      if (!stop) {\n        let info = this._transformCompoundSelector(s, c, scope, hostScope);\n        stop = stop || info.stop;\n        c = info.combinator;\n        s = info.value;\n      }\n      return c + s;\n    });\n    // replace `:matches()` selectors\n    if (isMatches) {\n      selector = this._replaceMatchesPseudo(selector, matches);\n    }\n    if (isNth) {\n      selector = this._twiddleNthPlus(selector);\n    }\n    return selector;\n  }\n\n  _transformCompoundSelector(selector, combinator, scope, hostScope) {\n    // replace :host with host scoping class\n    let slottedIndex = selector.indexOf(SLOTTED);\n    if (selector.indexOf(HOST) >= 0) {\n      selector = this._transformHostSelector(selector, hostScope);\n    // replace other selectors with scoping class\n    } else if (slottedIndex !== 0) {\n      selector = scope ? this._transformSimpleSelector(selector, scope) :\n        selector;\n    }\n    // mark ::slotted() scope jump to replace with descendant selector + arg\n    // also ignore left-side combinator\n    let slotted = false;\n    if (slottedIndex >= 0) {\n      combinator = '';\n      slotted = true;\n    }\n    // process scope jumping selectors up to the scope jump and then stop\n    let stop;\n    if (slotted) {\n      stop = true;\n      if (slotted) {\n        // .zonk ::slotted(.foo) -> .zonk.scope > .foo\n        selector = selector.replace(SLOTTED_PAREN, (m, paren) => ` > ${paren}`);\n      }\n    }\n    selector = selector.replace(DIR_PAREN, (m, before, dir) =>\n      `[dir=\"${dir}\"] ${before}, ${before}[dir=\"${dir}\"]`);\n    return {value: selector, combinator, stop};\n  }\n\n  _transformSimpleSelector(selector, scope) {\n    const attributes = selector.split(/(\\[.+?\\])/);\n\n    const output = [];\n    for (let i = 0; i < attributes.length; i++) {\n      // Do not attempt to transform any attribute selector content\n      if ((i % 2) === 1) {\n        output.push(attributes[i]);\n      } else {\n        const part = attributes[i];\n\n        if (!(part === '' && i === attributes.length - 1)) {\n          let p$ = part.split(PSEUDO_PREFIX);\n          p$[0] += scope;\n          output.push(p$.join(PSEUDO_PREFIX));\n        }\n      }\n    }\n\n    return output.join('');\n  }\n\n  // :host(...) -> scopeName...\n  _transformHostSelector(selector, hostScope) {\n    let m = selector.match(HOST_PAREN);\n    let paren = m && m[2].trim() || '';\n    if (paren) {\n      if (!paren[0].match(SIMPLE_SELECTOR_PREFIX)) {\n        // paren starts with a type selector\n        let typeSelector = paren.split(SIMPLE_SELECTOR_PREFIX)[0];\n        // if the type selector is our hostScope then avoid pre-pending it\n        if (typeSelector === hostScope) {\n          return paren;\n        // otherwise, this selector should not match in this scope so\n        // output a bogus selector.\n        } else {\n          return SELECTOR_NO_MATCH;\n        }\n      } else {\n        // make sure to do a replace here to catch selectors like:\n        // `:host(.foo)::before`\n        return selector.replace(HOST_PAREN, function(m, host, paren) {\n          return hostScope + paren;\n        });\n      }\n    // if no paren, do a straight :host replacement.\n    // TODO(sorvell): this should not strictly be necessary but\n    // it's needed to maintain support for `:host[foo]` type selectors\n    // which have been improperly used under Shady DOM. This should be\n    // deprecated.\n    } else {\n      return selector.replace(HOST, hostScope);\n    }\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  documentRule(rule) {\n    // reset selector in case this is redone.\n    rule['selector'] = rule['parsedSelector'];\n    this.normalizeRootSelector(rule);\n    this._transformRule(rule, this._transformDocumentSelector);\n  }\n\n  /**\n   * @param {StyleNode} rule\n   */\n  normalizeRootSelector(rule) {\n    if (rule['selector'] === ROOT) {\n      rule['selector'] = 'html';\n    }\n  }\n\n/**\n * @param {string} selector\n */\n  _transformDocumentSelector(selector) {\n    if (selector.match(HOST)) {\n      // remove ':host' type selectors in document rules\n      return '';\n    } else if (selector.match(SLOTTED)) {\n      return this._transformComplexSelector(selector, SCOPE_DOC_SELECTOR)\n    } else {\n      return this._transformSimpleSelector(selector.trim(), SCOPE_DOC_SELECTOR);\n    }\n  }\n}\n\nconst NTH = /:(nth[-\\w]+)\\(([^)]+)\\)/;\nconst SCOPE_DOC_SELECTOR = `:not(.${SCOPE_NAME})`;\nconst COMPLEX_SELECTOR_SEP = ',';\nconst SIMPLE_SELECTOR_SEP = /(^|[\\s>+~]+)((?:\\[.+?\\]|[^\\s>+~=[])+)/g;\nconst SIMPLE_SELECTOR_PREFIX = /[[.:#*]/;\nconst HOST = ':host';\nconst ROOT = ':root';\nconst SLOTTED = '::slotted';\nconst SLOTTED_START = new RegExp(`^(${SLOTTED})`);\n// NOTE: this supports 1 nested () pair for things like\n// :host(:not([selected]), more general support requires\n// parsing which seems like overkill\nconst HOST_PAREN = /(:host)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\n// similar to HOST_PAREN\nconst SLOTTED_PAREN = /(?:::slotted)(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))/;\nconst DIR_PAREN = /(.*):dir\\((?:(ltr|rtl))\\)/;\nconst CSS_CLASS_PREFIX = '.';\nconst PSEUDO_PREFIX = ':';\nconst CLASS = 'class';\nconst SELECTOR_NO_MATCH = 'should_not_match';\nconst MATCHES = /:(?:matches|any|-(?:webkit|moz)-any)/;\nconst MATCHES_REPLACEMENT = '\\u{e000}';\n\nexport default new StyleTransformer()\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line no-unused-vars\n\n/** @const {string} */\nconst infoKey = '__styleInfo';\n\nexport default class StyleInfo {\n  /**\n   * @param {Element} node\n   * @return {StyleInfo}\n   */\n  static get(node) {\n    if (node) {\n      return node[infoKey];\n    } else {\n      return null;\n    }\n  }\n  /**\n   * @param {!Element} node\n   * @param {StyleInfo} styleInfo\n   * @return {StyleInfo}\n   */\n  static set(node, styleInfo) {\n    node[infoKey] = styleInfo;\n    return styleInfo;\n  }\n  /**\n   * @param {StyleNode} ast\n   * @param {Node=} placeholder\n   * @param {Array<string>=} ownStylePropertyNames\n   * @param {string=} elementName\n   * @param {string=} typeExtension\n   * @param {string=} cssBuild\n   */\n  constructor(ast, placeholder, ownStylePropertyNames, elementName, typeExtension, cssBuild) {\n    /** @type {StyleNode} */\n    this.styleRules = ast || null;\n    /** @type {Node} */\n    this.placeholder = placeholder || null;\n    /** @type {!Array<string>} */\n    this.ownStylePropertyNames = ownStylePropertyNames || [];\n    /** @type {Object} */\n    this.overrideStyleProperties = null;\n    /** @type {string} */\n    this.elementName = elementName || '';\n    /** @type {string} */\n    this.cssBuild = cssBuild || '';\n    /** @type {string} */\n    this.typeExtension = typeExtension || '';\n    /** @type {Object<string, string>} */\n    this.styleProperties = null;\n    /** @type {?string} */\n    this.scopeSelector = null;\n    /** @type {HTMLStyleElement} */\n    this.customStyle = null;\n  }\n  _getStyleRules() {\n    return this.styleRules;\n  }\n}\n\n/* eslint-disable-next-line no-self-assign */\nStyleInfo.prototype['_getStyleRules'] = StyleInfo.prototype._getStyleRules;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {removeCustomPropAssignment, StyleNode} from './css-parse.js'; // eslint-disable-line no-unused-vars\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport * as RX from './common-regex.js';\nimport StyleInfo from './style-info.js';\n\n// TODO: dedupe with shady\n/**\n * @param {string} selector\n * @return {boolean}\n * @this {Element}\n */\nconst matchesSelector = function(selector) {\n  const method = this.matches || this.matchesSelector ||\n    this.mozMatchesSelector || this.msMatchesSelector ||\n    this.oMatchesSelector || this.webkitMatchesSelector;\n  return method && method.call(this, selector);\n};\n\nconst IS_IE = navigator.userAgent.match('Trident');\n\nconst XSCOPE_NAME = 'x-scope';\n\nclass StyleProperties {\n  get XSCOPE_NAME() {\n    return XSCOPE_NAME;\n  }\n/**\n * decorates styles with rule info and returns an array of used style property names\n *\n * @param {StyleNode} rules\n * @return {Array<string>}\n */\n  decorateStyles(rules) {\n    let self = this, props = {}, keyframes = [], ruleIndex = 0;\n    StyleUtil.forEachRule(rules, function(rule) {\n      self.decorateRule(rule);\n      // mark in-order position of ast rule in styles block, used for cache key\n      rule.index = ruleIndex++;\n      self.collectPropertiesInCssText(rule.propertyInfo.cssText, props);\n    }, function onKeyframesRule(rule) {\n      keyframes.push(rule);\n    });\n    // Cache all found keyframes rules for later reference:\n    rules._keyframes = keyframes;\n    // return this list of property names *consumes* in these styles.\n    let names = [];\n    for (let i in props) {\n      names.push(i);\n    }\n    return names;\n  }\n\n  // decorate a single rule with property info\n  decorateRule(rule) {\n    if (rule.propertyInfo) {\n      return rule.propertyInfo;\n    }\n    let info = {}, properties = {};\n    let hasProperties = this.collectProperties(rule, properties);\n    if (hasProperties) {\n      info.properties = properties;\n      // TODO(sorvell): workaround parser seeing mixins as additional rules\n      rule['rules'] = null;\n    }\n    info.cssText = this.collectCssText(rule);\n    rule.propertyInfo = info;\n    return info;\n  }\n\n  // collects the custom properties from a rule's cssText\n  collectProperties(rule, properties) {\n    let info = rule.propertyInfo;\n    if (info) {\n      if (info.properties) {\n        Object.assign(properties, info.properties);\n        return true;\n      }\n    } else {\n      let m, rx = RX.VAR_ASSIGN;\n      let cssText = rule['parsedCssText'];\n      let value;\n      let any;\n      while ((m = rx.exec(cssText))) {\n        // note: group 2 is var, 3 is mixin\n        value = (m[2] || m[3]).trim();\n        // value of 'inherit' or 'unset' is equivalent to not setting the property here\n        if (value !== 'inherit' || value !== 'unset') {\n          properties[m[1].trim()] = value;\n        }\n        any = true;\n      }\n      return any;\n    }\n\n  }\n\n  // returns cssText of properties that consume variables/mixins\n  collectCssText(rule) {\n    return this.collectConsumingCssText(rule['parsedCssText']);\n  }\n\n  // NOTE: we support consumption inside mixin assignment\n  // but not production, so strip out {...}\n  collectConsumingCssText(cssText) {\n    return cssText.replace(RX.BRACKETED, '')\n      .replace(RX.VAR_ASSIGN, '');\n  }\n\n  collectPropertiesInCssText(cssText, props) {\n    let m;\n    while ((m = RX.VAR_CONSUMED.exec(cssText))) {\n      let name = m[1];\n      // This regex catches all variable names, and following non-whitespace char\n      // If next char is not ':', then variable is a consumer\n      if (m[2] !== ':') {\n        props[name] = true;\n      }\n    }\n  }\n\n  // turns custom properties into realized values.\n  reify(props) {\n    // big perf optimization here: reify only *own* properties\n    // since this object has __proto__ of the element's scope properties\n    let names = Object.getOwnPropertyNames(props);\n    for (let i=0, n; i < names.length; i++) {\n      n = names[i];\n      props[n] = this.valueForProperty(props[n], props);\n    }\n  }\n\n  // given a property value, returns the reified value\n  // a property value may be:\n  // (1) a literal value like: red or 5px;\n  // (2) a variable value like: var(--a), var(--a, red), or var(--a, --b) or\n  // var(--a, var(--b));\n  // (3) a literal mixin value like { properties }. Each of these properties\n  // can have values that are: (a) literal, (b) variables, (c) @apply mixins.\n  valueForProperty(property, props) {\n    // case (1) default\n    // case (3) defines a mixin and we have to reify the internals\n    if (property) {\n      if (property.indexOf(';') >=0) {\n        property = this.valueForProperties(property, props);\n      } else {\n        // case (2) variable\n        let self = this;\n        let fn = function(prefix, value, fallback, suffix) {\n          if (!value) {\n            return prefix + suffix;\n          }\n          let propertyValue = self.valueForProperty(props[value], props);\n          // if value is \"initial\", then the variable should be treated as unset\n          if (!propertyValue || propertyValue === 'initial') {\n            // fallback may be --a or var(--a) or literal\n            propertyValue = self.valueForProperty(props[fallback] || fallback, props) ||\n            fallback;\n          } else if (propertyValue === 'apply-shim-inherit') {\n            // CSS build will replace `inherit` with `apply-shim-inherit`\n            // for use with native css variables.\n            // Since we have full control, we can use `inherit` directly.\n            propertyValue = 'inherit';\n          }\n          return prefix + (propertyValue || '') + suffix;\n        };\n        property = StyleUtil.processVariableAndFallback(property, fn);\n      }\n    }\n    return property && property.trim() || '';\n  }\n\n  // note: we do not yet support mixin within mixin\n  valueForProperties(property, props) {\n    let parts = property.split(';');\n    for (let i=0, p, m; i<parts.length; i++) {\n      if ((p = parts[i])) {\n        RX.MIXIN_MATCH.lastIndex = 0;\n        m = RX.MIXIN_MATCH.exec(p);\n        if (m) {\n          p = this.valueForProperty(props[m[1]], props);\n        } else {\n          let colon = p.indexOf(':');\n          if (colon !== -1) {\n            let pp = p.substring(colon);\n            pp = pp.trim();\n            pp = this.valueForProperty(pp, props) || pp;\n            p = p.substring(0, colon) + pp;\n          }\n        }\n        parts[i] = (p && p.lastIndexOf(';') === p.length - 1) ?\n          // strip trailing ;\n          p.slice(0, -1) :\n          p || '';\n      }\n    }\n    return parts.join(';');\n  }\n\n  applyProperties(rule, props) {\n    let output = '';\n    // dynamically added sheets may not be decorated so ensure they are.\n    if (!rule.propertyInfo) {\n      this.decorateRule(rule);\n    }\n    if (rule.propertyInfo.cssText) {\n      output = this.valueForProperties(rule.propertyInfo.cssText, props);\n    }\n    rule['cssText'] = output;\n  }\n\n  // Apply keyframe transformations to the cssText of a given rule. The\n  // keyframeTransforms object is a map of keyframe names to transformer\n  // functions which take in cssText and spit out transformed cssText.\n  applyKeyframeTransforms(rule, keyframeTransforms) {\n    let input = rule['cssText'];\n    let output = rule['cssText'];\n    if (rule.hasAnimations == null) {\n      // Cache whether or not the rule has any animations to begin with:\n      rule.hasAnimations = RX.ANIMATION_MATCH.test(input);\n    }\n    // If there are no animations referenced, we can skip transforms:\n    if (rule.hasAnimations) {\n      let transform;\n      // If we haven't transformed this rule before, we iterate over all\n      // transforms:\n      if (rule.keyframeNamesToTransform == null) {\n        rule.keyframeNamesToTransform = [];\n        for (let keyframe in keyframeTransforms) {\n          transform = keyframeTransforms[keyframe];\n          output = transform(input);\n          // If the transform actually changed the CSS text, we cache the\n          // transform name for future use:\n          if (input !== output) {\n            input = output;\n            rule.keyframeNamesToTransform.push(keyframe);\n          }\n        }\n      } else {\n        // If we already have a list of keyframe names that apply to this\n        // rule, we apply only those keyframe name transforms:\n        for (let i = 0; i < rule.keyframeNamesToTransform.length; ++i) {\n          transform = keyframeTransforms[rule.keyframeNamesToTransform[i]];\n          input = transform(input);\n        }\n        output = input;\n      }\n    }\n    rule['cssText'] = output;\n  }\n\n  // Test if the rules in these styles matches the given `element` and if so,\n  // collect any custom properties into `props`.\n  /**\n   * @param {StyleNode} rules\n   * @param {Element} element\n   */\n  propertyDataFromStyles(rules, element) {\n    let props = {};\n    // generates a unique key for these matches\n    let o = [];\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(rules, (rule) => {\n      // TODO(sorvell): we could trim the set of rules at declaration\n      // time to only include ones that have properties\n      if (!rule.propertyInfo) {\n        this.decorateRule(rule);\n      }\n      // match element against transformedSelector: selector may contain\n      // unwanted uniquification and parsedSelector does not directly match\n      // for :host selectors.\n      let selectorToMatch = rule.transformedSelector || rule['parsedSelector'];\n      if (element && rule.propertyInfo.properties && selectorToMatch) {\n        if (matchesSelector.call(element, selectorToMatch)) {\n          this.collectProperties(rule, props);\n          // produce numeric key for these matches for lookup\n          addToBitMask(rule.index, o);\n        }\n      }\n    }, null, true);\n    return {properties: props, key: o};\n  }\n\n  /**\n   * @param {Element} scope\n   * @param {StyleNode} rule\n   * @param {string} cssBuild\n   * @param {function(Object)} callback\n   */\n  whenHostOrRootRule(scope, rule, cssBuild, callback) {\n    if (!rule.propertyInfo) {\n      this.decorateRule(rule);\n    }\n    if (!rule.propertyInfo.properties) {\n      return;\n    }\n    let {is, typeExtension} = StyleUtil.getIsExtends(scope);\n    let hostScope = is ?\n      StyleTransformer._calcHostScope(is, typeExtension) :\n      'html';\n    let parsedSelector = rule['parsedSelector'];\n    let isRoot = (parsedSelector === ':host > *' || parsedSelector === 'html');\n    let isHost = parsedSelector.indexOf(':host') === 0 && !isRoot;\n    // build info is either in scope (when scope is an element) or in the style\n    // when scope is the default scope; note: this allows default scope to have\n    // mixed mode built and unbuilt styles.\n    if (cssBuild === 'shady') {\n      // :root -> x-foo > *.x-foo for elements and html for custom-style\n      isRoot = parsedSelector === (hostScope + ' > *.' + hostScope) || parsedSelector.indexOf('html') !== -1;\n      // :host -> x-foo for elements, but sub-rules have .x-foo in them\n      isHost = !isRoot && parsedSelector.indexOf(hostScope) === 0;\n    }\n    if (!isRoot && !isHost) {\n      return;\n    }\n    let selectorToMatch = hostScope;\n    if (isHost) {\n      // need to transform :host because `:host` does not work with `matches`\n      if (!rule.transformedSelector) {\n        // transform :host into a matchable selector\n        rule.transformedSelector =\n        StyleTransformer._transformRuleCss(\n          rule,\n          StyleTransformer._transformComplexSelector,\n          StyleTransformer._calcElementScope(is),\n          hostScope\n        );\n      }\n      selectorToMatch = rule.transformedSelector || hostScope;\n    }\n    callback({\n      selector: selectorToMatch,\n      isHost: isHost,\n      isRoot: isRoot\n    });\n  }\n/**\n * @param {Element} scope\n * @param {StyleNode} rules\n * @param {string} cssBuild\n * @return {Object}\n */\n  hostAndRootPropertiesForScope(scope, rules, cssBuild) {\n    let hostProps = {}, rootProps = {};\n    // note: active rules excludes non-matching @media rules\n    StyleUtil.forEachRule(rules, (rule) => {\n      // if scope is StyleDefaults, use _element for matchesSelector\n      this.whenHostOrRootRule(scope, rule, cssBuild, (info) => {\n        let element = scope._element || scope;\n        if (matchesSelector.call(element, info.selector)) {\n          if (info.isHost) {\n            this.collectProperties(rule, hostProps);\n          } else {\n            this.collectProperties(rule, rootProps);\n          }\n        }\n      });\n    }, null, true);\n    return {rootProps: rootProps, hostProps: hostProps};\n  }\n\n  /**\n   * @param {Element} element\n   * @param {Object} properties\n   * @param {string} scopeSelector\n   */\n  transformStyles(element, properties, scopeSelector) {\n    let self = this;\n    let {is, typeExtension} = StyleUtil.getIsExtends(element);\n    let hostSelector = StyleTransformer\n      ._calcHostScope(is, typeExtension);\n    let rxHostSelector = element.extends ?\n      '\\\\' + hostSelector.slice(0, -1) + '\\\\]' :\n      hostSelector;\n    let hostRx = new RegExp(RX.HOST_PREFIX + rxHostSelector +\n      RX.HOST_SUFFIX);\n    let {styleRules: rules, cssBuild} = StyleInfo.get(element);\n    let keyframeTransforms =\n      this._elementKeyframeTransforms(element, rules, scopeSelector);\n    return StyleTransformer.elementStyles(element, rules, function(rule) {\n      self.applyProperties(rule, properties);\n      if (!nativeShadow &&\n          !StyleUtil.isKeyframesSelector(rule) &&\n          rule['cssText']) {\n        // NOTE: keyframe transforms only scope munge animation names, so it\n        // is not necessary to apply them in ShadowDOM.\n        self.applyKeyframeTransforms(rule, keyframeTransforms);\n        self._scopeSelector(rule, hostRx, hostSelector, scopeSelector);\n      }\n    }, cssBuild);\n  }\n\n  /**\n   * @param {Element} element\n   * @param {StyleNode} rules\n   * @param {string} scopeSelector\n   * @return {Object}\n   */\n  _elementKeyframeTransforms(element, rules, scopeSelector) {\n    let keyframesRules = rules._keyframes;\n    let keyframeTransforms = {};\n    if (!nativeShadow && keyframesRules) {\n      // For non-ShadowDOM, we transform all known keyframes rules in\n      // advance for the current scope. This allows us to catch keyframes\n      // rules that appear anywhere in the stylesheet:\n      for (let i = 0, keyframesRule = keyframesRules[i];\n           i < keyframesRules.length;\n           keyframesRule = keyframesRules[++i]) {\n        this._scopeKeyframes(keyframesRule, scopeSelector);\n        keyframeTransforms[keyframesRule['keyframesName']] =\n            this._keyframesRuleTransformer(keyframesRule);\n      }\n    }\n    return keyframeTransforms;\n  }\n\n  // Generate a factory for transforming a chunk of CSS text to handle a\n  // particular scoped keyframes rule.\n  /**\n   * @param {StyleNode} keyframesRule\n   * @return {function(string):string}\n   */\n  _keyframesRuleTransformer(keyframesRule) {\n    return function(cssText) {\n      return cssText.replace(\n          keyframesRule.keyframesNameRx,\n          keyframesRule.transformedKeyframesName);\n    };\n  }\n\n/**\n * Transforms `@keyframes` names to be unique for the current host.\n * Example: @keyframes foo-anim -> @keyframes foo-anim-x-foo-0\n *\n * @param {StyleNode} rule\n * @param {string} scopeId\n */\n  _scopeKeyframes(rule, scopeId) {\n    // Animation names are of the form [\\w-], so ensure that the name regex does not partially apply\n    // to similarly named keyframe names by checking for a word boundary at the beginning and\n    // a non-word boundary or `-` at the end.\n    rule.keyframesNameRx = new RegExp(`\\\\b${rule['keyframesName']}(?!\\\\B|-)`, 'g');\n    rule.transformedKeyframesName = rule['keyframesName'] + '-' + scopeId;\n    rule.transformedSelector = rule.transformedSelector || rule['selector'];\n    rule['selector'] = rule.transformedSelector.replace(\n        rule['keyframesName'], rule.transformedKeyframesName);\n  }\n\n  // Strategy: x scope shim a selector e.g. to scope `.x-foo-42` (via classes):\n  // non-host selector: .a.x-foo -> .x-foo-42 .a.x-foo\n  // host selector: x-foo.wide -> .x-foo-42.wide\n  // note: we use only the scope class (.x-foo-42) and not the hostSelector\n  // (x-foo) to scope :host rules; this helps make property host rules\n  // have low specificity. They are overrideable by class selectors but,\n  // unfortunately, not by type selectors (e.g. overriding via\n  // `.special` is ok, but not by `x-foo`).\n  /**\n   * @param {StyleNode} rule\n   * @param {RegExp} hostRx\n   * @param {string} hostSelector\n   * @param {string} scopeId\n   */\n  _scopeSelector(rule, hostRx, hostSelector, scopeId) {\n    rule.transformedSelector = rule.transformedSelector || rule['selector'];\n    let selector = rule.transformedSelector;\n    let scope = '.' + scopeId;\n    let parts = StyleUtil.splitSelectorList(selector);\n    for (let i=0, l=parts.length, p; (i<l) && (p=parts[i]); i++) {\n      parts[i] = p.match(hostRx) ?\n        p.replace(hostSelector, scope) :\n        scope + ' ' + p;\n    }\n    rule['selector'] = parts.join(',');\n  }\n\n  /**\n   * @param {Element} element\n   * @param {string} selector\n   * @param {string} old\n   */\n  applyElementScopeSelector(element, selector, old) {\n    let c = element.getAttribute('class') || '';\n    let v = c;\n    if (old) {\n      v = c.replace(\n        new RegExp('\\\\s*' + XSCOPE_NAME + '\\\\s*' + old + '\\\\s*', 'g'), ' ');\n    }\n    v += (v ? ' ' : '') + XSCOPE_NAME + ' ' + selector;\n    if (c !== v) {\n      StyleUtil.setElementClassRaw(element, v);\n    }\n  }\n\n  /**\n   * @param {HTMLElement} element\n   * @param {Object} properties\n   * @param {string} selector\n   * @param {HTMLStyleElement} style\n   * @return {HTMLStyleElement}\n   */\n  applyElementStyle(element, properties, selector, style) {\n    // calculate cssText to apply\n    let cssText = style ? style.textContent || '' :\n      this.transformStyles(element, properties, selector);\n    // if shady and we have a cached style that is not style, decrement\n    let styleInfo = StyleInfo.get(element);\n    let s = styleInfo.customStyle;\n    if (s && !nativeShadow && (s !== style)) {\n      s['_useCount']--;\n      if (s['_useCount'] <= 0 && s.parentNode) {\n        s.parentNode.removeChild(s);\n      }\n    }\n    // apply styling always under native or if we generated style\n    // or the cached style is not in document(!)\n    if (nativeShadow) {\n      // update existing style only under native\n      if (styleInfo.customStyle) {\n        styleInfo.customStyle.textContent = cssText;\n        style = styleInfo.customStyle;\n      // otherwise, if we have css to apply, do so\n      } else if (cssText) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        style = StyleUtil.applyCss(cssText, selector, element.shadowRoot,\n          styleInfo.placeholder);\n      }\n    } else {\n      // shady and no cache hit\n      if (!style) {\n        // apply css after the scope style of the element to help with\n        // style precedence rules.\n        if (cssText) {\n          style = StyleUtil.applyCss(cssText, selector, null,\n            styleInfo.placeholder);\n        }\n      // shady and cache hit but not in document\n      } else if (!style.parentNode) {\n        if (IS_IE && cssText.indexOf('@media') > -1) {\n            // @media rules may be stale in IE 10 and 11\n            // refresh the text content of the style to revalidate them.\n          style.textContent = cssText;\n        }\n        StyleUtil.applyStyle(style, null, styleInfo.placeholder);\n      }\n    }\n    // ensure this style is our custom style and increment its use count.\n    if (style) {\n      style['_useCount'] = style['_useCount'] || 0;\n      // increment use count if we changed styles\n      if (styleInfo.customStyle != style) {\n        style['_useCount']++;\n      }\n      styleInfo.customStyle = style;\n    }\n    return style;\n  }\n\n  /**\n   * @param {Element} style\n   * @param {Object} properties\n   */\n  applyCustomStyle(style, properties) {\n    let rules = StyleUtil.rulesForStyle(/** @type {HTMLStyleElement} */(style));\n    let self = this;\n    style.textContent = StyleUtil.toCssText(rules, function(/** StyleNode */rule) {\n      let css = rule['cssText'] = rule['parsedCssText'];\n      if (rule.propertyInfo && rule.propertyInfo.cssText) {\n        // remove property assignments\n        // so next function isn't confused\n        // NOTE: we have 3 categories of css:\n        // (1) normal properties,\n        // (2) custom property assignments (--foo: red;),\n        // (3) custom property usage: border: var(--foo); @apply(--foo);\n        // In elements, 1 and 3 are separated for efficiency; here they\n        // are not and this makes this case unique.\n        css = removeCustomPropAssignment(/** @type {string} */(css));\n        // replace with reified properties, scenario is same as mixin\n        rule['cssText'] = self.valueForProperties(css, properties);\n      }\n    });\n  }\n}\n\n/**\n * @param {number} n\n * @param {Array<number>} bits\n */\nfunction addToBitMask(n, bits) {\n  let o = parseInt(n / 32, 10);\n  let v = 1 << (n % 32);\n  bits[o] = (bits[o] || 0) | v;\n}\n\nexport default new StyleProperties();","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {applyStylePlaceHolder} from './style-util.js';\nimport {nativeShadow, disableRuntime} from './style-settings.js';\n\n/** @type {!Object<string, !Node>} */\nconst placeholderMap = {};\n\n/**\n * @param {string} elementName\n * @return {Node}\n */\nexport function getStylePlaceholder(elementName) {\n  return placeholderMap[elementName] || null;\n}\n\n/**\n * @param {string} elementName\n */\nexport function ensureStylePlaceholder(elementName) {\n  if (!placeholderMap[elementName]) {\n    placeholderMap[elementName] = applyStylePlaceHolder(elementName);\n  }\n}\n\n/**\n * @const {CustomElementRegistry}\n */\nconst ce = window['customElements'];\nif (ce && !nativeShadow && !disableRuntime) {\n  /**\n   * @const {function(this:CustomElementRegistry, string,function(new:HTMLElement),{extends: string}=)}\n   */\n  const origDefine = ce['define'];\n  /**\n   * @param {string} name\n   * @param {function(new:HTMLElement)} clazz\n   * @param {{extends: string}=} options\n   */\n  const wrappedDefine = (name, clazz, options) => {\n    ensureStylePlaceholder(name);\n    origDefine.call(/** @type {!CustomElementRegistry} */(ce), name, clazz, options);\n  };\n  ce['define'] = wrappedDefine;\n}","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n'use strict';\n\nexport default class StyleCache {\n  constructor(typeMax = 100) {\n    // map element name -> [{properties, styleElement, scopeSelector}]\n    this.cache = {};\n    /** @type {number} */\n    this.typeMax = typeMax;\n  }\n\n  _validate(cacheEntry, properties, ownPropertyNames) {\n    for (let idx = 0; idx < ownPropertyNames.length; idx++) {\n      let pn = ownPropertyNames[idx];\n      if (cacheEntry.properties[pn] !== properties[pn]) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  store(tagname, properties, styleElement, scopeSelector) {\n    let list = this.cache[tagname] || [];\n    list.push({properties, styleElement, scopeSelector});\n    if (list.length > this.typeMax) {\n      list.shift();\n    }\n    this.cache[tagname] = list;\n  }\n\n  fetch(tagname, properties, ownPropertyNames) {\n    let list = this.cache[tagname];\n    if (!list) {\n      return;\n    }\n    // reverse list for most-recent lookups\n    for (let idx = list.length - 1; idx >= 0; idx--) {\n      let entry = list[idx];\n      if (this._validate(entry, properties, ownPropertyNames)) {\n        return entry;\n      }\n    }\n  }\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {nativeShadow} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport {getIsExtends, elementHasBuiltCss, wrap} from './style-util.js';\n\nexport let flush = function() {};\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nfunction getClasses(element) {\n  if (element.classList && element.classList.value) {\n    return element.classList.value;\n  } else {\n    // NOTE: className is patched to remove scoping classes in ShadyDOM\n    // use getAttribute('class') instead, which is unpatched\n    return element.getAttribute('class') || '';\n  }\n}\n\nconst scopeRegExp = new RegExp(`${StyleTransformer.SCOPE_NAME}\\\\s*([^\\\\s]*)`);\n\n/**\n * @param {!Element} element\n * @return {string}\n */\nexport function getCurrentScope(element) {\n  const match = getClasses(element).match(scopeRegExp);\n  if (match) {\n    return match[1];\n  } else {\n    return '';\n  }\n}\n\n/**\n * @param {!Node} node\n */\nexport function getOwnerScope(node) {\n  const ownerRoot = wrap(node).getRootNode();\n  if (ownerRoot === node || ownerRoot === node.ownerDocument) {\n    return '';\n  }\n  const host = /** @type {!ShadowRoot} */(ownerRoot).host;\n  if (!host) {\n    // this may actually be a document fragment\n    return '';\n  }\n  return getIsExtends(host).is;\n}\n\n/**\n * @param {!Element} element\n */\nexport function ensureCorrectScope(element) {\n  const currentScope = getCurrentScope(element);\n  const ownerRoot = wrap(element).getRootNode();\n  if (ownerRoot === element) {\n    return;\n  }\n  if (currentScope && ownerRoot === element.ownerDocument) {\n    // node was scoped, but now is in document\n    StyleTransformer.domRemoveScope(element, currentScope);\n  } else if (ownerRoot instanceof ShadowRoot) {\n    const ownerScope = getOwnerScope(element);\n    if (ownerScope !== currentScope) {\n      // node was scoped, but not by its current owner\n      StyleTransformer.domReplaceScope(element, currentScope, ownerScope);\n    }\n  }\n}\n\n/**\n * @param {!HTMLElement|!HTMLDocument} element\n */\nexport function ensureCorrectSubtreeScoping(element) {\n  // find unscoped subtree nodes\n  const unscopedNodes = window['ShadyDOM']['nativeMethods']['querySelectorAll'].call(\n    element, `:not(.${StyleTransformer.SCOPE_NAME})`);\n\n  for (let j = 0; j < unscopedNodes.length; j++) {\n    // it's possible, during large batch inserts, that nodes that aren't\n    // scoped within the current scope were added.\n    // To make sure that any unscoped nodes that were inserted in the current batch are correctly styled,\n    // query all unscoped nodes and force their style-scope to be applied.\n    // This could happen if a sub-element appended an unscoped node in its shadowroot and this function\n    // runs on a parent element of the host of that unscoped node:\n    // parent-element -> element -> unscoped node\n    // Here unscoped node should have the style-scope element, not parent-element.\n    const unscopedNode = unscopedNodes[j];\n    const scopeForPreviouslyUnscopedNode = getOwnerScope(unscopedNode);\n    if (scopeForPreviouslyUnscopedNode) {\n      StyleTransformer.element(unscopedNode, scopeForPreviouslyUnscopedNode);\n    }\n  }\n}\n\n/**\n * @param {HTMLElement} el\n * @return {boolean}\n */\nfunction isElementWithBuiltCss(el) {\n  if (el.localName === 'style' || el.localName === 'template') {\n    return elementHasBuiltCss(el);\n  }\n  return false;\n}\n\n/**\n * @param {Array<MutationRecord|null>|null} mxns\n */\nfunction handler(mxns) {\n  for (let x=0; x < mxns.length; x++) {\n    let mxn = mxns[x];\n    if (mxn.target === document.documentElement ||\n      mxn.target === document.head) {\n      continue;\n    }\n    for (let i=0; i < mxn.addedNodes.length; i++) {\n      let n = mxn.addedNodes[i];\n      if (n.nodeType !== Node.ELEMENT_NODE) {\n        continue;\n      }\n      n = /** @type {HTMLElement} */(n); // eslint-disable-line no-self-assign\n      let root = n.getRootNode();\n      let currentScope = getCurrentScope(n);\n      // node was scoped, but now is in document\n      // If this element has built css, we must not remove scoping as this node\n      // will be used as a template or style without re - applying scoping as an optimization\n      if (currentScope && root === n.ownerDocument && !isElementWithBuiltCss(n)) {\n        StyleTransformer.domRemoveScope(n, currentScope);\n      } else if (root instanceof ShadowRoot) {\n        const newScope = getOwnerScope(n);\n        // rescope current node and subtree if necessary\n        if (newScope !== currentScope) {\n          StyleTransformer.domReplaceScope(n, currentScope, newScope);\n        }\n        // make sure all the subtree elements are scoped correctly\n        ensureCorrectSubtreeScoping(n);\n      }\n    }\n  }\n}\n\n// if native Shadow DOM is being used, or ShadyDOM handles dynamic scoiping, do not activate the MutationObserver\nif (!nativeShadow && !(window['ShadyDOM'] && window['ShadyDOM']['handlesDynamicScoping'])) {\n  let observer = new MutationObserver(handler);\n  let start = (node) => {\n    observer.observe(node, {childList: true, subtree: true});\n  }\n  let nativeCustomElements = (window['customElements'] &&\n    !window['customElements']['polyfillWrapFlushCallback']);\n  // need to start immediately with native custom elements\n  // TODO(dfreedm): with polyfilled HTMLImports and native custom elements\n  // excessive mutations may be observed; this can be optimized via cooperation\n  // with the HTMLImports polyfill.\n  if (nativeCustomElements) {\n    start(document);\n  } else {\n    let delayedStart = () => {\n      start(document.body);\n    }\n    // use polyfill timing if it's available\n    if (window['HTMLImports']) {\n      window['HTMLImports']['whenReady'](delayedStart);\n    // otherwise push beyond native imports being ready\n    // which requires RAF + readystate interactive.\n    } else {\n      requestAnimationFrame(function() {\n        if (document.readyState === 'loading') {\n          let listener = function() {\n            delayedStart();\n            document.removeEventListener('readystatechange', listener);\n          }\n          document.addEventListener('readystatechange', listener);\n        } else {\n          delayedStart();\n        }\n      });\n    }\n  }\n\n  flush = function() {\n    handler(observer.takeRecords());\n  }\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/**\n * @const {!Object<string, !HTMLTemplateElement>}\n */\nconst templateMap = {};\nexport default templateMap;\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\nimport templateMap from './template-map.js';\nimport {StyleNode} from './css-parse.js'; // eslint-disable-line no-unused-vars\n\n/*\n * Utilities for handling invalidating apply-shim mixins for a given template.\n *\n * The invalidation strategy involves keeping track of the \"current\" version of a template's mixins, and updating that count when a mixin is invalidated.\n * The template\n */\n\n/** @const {string} */\nconst CURRENT_VERSION = '_applyShimCurrentVersion';\n\n/** @const {string} */\nconst NEXT_VERSION = '_applyShimNextVersion';\n\n/** @const {string} */\nconst VALIDATING_VERSION = '_applyShimValidatingVersion';\n\n/**\n * @const {Promise<void>}\n */\nconst promise = Promise.resolve();\n\n/**\n * @param {string} elementName\n */\nexport function invalidate(elementName){\n  let template = templateMap[elementName];\n  if (template) {\n    invalidateTemplate(template);\n  }\n}\n\n/**\n * This function can be called multiple times to mark a template invalid\n * and signal that the style inside must be regenerated.\n *\n * Use `startValidatingTemplate` to begin an asynchronous validation cycle.\n * During that cycle, call `templateIsValidating` to see if the template must\n * be revalidated\n * @param {HTMLTemplateElement} template\n */\nexport function invalidateTemplate(template) {\n  // default the current version to 0\n  template[CURRENT_VERSION] = template[CURRENT_VERSION] || 0;\n  // ensure the \"validating for\" flag exists\n  template[VALIDATING_VERSION] = template[VALIDATING_VERSION] || 0;\n  // increment the next version\n  template[NEXT_VERSION] = (template[NEXT_VERSION] || 0) + 1;\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValid(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValid(template);\n  }\n  return true;\n}\n\n/**\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValid(template) {\n  return template[CURRENT_VERSION] === template[NEXT_VERSION];\n}\n\n/**\n * @param {string} elementName\n * @return {boolean}\n */\nexport function isValidating(elementName) {\n  let template = templateMap[elementName];\n  if (template) {\n    return templateIsValidating(template);\n  }\n  return false;\n}\n\n/**\n * Returns true if the template is currently invalid and `startValidating` has been called since the last invalidation.\n * If false, the template must be validated.\n * @param {HTMLTemplateElement} template\n * @return {boolean}\n */\nexport function templateIsValidating(template) {\n  return !templateIsValid(template) && template[VALIDATING_VERSION] === template[NEXT_VERSION];\n}\n\n/**\n * the template is marked as `validating` for one microtask so that all instances\n * found in the tree crawl of `applyStyle` will update themselves,\n * but the template will only be updated once.\n * @param {string} elementName\n*/\nexport function startValidating(elementName) {\n  let template = templateMap[elementName];\n  startValidatingTemplate(template);\n}\n\n/**\n * Begin an asynchronous invalidation cycle.\n * This should be called after every validation of a template\n *\n * After one microtask, the template will be marked as valid until the next call to `invalidateTemplate`\n * @param {HTMLTemplateElement} template\n */\nexport function startValidatingTemplate(template) {\n  // remember that the current \"next version\" is the reason for this validation cycle\n  template[VALIDATING_VERSION] = template[NEXT_VERSION];\n  // however, there only needs to be one async task to clear the counters\n  if (!template._validating) {\n    template._validating = true;\n    promise.then(function() {\n      // sync the current version to let future invalidations cause a refresh cycle\n      template[CURRENT_VERSION] = template[NEXT_VERSION];\n      template._validating = false;\n    });\n  }\n}\n\n/**\n * @return {boolean}\n */\nexport function elementsAreInvalid() {\n  for (let elementName in templateMap) {\n    let template = templateMap[elementName];\n    if (!templateIsValid(template)) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport { MIXIN_MATCH, VAR_ASSIGN } from './common-regex.js';\n\n/**\n * @param {Element} element\n * @param {Object=} properties\n */\nexport function updateNativeProperties(element, properties) {\n  // remove previous properties\n  for (let p in properties) {\n    // NOTE: for bc with shim, don't apply null values.\n    if (p === null) {\n      element.style.removeProperty(p);\n    } else {\n      element.style.setProperty(p, properties[p]);\n    }\n  }\n}\n\n/**\n * @param {Element} element\n * @param {string} property\n * @return {string}\n */\nexport function getComputedStyleValue(element, property) {\n  /**\n   * @const {string}\n   */\n  const value = window.getComputedStyle(element).getPropertyValue(property);\n  if (!value) {\n    return '';\n  } else {\n    return value.trim();\n  }\n}\n\n/**\n * return true if `cssText` contains a mixin definition or consumption\n * @param {string} cssText\n * @return {boolean}\n */\nexport function detectMixin(cssText) {\n  const has = MIXIN_MATCH.test(cssText) || VAR_ASSIGN.test(cssText);\n  // reset state of the regexes\n  MIXIN_MATCH.lastIndex = 0;\n  VAR_ASSIGN.lastIndex = 0;\n  return has;\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\n/** @type {Promise<void>} */\nlet readyPromise = null;\n\n/** @type {?function(?function())} */\nlet whenReady = window['HTMLImports'] && window['HTMLImports']['whenReady'] || null;\n\n/** @type {function()} */\nlet resolveFn;\n\n/**\n * @param {?function()} callback\n */\nexport default function documentWait(callback) {\n  requestAnimationFrame(function() {\n    if (whenReady) {\n      whenReady(callback)\n    } else {\n      if (!readyPromise) {\n        readyPromise = new Promise((resolve) => {resolveFn = resolve});\n        if (document.readyState === 'complete') {\n          resolveFn();\n        } else {\n          document.addEventListener('readystatechange', () => {\n            if (document.readyState === 'complete') {\n              resolveFn();\n            }\n          });\n        }\n      }\n      readyPromise.then(function(){ callback && callback(); });\n    }\n  });\n}\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport documentWait from './document-wait.js';\n\n/**\n * @typedef {HTMLStyleElement | {getStyle: function():HTMLStyleElement}}\n */\nexport let CustomStyleProvider;\n\nconst SEEN_MARKER = '__seenByShadyCSS';\nconst CACHED_STYLE = '__shadyCSSCachedStyle';\n\n/** @type {?function(!HTMLStyleElement)} */\nlet transformFn = null;\n\n/** @type {?function()} */\nlet validateFn = null;\n\n/**\nThis interface is provided to add document-level <style> elements to ShadyCSS for processing.\nThese styles must be processed by ShadyCSS to simulate ShadowRoot upper-bound encapsulation from outside styles\nIn addition, these styles may also need to be processed for @apply rules and CSS Custom Properties\n\nTo add document-level styles to ShadyCSS, one can call `ShadyCSS.addDocumentStyle(styleElement)` or `ShadyCSS.addDocumentStyle({getStyle: () => styleElement})`\n\nIn addition, if the process used to discover document-level styles can be synchronously flushed, one should set `ShadyCSS.documentStyleFlush`.\nThis function will be called when calculating styles.\n\nAn example usage of the document-level styling api can be found in `examples/document-style-lib.js`\n\n@unrestricted\n*/\nexport default class CustomStyleInterface {\n  constructor() {\n    /** @type {!Array<!CustomStyleProvider>} */\n    this['customStyles'] = [];\n    this['enqueued'] = false;\n    // NOTE(dfreedm): use quotes here to prevent closure inlining to `function(){}`;\n    documentWait(() => {\n      if (window['ShadyCSS']['flushCustomStyles']) {\n        window['ShadyCSS']['flushCustomStyles']();\n      }\n    })\n  }\n  /**\n   * Queue a validation for new custom styles to batch style recalculations\n   */\n  enqueueDocumentValidation() {\n    if (this['enqueued'] || !validateFn) {\n      return;\n    }\n    this['enqueued'] = true;\n    documentWait(validateFn);\n  }\n  /**\n   * @param {!HTMLStyleElement} style\n   */\n  addCustomStyle(style) {\n    if (!style[SEEN_MARKER]) {\n      style[SEEN_MARKER] = true;\n      this['customStyles'].push(style);\n      this.enqueueDocumentValidation();\n    }\n  }\n  /**\n   * @param {!CustomStyleProvider} customStyle\n   * @return {HTMLStyleElement}\n   */\n  getStyleForCustomStyle(customStyle) {\n    if (customStyle[CACHED_STYLE]) {\n      return customStyle[CACHED_STYLE];\n    }\n    let style;\n    if (customStyle['getStyle']) {\n      style = customStyle['getStyle']();\n    } else {\n      style = customStyle;\n    }\n    return style;\n  }\n  /**\n   * @return {!Array<!CustomStyleProvider>}\n   */\n  processStyles() {\n    const cs = this['customStyles'];\n    for (let i = 0; i < cs.length; i++) {\n      const customStyle = cs[i];\n      if (customStyle[CACHED_STYLE]) {\n        continue;\n      }\n      const style = this.getStyleForCustomStyle(customStyle);\n      if (style) {\n        // HTMLImports polyfill may have cloned the style into the main document,\n        // which is referenced with __appliedElement.\n        const styleToTransform = /** @type {!HTMLStyleElement} */(style['__appliedElement'] || style);\n        if (transformFn) {\n          transformFn(styleToTransform);\n        }\n        customStyle[CACHED_STYLE] = styleToTransform;\n      }\n    }\n    return cs;\n  }\n}\n\n/* eslint-disable no-self-assign */\nCustomStyleInterface.prototype['addCustomStyle'] = CustomStyleInterface.prototype.addCustomStyle;\nCustomStyleInterface.prototype['getStyleForCustomStyle'] = CustomStyleInterface.prototype.getStyleForCustomStyle;\nCustomStyleInterface.prototype['processStyles'] = CustomStyleInterface.prototype.processStyles;\n/* eslint-enable no-self-assign */\n\nObject.defineProperties(CustomStyleInterface.prototype, {\n  'transformCallback': {\n    /** @return {?function(!HTMLStyleElement)} */\n    get() {\n      return transformFn;\n    },\n    /** @param {?function(!HTMLStyleElement)} fn */\n    set(fn) {\n      transformFn = fn;\n    }\n  },\n  'validateCallback': {\n    /** @return {?function()} */\n    get() {\n      return validateFn;\n    },\n    /**\n     * @param {?function()} fn\n     * @this {CustomStyleInterface}\n     */\n    set(fn) {\n      let needsEnqueue = false;\n      if (!validateFn) {\n        needsEnqueue = true;\n      }\n      validateFn = fn;\n      if (needsEnqueue) {\n        this.enqueueDocumentValidation();\n      }\n    },\n  }\n})\n\n/** @typedef {{\n * customStyles: !Array<!CustomStyleProvider>,\n * addCustomStyle: function(!CustomStyleProvider),\n * getStyleForCustomStyle: function(!CustomStyleProvider): HTMLStyleElement,\n * findStyles: function(),\n * transformCallback: ?function(!HTMLStyleElement),\n * validateCallback: ?function()\n * }}\n */\nexport const CustomStyleInterfaceInterface = {};\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport {parse, StyleNode} from './css-parse.js';\nimport {nativeShadow, nativeCssVariables, disableRuntime} from './style-settings.js';\nimport StyleTransformer from './style-transformer.js';\nimport * as StyleUtil from './style-util.js';\nimport StyleProperties from './style-properties.js';\nimport {ensureStylePlaceholder, getStylePlaceholder} from './style-placeholder.js';\nimport StyleInfo from './style-info.js';\nimport StyleCache from './style-cache.js';\nimport {flush as watcherFlush, getOwnerScope, getCurrentScope} from './document-watcher.js';\nimport templateMap from './template-map.js';\nimport * as ApplyShimUtils from './apply-shim-utils.js';\nimport {updateNativeProperties, detectMixin} from './common-utils.js';\nimport {CustomStyleInterfaceInterface} from './custom-style-interface.js'; // eslint-disable-line no-unused-vars\n\n/** @type {!Object<string, string>} */\nconst adoptedCssTextMap = {};\n\n/**\n * @const {StyleCache}\n */\nconst styleCache = new StyleCache();\n\nexport default class ScopingShim {\n  constructor() {\n    this._scopeCounter = {};\n    this._documentOwner = /** @type {!HTMLElement} */(document.documentElement);\n    let ast = new StyleNode();\n    ast['rules'] = [];\n    this._documentOwnerStyleInfo = StyleInfo.set(this._documentOwner, new StyleInfo(ast));\n    this._elementsHaveApplied = false;\n    /** @type {?Object} */\n    this._applyShim = null;\n    /** @type {?CustomStyleInterfaceInterface} */\n    this._customStyleInterface = null;\n  }\n  flush() {\n    watcherFlush();\n  }\n  _generateScopeSelector(name) {\n    let id = this._scopeCounter[name] = (this._scopeCounter[name] || 0) + 1;\n    return `${name}-${id}`;\n  }\n  getStyleAst(style) {\n    return StyleUtil.rulesForStyle(style);\n  }\n  styleAstToString(ast) {\n    return StyleUtil.toCssText(ast);\n  }\n  _gatherStyles(template) {\n    return StyleUtil.gatherStyleText(template.content);\n  }\n  /**\n   * Prepare the styling and template for the given element type\n   *\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplate(template, elementName, typeExtension) {\n    this.prepareTemplateDom(template, elementName);\n    this.prepareTemplateStyles(template, elementName, typeExtension);\n  }\n  /**\n   * Prepare styling for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} typeExtension\n   */\n  prepareTemplateStyles(template, elementName, typeExtension) {\n    if (template._prepared || disableRuntime) {\n      return;\n    }\n    // style placeholders are only used when ShadyDOM is active\n    if (!nativeShadow) {\n      ensureStylePlaceholder(elementName);\n    }\n    template._prepared = true;\n    template.name = elementName;\n    template.extends = typeExtension;\n    templateMap[elementName] = template;\n    let cssBuild = StyleUtil.getCssBuild(template);\n    const optimalBuild = StyleUtil.isOptimalCssBuild(cssBuild);\n    let info = {\n      is: elementName,\n      extends: typeExtension,\n    };\n    let cssText = this._gatherStyles(template) + (adoptedCssTextMap[elementName] || '');\n    // check if the styling has mixin definitions or uses\n    this._ensure();\n    if (!optimalBuild) {\n      let hasMixins = !cssBuild && detectMixin(cssText);\n      let ast = parse(cssText);\n      // only run the applyshim transforms if there is a mixin involved\n      if (hasMixins && nativeCssVariables && this._applyShim) {\n        this._applyShim['transformRules'](ast, elementName);\n      }\n      template['_styleAst'] = ast;\n    }\n    let ownPropertyNames = [];\n    if (!nativeCssVariables) {\n      ownPropertyNames = StyleProperties.decorateStyles(template['_styleAst']);\n    }\n    if (!ownPropertyNames.length || nativeCssVariables) {\n      let root = nativeShadow ? template.content : null;\n      let placeholder = getStylePlaceholder(elementName);\n      let style = this._generateStaticStyle(info, template['_styleAst'], root, placeholder, cssBuild, optimalBuild ? cssText : '');\n      template._style = style;\n    }\n    template._ownPropertyNames = ownPropertyNames;\n  }\n\n  /**\n   * @param {!Array<string>} cssTextArray\n   * @param {string} elementName\n   */\n  prepareAdoptedCssText(cssTextArray, elementName) {\n    adoptedCssTextMap[elementName] = cssTextArray.join(' ');\n  }\n  /**\n   * Prepare template for the given element type\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    if (disableRuntime) {\n      return;\n    }\n    const cssBuild = StyleUtil.getCssBuild(template);\n    if (!nativeShadow && cssBuild !== 'shady' && !template._domPrepared) {\n      template._domPrepared = true;\n      StyleTransformer.domAddScope(template.content, elementName);\n    }\n  }\n  /**\n   * @param {!{is: string, extends: (string|undefined)}} info\n   * @param {!StyleNode} rules\n   * @param {DocumentFragment} shadowroot\n   * @param {Node} placeholder\n   * @param {string} cssBuild\n   * @param {string=} cssText\n   * @return {?HTMLStyleElement}\n   */\n  _generateStaticStyle(info, rules, shadowroot, placeholder, cssBuild, cssText) {\n    cssText = StyleTransformer.elementStyles(info, rules, null, cssBuild, cssText);\n    if (cssText.length) {\n      return StyleUtil.applyCss(cssText, info.is, shadowroot, placeholder);\n    }\n    return null;\n  }\n  _prepareHost(host) {\n    const {is, typeExtension} = StyleUtil.getIsExtends(host);\n    const placeholder = getStylePlaceholder(is);\n    const template = templateMap[is];\n    if (!template) {\n      return;\n    }\n    const ast = template['_styleAst'];\n    const ownStylePropertyNames = template._ownPropertyNames;\n    const cssBuild = StyleUtil.getCssBuild(template);\n    const styleInfo = new StyleInfo(\n      ast,\n      placeholder,\n      ownStylePropertyNames,\n      is,\n      typeExtension,\n      cssBuild\n    );\n    StyleInfo.set(host, styleInfo);\n    return styleInfo;\n  }\n  _ensureApplyShim() {\n    if (this._applyShim) {\n      return;\n    } else if (window.ShadyCSS && window.ShadyCSS.ApplyShim) {\n      this._applyShim = /** @type {!Object} */ (window.ShadyCSS.ApplyShim);\n      this._applyShim['invalidCallback'] = ApplyShimUtils.invalidate;\n    }\n  }\n  _ensureCustomStyleInterface() {\n    if (this._customStyleInterface) {\n      return;\n    } else if (window.ShadyCSS && window.ShadyCSS.CustomStyleInterface) {\n      this._customStyleInterface = /** @type {!CustomStyleInterfaceInterface} */(window.ShadyCSS.CustomStyleInterface);\n      /** @type {function(!HTMLStyleElement)} */\n      this._customStyleInterface['transformCallback'] = (style) => {this.transformCustomStyleForDocument(style)};\n      this._customStyleInterface['validateCallback'] = () => {\n        requestAnimationFrame(() => {\n          if (this._customStyleInterface['enqueued'] || this._elementsHaveApplied) {\n            this.flushCustomStyles();\n          }\n        })\n      };\n    }\n  }\n  _ensure() {\n    this._ensureApplyShim();\n    this._ensureCustomStyleInterface();\n  }\n  /**\n   * Flush and apply custom styles to document\n   */\n  flushCustomStyles() {\n    if (disableRuntime) {\n      return;\n    }\n    this._ensure();\n    if (!this._customStyleInterface) {\n      return;\n    }\n    let customStyles = this._customStyleInterface['processStyles']();\n    // early return if custom-styles don't need validation\n    if (!this._customStyleInterface['enqueued']) {\n      return;\n    }\n    // bail if custom styles are built optimally\n    if (StyleUtil.isOptimalCssBuild(this._documentOwnerStyleInfo.cssBuild)) {\n      return;\n    }\n    if (!nativeCssVariables) {\n      this._updateProperties(this._documentOwner, this._documentOwnerStyleInfo);\n      this._applyCustomStyles(customStyles);\n      if (this._elementsHaveApplied) {\n        // if custom elements have upgraded and there are no native css variables, we must recalculate the whole tree\n        this.styleDocument();\n      }\n    } else if (!this._documentOwnerStyleInfo.cssBuild) {\n      this._revalidateCustomStyleApplyShim(customStyles);\n    }\n    this._customStyleInterface['enqueued'] = false;\n  }\n  /**\n   * Apply styles for the given element\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} overrideProps\n   */\n  styleElement(host, overrideProps) {\n    if (disableRuntime) {\n      if (overrideProps) {\n        if (!StyleInfo.get(host)) {\n          StyleInfo.set(host, new StyleInfo(null));\n        }\n        const styleInfo = /** @type {!StyleInfo} */(StyleInfo.get(host));\n        this._mixOverrideStyleProps(styleInfo, overrideProps);\n        this.styleElementNativeVariables(host, styleInfo);\n      }\n      return;\n    }\n    const styleInfo = StyleInfo.get(host) || this._prepareHost(host);\n    // if there is no style info at this point, bail\n    if (!styleInfo) {\n      return;\n    }\n    // Only trip the `elementsHaveApplied` flag if a node other that the root document has `applyStyle` called\n    if (!this._isRootOwner(host)) {\n      this._elementsHaveApplied = true;\n    }\n    if (overrideProps) {\n      this._mixOverrideStyleProps(styleInfo, overrideProps);\n    }\n    if (!nativeCssVariables) {\n      this.styleElementShimVariables(host, styleInfo);\n    } else {\n      this.styleElementNativeVariables(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!StyleInfo} styleInfo\n   * @param {Object} overrideProps\n   */\n  _mixOverrideStyleProps(styleInfo, overrideProps) {\n    styleInfo.overrideStyleProperties =\n      styleInfo.overrideStyleProperties || {};\n    Object.assign(styleInfo.overrideStyleProperties, overrideProps);\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementShimVariables(host, styleInfo) {\n    this.flush();\n    this._updateProperties(host, styleInfo);\n    if (styleInfo.ownStylePropertyNames && styleInfo.ownStylePropertyNames.length) {\n      this._applyStyleProperties(host, styleInfo);\n    }\n  }\n  /**\n   * @param {!HTMLElement} host\n   * @param {!StyleInfo} styleInfo\n   */\n  styleElementNativeVariables(host, styleInfo) {\n    const { is } = StyleUtil.getIsExtends(host);\n    if (styleInfo.overrideStyleProperties) {\n      updateNativeProperties(host, styleInfo.overrideStyleProperties);\n    }\n    const template = templateMap[is];\n    // bail early if there is no shadowroot for this element\n    if (!template && !this._isRootOwner(host)) {\n      return;\n    }\n    // bail early if the template was built with polymer-css-build\n    if (template && StyleUtil.elementHasBuiltCss(template)) {\n      return;\n    }\n    if (template && template._style && !ApplyShimUtils.templateIsValid(template)) {\n      // update template\n      if (!ApplyShimUtils.templateIsValidating(template)) {\n        this._ensure();\n        this._applyShim && this._applyShim['transformRules'](template['_styleAst'], is);\n        template._style.textContent = StyleTransformer.elementStyles(host, styleInfo.styleRules);\n        ApplyShimUtils.startValidatingTemplate(template);\n      }\n      // update instance if native shadowdom\n      if (nativeShadow) {\n        let root = host.shadowRoot;\n        if (root) {\n          let style = root.querySelector('style');\n          if (style) {\n            style.textContent = StyleTransformer.elementStyles(host, styleInfo.styleRules);\n          }\n        }\n      }\n      styleInfo.styleRules = template['_styleAst'];\n    }\n  }\n  _styleOwnerForNode(node) {\n    let root = StyleUtil.wrap(node).getRootNode();\n    let host = root.host;\n    if (host) {\n      if (StyleInfo.get(host) || this._prepareHost(host)) {\n        return host;\n      } else {\n        return this._styleOwnerForNode(host);\n      }\n    }\n    return this._documentOwner;\n  }\n  _isRootOwner(node) {\n    return (node === this._documentOwner);\n  }\n  _applyStyleProperties(host, styleInfo) {\n    let is = StyleUtil.getIsExtends(host).is;\n    let cacheEntry = styleCache.fetch(is, styleInfo.styleProperties, styleInfo.ownStylePropertyNames);\n    let cachedScopeSelector = cacheEntry && cacheEntry.scopeSelector;\n    let cachedStyle = cacheEntry ? cacheEntry.styleElement : null;\n    let oldScopeSelector = styleInfo.scopeSelector;\n    // only generate new scope if cached style is not found\n    styleInfo.scopeSelector = cachedScopeSelector || this._generateScopeSelector(is);\n    let style = StyleProperties.applyElementStyle(host, styleInfo.styleProperties, styleInfo.scopeSelector, cachedStyle);\n    if (!nativeShadow) {\n      StyleProperties.applyElementScopeSelector(host, styleInfo.scopeSelector, oldScopeSelector);\n    }\n    if (!cacheEntry) {\n      styleCache.store(is, styleInfo.styleProperties, style, styleInfo.scopeSelector);\n    }\n    return style;\n  }\n  _updateProperties(host, styleInfo) {\n    let owner = this._styleOwnerForNode(host);\n    let ownerStyleInfo = StyleInfo.get(owner);\n    let ownerProperties = ownerStyleInfo.styleProperties;\n    // style owner has not updated properties yet\n    // go up the chain and force property update,\n    // except if the owner is the document\n    if (owner !== this._documentOwner && !ownerProperties) {\n      this._updateProperties(owner, ownerStyleInfo);\n      ownerProperties = ownerStyleInfo.styleProperties;\n    }\n    let props = Object.create(ownerProperties || null);\n    let hostAndRootProps = StyleProperties.hostAndRootPropertiesForScope(host, styleInfo.styleRules, styleInfo.cssBuild);\n    let propertyData = StyleProperties.propertyDataFromStyles(ownerStyleInfo.styleRules, host);\n    let propertiesMatchingHost = propertyData.properties\n    Object.assign(\n      props,\n      hostAndRootProps.hostProps,\n      propertiesMatchingHost,\n      hostAndRootProps.rootProps\n    );\n    this._mixinOverrideStyles(props, styleInfo.overrideStyleProperties);\n    StyleProperties.reify(props);\n    styleInfo.styleProperties = props;\n  }\n  _mixinOverrideStyles(props, overrides) {\n    for (let p in overrides) {\n      let v = overrides[p];\n      // skip override props if they are not truthy or 0\n      // in order to fall back to inherited values\n      if (v || v === 0) {\n        props[p] = v;\n      }\n    }\n  }\n  /**\n   * Update styles of the whole document\n   *\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    this.styleSubtree(this._documentOwner, properties);\n  }\n  /**\n   * Update styles of a subtree\n   *\n   * @param {!HTMLElement} host\n   * @param {Object=} properties\n   */\n  styleSubtree(host, properties) {\n    const wrappedHost = StyleUtil.wrap(host);\n    let root = wrappedHost.shadowRoot;\n    if (root || this._isRootOwner(host)) {\n      this.styleElement(host, properties);\n    }\n    // process the shadowdom children of `host`\n    let shadowChildren =\n        root && (/** @type {!ParentNode} */ (root).children || root.childNodes);\n    if (shadowChildren) {\n      for (let i = 0; i < shadowChildren.length; i++) {\n        let c = /** @type {!HTMLElement} */(shadowChildren[i]);\n        this.styleSubtree(c);\n      }\n    } else {\n      // process the lightdom children of `host`\n      let children = wrappedHost.children || wrappedHost.childNodes;\n      if (children) {\n        for (let i = 0; i < children.length; i++) {\n          let c = /** @type {!HTMLElement} */(children[i]);\n          this.styleSubtree(c);\n        }\n      }\n    }\n  }\n  /* Custom Style operations */\n  _revalidateCustomStyleApplyShim(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        this._revalidateApplyShim(s);\n      }\n    }\n  }\n  _applyCustomStyles(customStyles) {\n    for (let i = 0; i < customStyles.length; i++) {\n      let c = customStyles[i];\n      let s = this._customStyleInterface['getStyleForCustomStyle'](c);\n      if (s) {\n        StyleProperties.applyCustomStyle(s, this._documentOwnerStyleInfo.styleProperties);\n      }\n    }\n  }\n  transformCustomStyleForDocument(style) {\n    const cssBuild = StyleUtil.getCssBuild(style);\n    if (cssBuild !== this._documentOwnerStyleInfo.cssBuild) {\n      this._documentOwnerStyleInfo.cssBuild = cssBuild;\n    }\n    if (StyleUtil.isOptimalCssBuild(cssBuild)) {\n      return;\n    }\n    let ast = StyleUtil.rulesForStyle(style);\n    StyleUtil.forEachRule(ast, (rule) => {\n      if (nativeShadow) {\n        StyleTransformer.normalizeRootSelector(rule);\n      } else {\n        StyleTransformer.documentRule(rule);\n      }\n      if (nativeCssVariables && cssBuild === '') {\n        this._ensure();\n        this._applyShim && this._applyShim['transformRule'](rule);\n      }\n    });\n    if (nativeCssVariables) {\n      style.textContent = StyleUtil.toCssText(ast);\n    } else {\n      this._documentOwnerStyleInfo.styleRules['rules'].push(ast);\n    }\n  }\n  _revalidateApplyShim(style) {\n    if (nativeCssVariables && this._applyShim) {\n      let ast = StyleUtil.rulesForStyle(style);\n      this._ensure();\n      this._applyShim['transformRules'](ast);\n      style.textContent = StyleUtil.toCssText(ast);\n    }\n  }\n  getComputedStyleValue(element, property) {\n    let value;\n    if (!nativeCssVariables) {\n      // element is either a style host, or an ancestor of a style host\n      let styleInfo = StyleInfo.get(element) || StyleInfo.get(this._styleOwnerForNode(element));\n      value = styleInfo.styleProperties[property];\n    }\n    // fall back to the property value from the computed styling\n    value = value || window.getComputedStyle(element).getPropertyValue(property);\n    // trim whitespace that can come after the `:` in css\n    // example: padding: 2px -> \" 2px\"\n    return value ? value.trim() : '';\n  }\n  // given an element and a classString, replaces\n  // the element's class with the provided classString and adds\n  // any necessary ShadyCSS static and property based scoping selectors\n  setElementClass(element, classString) {\n    let root = StyleUtil.wrap(element).getRootNode();\n    let classes = classString ? classString.split(/\\s/) : [];\n    let scopeName = root.host && root.host.localName;\n    // If no scope, try to discover scope name from existing class.\n    // This can occur if, for example, a template stamped element that\n    // has been scoped is manipulated when not in a root.\n    if (!scopeName) {\n      var classAttr = element.getAttribute('class');\n      if (classAttr) {\n        let k$ = classAttr.split(/\\s/);\n        for (let i=0; i < k$.length; i++) {\n          if (k$[i] === StyleTransformer.SCOPE_NAME) {\n            scopeName = k$[i+1];\n            break;\n          }\n        }\n      }\n    }\n    if (scopeName) {\n      classes.push(StyleTransformer.SCOPE_NAME, scopeName);\n    }\n    if (!nativeCssVariables) {\n      let styleInfo = StyleInfo.get(element);\n      if (styleInfo && styleInfo.scopeSelector) {\n        classes.push(StyleProperties.XSCOPE_NAME, styleInfo.scopeSelector);\n      }\n    }\n    StyleUtil.setElementClassRaw(element, classes.join(' '));\n  }\n  _styleInfoForNode(node) {\n    return StyleInfo.get(node);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  scopeNode(node, scope) {\n    StyleTransformer.element(node, scope);\n  }\n  /**\n   * @param {!Element} node\n   * @param {string} scope\n   */\n  unscopeNode(node, scope) {\n    StyleTransformer.element(node, scope, true);\n  }\n  /**\n   * @param {!Node} node\n   * @return {string}\n   */\n  scopeForNode(node) {\n    return getOwnerScope(node);\n  }\n  /**\n   * @param {!Element} node\n   * @return {string}\n   */\n  currentScopeForNode(node) {\n    return getCurrentScope(node);\n  }\n}\n\n/* exports */\n/* eslint-disable no-self-assign */\nScopingShim.prototype['flush'] = ScopingShim.prototype.flush;\nScopingShim.prototype['prepareTemplate'] = ScopingShim.prototype.prepareTemplate;\nScopingShim.prototype['styleElement'] = ScopingShim.prototype.styleElement;\nScopingShim.prototype['styleDocument'] = ScopingShim.prototype.styleDocument;\nScopingShim.prototype['styleSubtree'] = ScopingShim.prototype.styleSubtree;\nScopingShim.prototype['getComputedStyleValue'] = ScopingShim.prototype.getComputedStyleValue;\nScopingShim.prototype['setElementClass'] = ScopingShim.prototype.setElementClass;\nScopingShim.prototype['_styleInfoForNode'] = ScopingShim.prototype._styleInfoForNode;\nScopingShim.prototype['transformCustomStyleForDocument'] = ScopingShim.prototype.transformCustomStyleForDocument;\nScopingShim.prototype['getStyleAst'] = ScopingShim.prototype.getStyleAst;\nScopingShim.prototype['styleAstToString'] = ScopingShim.prototype.styleAstToString;\nScopingShim.prototype['flushCustomStyles'] = ScopingShim.prototype.flushCustomStyles;\nScopingShim.prototype['scopeNode'] = ScopingShim.prototype.scopeNode;\nScopingShim.prototype['unscopeNode'] = ScopingShim.prototype.unscopeNode;\nScopingShim.prototype['scopeForNode'] = ScopingShim.prototype.scopeForNode;\nScopingShim.prototype['currentScopeForNode'] = ScopingShim.prototype.currentScopeForNode;\nScopingShim.prototype['prepareAdoptedCssText'] = ScopingShim.prototype.prepareAdoptedCssText;\n/* eslint-enable no-self-assign */\nObject.defineProperties(ScopingShim.prototype, {\n  'nativeShadow': {\n    get() {\n      return nativeShadow;\n    }\n  },\n  'nativeCss': {\n    get() {\n      return nativeCssVariables;\n    }\n  }\n});\n","/**\n@license\nCopyright (c) 2017 The Polymer Project Authors. All rights reserved.\nThis code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt\nThe complete set of authors may be found at http://polymer.github.io/AUTHORS.txt\nThe complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt\nCode distributed by Google as part of the polymer project is also\nsubject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt\n*/\n\n'use strict';\n\nimport ScopingShim from '../src/scoping-shim.js';\nimport {nativeCssVariables, nativeShadow, cssBuild, disableRuntime} from '../src/style-settings.js';\n\n/** @const {ScopingShim} */\nconst scopingShim = new ScopingShim();\n\nlet ApplyShim, CustomStyleInterface;\n\nif (window['ShadyCSS']) {\n  ApplyShim = window['ShadyCSS']['ApplyShim'];\n  CustomStyleInterface = window['ShadyCSS']['CustomStyleInterface'];\n}\n\nwindow.ShadyCSS = {\n  ScopingShim: scopingShim,\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplate(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplate(template, elementName, elementExtends)\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   */\n  prepareTemplateDom(template, elementName) {\n    scopingShim.prepareTemplateDom(template, elementName);\n  },\n\n  /**\n   * @param {!HTMLTemplateElement} template\n   * @param {string} elementName\n   * @param {string=} elementExtends\n   */\n  prepareTemplateStyles(template, elementName, elementExtends) {\n    scopingShim.flushCustomStyles();\n    scopingShim.prepareTemplateStyles(template, elementName, elementExtends)\n  },\n  /**\n   * @param {!HTMLElement} element\n   * @param {Object=} properties\n   */\n  styleSubtree(element, properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleSubtree(element, properties);\n  },\n\n  /**\n   * @param {!HTMLElement} element\n   */\n  styleElement(element) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleElement(element);\n  },\n\n  /**\n   * @param {Object=} properties\n   */\n  styleDocument(properties) {\n    scopingShim.flushCustomStyles();\n    scopingShim.styleDocument(properties);\n  },\n\n  flushCustomStyles() {\n    scopingShim.flushCustomStyles();\n  },\n\n  /**\n   * @param {Element} element\n   * @param {string} property\n   * @return {string}\n   */\n  getComputedStyleValue(element, property) {\n    return scopingShim.getComputedStyleValue(element, property);\n  },\n\n  nativeCss: nativeCssVariables,\n\n  nativeShadow: nativeShadow,\n\n  cssBuild: cssBuild,\n\n  disableRuntime: disableRuntime,\n};\n\nif (ApplyShim) {\n  window.ShadyCSS.ApplyShim = ApplyShim;\n}\n\nif (CustomStyleInterface) {\n  window.ShadyCSS.CustomStyleInterface = CustomStyleInterface;\n}"],"names":["ShadyData","constructor","root","publicRoot","dirty","observer","assignedNodes","assignedSlot","_previouslyAssignedNodes","_prevAssignedSlot","flattenedNodes","ownerShadyRoot","undefined","parentNode","firstChild","lastChild","previousSibling","nextSibling","childNodes","__outsideAccessors","__insideAccessors","__onCallbackListeners","toJSON","ensureShadyDataForNode","node","__shady","shadyDataForNode","settings","window","hasNativeShadowDOM","Boolean","Element","prototype","attachShadow","Node","getRootNode","desc","Object","getOwnPropertyDescriptor","hasDescriptors","configurable","get","inUse","noPatch","preferPerformance","isTrackingLogicalChildNodes","nodeData","isShadyRoot","obj","_localName","hasShadowRootWithSlot","_hasInsertionPoint","p","matches","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","element","selector","call","twiddle","document","createTextNode","content","queue","MutationObserver","length","shift","e","textContent","observe","characterData","microtask","callback","push","hasDocumentContains","contains","container","SHADY_PREFIX","getNodeHTMLCollectionName","getAttribute","isValidHTMLCollectionName","name","isNaN","createPolyfilledHTMLCollection","nodes","l","item","index","namedItem","nodeName","NATIVE_PREFIX","patchProperties","proto","descriptors","prefix","disallowedPatches","newDescriptor","indexOf","value","defineProperty","NativeHTMLElement","HTMLElement","getOwnPropertyDescriptors","getOwnPropertyNames","forEach","flushList","scheduled","enqueue","utils","flush","didFlush","AsyncObserver","_scheduled","addedNodes","removedNodes","callbacks","Set","schedule","mutations","takeRecords","cb","observeChildren","sd","add","_callback","_observer","_node","unobserveChildren","handle","delete","size","filterMutations","target","targetRootNode","map","mutation","mutationInScope","Array","from","filter","n","create","m","escapeAttrRegExp","escapeDataRegExp","escapeReplace","c","escapeAttr","s","replace","escapeData","makeSet","arr","set","i","voidElements","plaintextParents","getOuterHTML","nodeType","ELEMENT_NODE","tagName","localName","attrs","attributes","attr","getInnerHTML","TEXT_NODE","data","COMMENT_NODE","console","error","Error","c$","child","nativeMethods","querySelector","querySelectorAll","nativeTree","installNativeAccessor","installNativeMethod","fn","defineNativeAccessors","prop","copyProperties","list","descriptor","nodeWalker","createTreeWalker","NodeFilter","SHOW_ALL","elementWalker","SHOW_ELEMENT","inertDoc","implementation","createHTMLDocument","clearNode","ParentNodeAccessors","ParentNodeMethods","addNativePrefixedProperties","eventProps","EventTarget","Window","currentNode","parentElement","DOCUMENT_FRAGMENT_NODE","textWalker","SHOW_TEXT","nextNode","nodeValue","ParentNodeWalkerDescriptors","firstElementChild","lastElementChild","children","childElementCount","previousElementSibling","nextElementSibling","innerHTML","containerName","htmlContainer","namespaceURI","createElement","createElementNS","newContent","HTMLTemplateElement","DocumentFragment","Document","InsideDescriptors","shadowRoot","OutsideDescriptors","className","enumerable","noInstancePatching","patchOutsideElementAccessors","patchInsideElementAccessors","eventWrappersName","Date","now","composedGetter","composedProp","Event","ev","alwaysComposed","unpatchedEvents","getRootNodeWithFallback","eventTarget","pathComposer","startNode","composed","composedPath","current","startRoot","host","event","__composedPath","retarget","refNode","path","refNodePath","p$","ancestor","lastRoot","rootIdx","EventPatches","__composed","type","isTrusted","currentTarget","relatedTarget","__relatedTarget","__relatedTargetComposedPath","stopPropagation","__propagationStopped","stopImmediatePropagation","__immediatePropagationStopped","mixinComposedFlag","Base","klazz","options","__proto__","nonBubblingEventsToRetarget","hasRetargeted","fireHandlers","phase","hs","__handlers","retargetNonBubblingEvent","AT_TARGET","lastFiredRoot","listenerSettingsEqual","savedListener","capture","once","passive","savedNode","savedType","savedCapture","savedOnce","savedPassive","findListener","wrappers","getEventWrappers","eventLike","addEventListener","fnOrObj","optionsOrCapture","handlerType","handleEvent","__shadyTarget","wrapperFn","patchEvent","lastCurrentTargetDesc","eventPhase","BUBBLING_PHASE","CAPTURING_PHASE","bubbles","ret","removeEventListener","idx","splice","activateFocusEventOverrides","EventPatchesDescriptors","SHADY_PROTO","SHADY_SOURCE_PROTO","getPrototypeOf","hasOwnProperty","patchedProto","PatchedEvent","PatchedCustomEvent","CustomEvent","PatchedMouseEvent","MouseEvent","patchEvents","patchClick","composedClickFn","cancelable","click","eventPropertyNames","substring","newSplice","removed","addedCount","EDIT_LEAVE","EDIT_UPDATE","EDIT_ADD","EDIT_DELETE","calcEditDistances","currentStart","currentEnd","old","oldStart","oldEnd","rowCount","columnCount","distances","j","equals","north","west","spliceOperationsFromEditDistances","edits","northWest","min","reverse","calcSplices","prefixCount","suffixCount","minLength","Math","sharedPrefix","sharedSuffix","ops","splices","oldIndex","searchLength","index1","index2","count","currentValue","previousValue","calculateSplices","previous","linkNode","ref_node","containerData","ref_nodeData","psd","nsd","recordInsertBefore","resetTo","recordRemoveChild","recordChildNodes","first","scopingShim","getScopingShim","scopeClassAttribute","addShadyScoping","newScopeName","removeShadyScoping","currentScopeName","replaceShadyScoping","oldScopeName","currentScopeIsCorrect","correctScope","currentScope","currentScopeForNode","treeVisitor","visitorFn","doc","nativeIsConnectedAccessors","nativeIsConnected","removeOwnerShadyRoot","hasCachedOwnerRoot","firstComposedNode","flattened","scheduleObserver","addedNode","removedNode","NodePatches","isConnected","ownerDocument","documentElement","tc","cn","join","insertBefore","refData","slotsAdded","ownerRoot","ownerShadyRootForNode","allowNativeInsert","needsScoping","needsSlotFinding","_addSlots","_asyncRender","parentData","adoptNode","appendChild","removeChild","skipUnscoping","preventNativeRemove","removingInsertionPoint","_removeContainedSlots","changeSlotContent","replaceChild","cloneNode","deep","ATTRIBUTE_NODE","nc","parent","query","matcher","halter","queryElements","elements","queryElement","result","ParentNodePatches","QueryPatches","useNative","o","slice","ParentNodeDocumentOrFragmentPatches","assign","DocumentOrFragmentPatches","getElementById","id","getDocumentActiveElement","activeElement","DocumentOrShadowRootPatches","active","activeRoot","ElementOrShadowRootPatches","ShadowRootPatches","patchShadyAccessors","patchShadyRoot","defineProperties","ShadyRootConstructionToken","CATCHALL_NAME","SHADYROOT_NAME","MODE_CLOSED","isRendering","readyState","rootRendered","ancestorList","ancestors","unshift","ShadyRoot","token","TypeError","mode","hostData","rootData","_renderPending","_hasRendered","_slotList","_slotMap","_pendingSlots","_render","_getPendingDistributionRoot","renderRoot","_getDistributionParent","__childSlotCount","_renderSelf","_flushInitial","wasRendering","_distribute","_compose","_validateSlots","slot","_clearSlotAssignedNodes","_distributeNodeToSlot","slotData","slotParentData","slotParentRoot","_addAssignedToFlattenedNodes","prevAssignedNodes","_fireSlotChange","forcedSlot","oldSlot","n$","assigned","nestedAssigned","slots","composeList","targetNode","_updateChildNodes","_composeNode","_isInsertionPoint","distributedNode","d","next","_ensureSlotData","_mapSlots","slotNamesToSort","slotParent","_nameForSlot","_sortSlots","__slotName","sort","a","b","listA","listB","nA","nB","didRemove","x","_removeFlattenedNodes","_updateSlotName","oldName","connectMap","Map","r","v","k","clear","__shadydom_connectedCallback","__shadydom_disconnectedCallback","ManageConnect","base","connected","disconnected","counter","connectFlag","connectedCallback","disconnectedCallback","define","Wrapper","dispatchEvent","setAttribute","hasAttribute","removeAttribute","DOCUMENT_NODE","_activeElement","focus","blur","importNode","wrapperMap","WeakMap","wrap","wrapper","EventTargetPatches","SlotablePatches","distributeAttributeChange","ElementPatches","HTMLElementPatches","shadowActive","property","shadyData","eventName","SlotPatches","flatten","DocumentPatches","WindowPatches","bind","NonStandardHTMLElement","ElementShouldHaveInnerHTML","patchMap","Text","HTMLSlotElement","getPatchPrototype","disallowedNativePatches","applyPatches","disallowed","patch","addShadyPrefixedProperties","ShadyDOM","ShadowRoot","reservedTagList","isValidCustomElementName","reserved","has","validForm","test","nativeValue","__CE_isImportDocument","nextSiblingOrAncestorSibling","start","walkDeepDescendantElements","visitedImports","import","__CE_shadowRoot","setPropertyUnchecked","destination","CustomElementState","custom","failed","CustomElementInternals","_localNameToDefinition","_constructorToDefinition","_patches","_hasPatches","setDefinition","definition","constructorFunction","localNameToDefinition","constructorToDefinition","addPatch","listener","patchTree","Utilities","__CE_patched","connectTree","__CE_state","CEState","upgradeElement","disconnectTree","patchAndUpgradeTree","upgrade","gatherElements","__CE_hasRegistry","__CE_documentLoadHandled","clonedVisitedImports","currentState","defaultView","constructionStack","pop","__CE_definition","attributeChangedCallback","observedAttributes","oldValue","newValue","namespace","DocumentConstructionObserver","internals","_internals","_document","_handleMutations","childList","subtree","disconnect","Deferred","_value","_resolve","_promise","Promise","resolve","toPromise","CustomElementRegistry","_elementDefinitionIsRunning","_whenDefinedDeferred","_flushCallback","_flushPending","_pendingDefinitions","_documentConstructionObserver","Function","SyntaxError","adoptedCallback","getCallback","callbackValue","_flush","pendingDefinitions","elementsWithStableDefinitions","elementsWithPendingDefinitions","pendingElements","pendingUpgradableElements","deferred","whenDefined","reject","prior","some","polyfillWrapFlushCallback","outer","inner","Document_createElement","Document_createElementNS","Document_importNode","Document_prepend","Document_append","DocumentFragment_prepend","DocumentFragment_append","Node_cloneNode","Node_appendChild","Node_insertBefore","Node_removeChild","Node_replaceChild","Node_textContent","Element_attachShadow","Element_innerHTML","Element_getAttribute","Element_setAttribute","Element_removeAttribute","Element_getAttributeNS","getAttributeNS","Element_setAttributeNS","setAttributeNS","Element_removeAttributeNS","removeAttributeNS","Element_insertAdjacentElement","Element_insertAdjacentHTML","Element_prepend","Element_append","Element_before","Element_after","Element_replaceWith","Element_remove","HTMLElement_innerHTML","HTMLElement_insertAdjacentElement","HTMLElement_insertAdjacentHTML","AlreadyConstructedMarker","Native","setPrototypeOf","lastIndex","toConstructElement","writable","builtIn","appendPrependPatch","builtInMethod","connectedElements","apply","prepend","append","clone","NS_HTML","PatchParentNode","insertedNodes","nativeResult","nodeWasConnected","nodeToInsert","nodeToRemove","nodeToInsertWasConnected","thisIsConnected","patch_textContent","baseDescriptor","assignedValue","childNodesLength","parts","beforeAfterPatch","before","after","replaceWith","wasConnected","remove","init","patch_innerHTML","htmlString","removedElements","isTemplate","rawElement","patch_insertAdjacentElement","baseMethod","position","insertedElement","warn","patch_insertAdjacentHTML","upgradeNodesInRange","end","text","toLowerCase","marker","String","PatchChildNode","priorCustomElements","PatchHTMLElement","PatchDocument","PatchDocumentFragment","PatchNode","PatchElement","customElements","StyleNode","parse","clean","parseCss","lex","cssText","RX","comments","port","OPEN_BRACE","CLOSE_BRACE","t","trim","ss","_expandUnicodeEscapes","multipleSpaces","lastIndexOf","AT_START","MEDIA_START","types","MEDIA_RULE","match","keyframesRule","KEYFRAMES_RULE","split","VAR_START","MIXIN_RULE","STYLE_RULE","r$","code","arguments","repeat","stringify","preserveProperties","_hasMixinRules","removeCustomProps","rules","removeCustomPropAssignment","removeCustomPropApply","customProp","mixinProp","mixinApply","varApply","nativeShadow","nativeCssVariables_","calcCssVariables","navigator","userAgent","CSS","supports","cssBuild","ShadyCSS","disableRuntime","nativeCss","nativeCssVariables","VAR_ASSIGN","MIXIN_MATCH","VAR_CONSUMED","ANIMATION_MATCH","MEDIA_MATCH","BRACKETED","HOST_PREFIX","HOST_SUFFIX","styleTextSet","scopingAttribute","processUnscopedStyle","style","newStyle","head","isUnscopedStyle","toCssText","forEachRule","rulesForStyle","isKeyframesSelector","rule","styleRuleCallback","keyframesRuleCallback","onlyActiveRules","skipRules","matchMedia","applyCss","moniker","contextNode","createScopeStyle","applyStyle","lastHeadApplyNode","applyStylePlaceHolder","placeHolder","createComment","scope","compareDocumentPosition","DOCUMENT_POSITION_PRECEDING","findMatchingParen","level","processVariableAndFallback","str","suffix","comma","fallback","setElementClassRaw","getIsExtends","is","typeExtension","extends","gatherStyleText","styleTextParts","styles","splitSelectorList","part","CSS_BUILD_ATTR","getCssBuild","__cssBuild","attrValue","buildComment","getBuildComment","removeBuildComment","elementHasBuiltCss","Comment","commentParts","isOptimalCssBuild","SCOPE_NAME","StyleTransformer","dom","shouldRemoveScope","_transformDom","domAddScope","transformer","template","_content","classList","CLASS","StyleUtil","domReplaceScope","oldScope","newScope","domRemoveScope","elementStyles","styleRules","css","ext","hostScope","_calcHostScope","_calcElementScope","self","isScoped","CSS_CLASS_PREFIX","_transformRule","_transformComplexSelector","transformedSelector","_transformRuleCss","COMPLEX_SELECTOR_SEP","_twiddleNthPlus","NTH","inside","_preserveMatchesPseudo","MATCHES","input","MATCHES_REPLACEMENT","_replaceMatchesPseudo","reduce","acc","cur","stop","isNth","isMatches","SLOTTED_START","HOST","SIMPLE_SELECTOR_SEP","info","_transformCompoundSelector","combinator","slottedIndex","SLOTTED","_transformHostSelector","_transformSimpleSelector","slotted","SLOTTED_PAREN","paren","DIR_PAREN","dir","output","PSEUDO_PREFIX","HOST_PAREN","SIMPLE_SELECTOR_PREFIX","typeSelector","SELECTOR_NO_MATCH","documentRule","normalizeRootSelector","_transformDocumentSelector","ROOT","SCOPE_DOC_SELECTOR","RegExp","infoKey","StyleInfo","styleInfo","ast","placeholder","ownStylePropertyNames","elementName","overrideStyleProperties","styleProperties","scopeSelector","customStyle","_getStyleRules","method","IS_IE","XSCOPE_NAME","StyleProperties","decorateStyles","props","keyframes","ruleIndex","decorateRule","collectPropertiesInCssText","propertyInfo","onKeyframesRule","_keyframes","names","properties","hasProperties","collectProperties","collectCssText","rx","any","exec","collectConsumingCssText","reify","valueForProperty","valueForProperties","propertyValue","colon","pp","applyProperties","applyKeyframeTransforms","keyframeTransforms","hasAnimations","transform","keyframeNamesToTransform","keyframe","propertyDataFromStyles","selectorToMatch","addToBitMask","key","whenHostOrRootRule","parsedSelector","isRoot","isHost","hostAndRootPropertiesForScope","hostProps","rootProps","_element","transformStyles","hostSelector","rxHostSelector","hostRx","_elementKeyframeTransforms","_scopeSelector","keyframesRules","_scopeKeyframes","_keyframesRuleTransformer","keyframesNameRx","transformedKeyframesName","scopeId","applyElementScopeSelector","applyElementStyle","applyCustomStyle","bits","parseInt","placeholderMap","getStylePlaceholder","ensureStylePlaceholder","ce","origDefine","wrappedDefine","clazz","StyleCache","typeMax","cache","_validate","cacheEntry","ownPropertyNames","pn","store","tagname","styleElement","fetch","entry","getClasses","scopeRegExp","getCurrentScope","getOwnerScope","ensureCorrectSubtreeScoping","unscopedNodes","unscopedNode","scopeForPreviouslyUnscopedNode","isElementWithBuiltCss","el","handler","mxns","mxn","nativeCustomElements","delayedStart","body","requestAnimationFrame","templateMap","CURRENT_VERSION","NEXT_VERSION","VALIDATING_VERSION","promise","invalidate","invalidateTemplate","templateIsValid","templateIsValidating","startValidatingTemplate","_validating","then","updateNativeProperties","removeProperty","setProperty","detectMixin","readyPromise","whenReady","resolveFn","documentWait","SEEN_MARKER","CACHED_STYLE","transformFn","validateFn","CustomStyleInterface","enqueueDocumentValidation","addCustomStyle","getStyleForCustomStyle","processStyles","cs","styleToTransform","needsEnqueue","adoptedCssTextMap","styleCache","ScopingShim","_scopeCounter","_documentOwner","_documentOwnerStyleInfo","_elementsHaveApplied","_applyShim","_customStyleInterface","watcherFlush","_generateScopeSelector","getStyleAst","styleAstToString","_gatherStyles","prepareTemplate","prepareTemplateDom","prepareTemplateStyles","_prepared","optimalBuild","_ensure","hasMixins","_generateStaticStyle","_style","_ownPropertyNames","prepareAdoptedCssText","cssTextArray","_domPrepared","shadowroot","_prepareHost","_ensureApplyShim","ApplyShim","ApplyShimUtils","_ensureCustomStyleInterface","transformCustomStyleForDocument","flushCustomStyles","customStyles","_updateProperties","_applyCustomStyles","styleDocument","_revalidateCustomStyleApplyShim","overrideProps","_mixOverrideStyleProps","styleElementNativeVariables","_isRootOwner","styleElementShimVariables","_applyStyleProperties","_styleOwnerForNode","cachedScopeSelector","cachedStyle","oldScopeSelector","owner","ownerStyleInfo","ownerProperties","hostAndRootProps","propertyData","propertiesMatchingHost","_mixinOverrideStyles","overrides","styleSubtree","wrappedHost","shadowChildren","_revalidateApplyShim","getComputedStyleValue","getComputedStyle","getPropertyValue","setElementClass","classString","classes","scopeName","classAttr","k$","_styleInfoForNode","scopeNode","unscopeNode","scopeForNode","elementExtends"],"mappings":"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"}